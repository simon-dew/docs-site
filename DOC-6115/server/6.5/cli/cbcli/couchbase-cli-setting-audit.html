<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>setting-audit | Couchbase Docs (Staging)</title>
    <link rel="canonical" href="https://simon-dew.github.io/docs-site/DOC-6115/server/6.5/cli/cbcli/couchbase-cli-setting-audit.html">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="schema.dcterms" href="https://purl.org/dc/terms/">
    <meta name="dcterms.subject" content="server">
    <meta name="dcterms.identifier" content="6.5">
    <meta name="generator" content="Antora 2.0.0">
    <link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar" id="topbar">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://www.couchbase.com"><img src="../../../../_/img/logo.svg" alt="Couchbase"></a>
        <button class="navbar-burger" data-target="topbar-menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
      <div id="topbar-menu" class="navbar-menu">
        <div class="navbar-start">
          <div class="navbar-item has-dropdown">
            <a class="navbar-link" href="https://simon-dew.github.io/docs-site/DOC-6115">Docs</a>
            <div class="navbar-dropdown explore">
              <div class="title">Couchbase Documentation Overview</div>
              <div class="cols">
                <ul>
                  <li class="heading"><a href="../../index.html">Server</a></li>
                  <li><a href="../../../../server/6.5/n1ql/n1ql-language-reference/index.html">N1QL</a></li>
                  <li><a href="../../../../server/6.5/fts/full-text-intro.html">Full Text Search</a></li>
                  <li><a href="../../../../server/6.5/analytics/introduction.html">Analytics</a></li>
                  <li><a href="../../../../server/6.5/eventing/eventing-overview.html">Eventing</a></li>
                  <li><a href="#">Autonomous Operator</a></li>
                </ul>
                <ul>
                  <li class="heading">Mobile</li>
                  <li><a href="#">Lite</a></li>
                  <li><a href="#">Sync Gateway</a></li>
                </ul>
                <ul class="two-cols">
                  <li class="heading"><a href="../../../../server/6.5/sdk/overview.html">SDKs</a></li>
                  <li><a href="#">C</a></li>
                  <li><a href="#">.NET</a></li>
                  <li><a href="#">Go</a></li>
                  <li><a href="#">Java</a></li>
                  <li><a href="#">Node.js</a></li>
                  <li><a href="#">PHP</a></li>
                  <li><a href="#">Python</a></li>
                  <li><a href="#">Scala</a></li>
                </ul>
                <ul>
                  <li class="heading"><a href="../../../../server/6.5/connectors/intro.html">Connectors</a></li>
                  <li><a href="#">Elasticsearch</a></li>
                  <li><a href="../../../../server/6.5/connectors/hadoop-1.2/hadoop.html">Hadoop</a></li>
                  <li><a href="#">Kafka</a></li>
                  <li><a href="#">Spark</a></li>
                  <li><a href="../../../../server/6.5/connectors/odbc-jdbc-drivers.html">ODBC/JDBC</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="navbar-item has-dropdown">
            <a class="navbar-link component" href="../../index.html"><span class="title">server</span> <span class="version">6.5</span></a>
            <div class="navbar-dropdown versions">
              <div class="cols">
                <ul>
                  <li><a class="navbar-item" href="../../../6.0/cli/cbcli/couchbase-cli-setting-audit.html">server 6.0</a></li>
                  <li><a class="navbar-item" href="../../../5.5/index.html">server 5.5</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="navbar-end">
          <div class="navbar-item">
            <a class="btn red-btn" href="https://www.couchbase.com/downloads">Downloads</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body container">
<nav class="nav">
</nav>
<aside class="toc sidebar">
  <div class="toc-menu"></div>
</aside>
<main class="article" data-ceiling="topbar">
  <div class="article-header">
<button class="nav-control"></button>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../../index.html">server</a></li>
    <li class="crumb"><a href="couchbase-cli-setting-audit.html">setting-audit</a></li>
  </ul>
</nav>
<div class="tools" role="navigation">
  <ul>
    <li class="tool edit"><a href="https://github.com/couchbase/couchbase-cli/edit/master/docs/modules/cli/pages/cbcli/couchbase-cli-setting-audit.adoc" title="Edit Page" target="_blank" rel="noopener">Edit</a></li>
  </ul>
</div>
  </div>
<article class="doc">
<h1 class="page">setting-audit</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Modifies audit log settings (EE only)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synopsis"><a class="anchor" href="#synopsis"></a>SYNOPSIS</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content"><em>couchbase-cli setting-audit</em> [--cluster &lt;url&gt;] [--username &lt;user&gt;]
    [--password &lt;password&gt;] [--list-filterable-events] [--get-settings]
    [--set] [--audit-enabled &lt;1|0&gt;] [--audit-log-path &lt;path&gt;]
    [--audit-log-rotate-interval &lt;seconds&gt;] [--audit-log-rotate-size &lt;bytes&gt;]
    [--disabled-users &lt;user-list&gt;] [--disable-events &lt;event-list&gt;]</pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="description"><a class="anchor" href="#description"></a>DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Auditing is used to observe the action of users in the cluster. It is usually
turned on for security purposes to ensure that those without permission to
access information do not access it. By default auditing is disabled in
Couchbase. The setting-audit command can be used to retrieve the current
auditing configuration, retrieve the auditable events and descriptions, to
enable and disable auditing, set the auditing log path, change the auditing log
rotation interval and disable auditing for certain users and events.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="options"><a class="anchor" href="#options"></a>OPTIONS</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">-c</dt>
<dt class="hdlist1">--cluster</dt>
<dd>
<p>Specifies the hostname of a node in the cluster. See the HOST FORMATS
section for more information on specifying a hostname.</p>
</dd>
<dt class="hdlist1">-u</dt>
<dt class="hdlist1">--user &lt;username&gt;</dt>
<dd>
<p>Specifies the username of the user executing the command. If you do not have
a user account with permission to execute the command then it will fail with
an unauthorized error.</p>
</dd>
<dt class="hdlist1">-p</dt>
<dt class="hdlist1">--password &lt;password&gt;</dt>
<dd>
<p>Specifies the password of the user executing the command. If you do not have
a user account with permission to execute the command then it will fail with
an unauthorized error. If this argument is specified, but no password is
given then the command will prompt the user for a password through
non-echoed stdin. You may also specify your password by using the
environment variable CB_REST_PASSWORD.</p>
</dd>
<dt class="hdlist1">--list-filterable-events</dt>
<dd>
<p>Returns a table or a JSON list (if --output json used) with all the event
IDs with there descriptions.</p>
</dd>
<dt class="hdlist1">--get-settings</dt>
<dd>
<p>Returns the current audit settings including which events are disabled and
which are enabled.</p>
</dd>
<dt class="hdlist1">--set</dt>
<dd>
<p>Sets the cluster audit settings.</p>
</dd>
<dt class="hdlist1">--audit-enabled &lt;num&gt;</dt>
<dd>
<p>Specifies whether or not auditing is enabled. To enabled auditing set this
option to "1". To disable auditing set this option to "0".</p>
</dd>
<dt class="hdlist1">--audit-log-path &lt;path&gt;</dt>
<dd>
<p>Specifies The auditing log path. This should be a path should be a path to a
folder where the auditing log is kept. The folder must exist on all servers
in the cluster.</p>
</dd>
<dt class="hdlist1">--audit-log-rotate-interval &lt;seconds&gt;</dt>
<dd>
<p>Specifies the audit log rotate interval. This is the interval in which the
current audit log will be replaced with a new empty audit log file. The log
file is rotated to ensure that the audit log does not consume too much disk
space. The minimum audit log rotate interval is 15 minutes (900 seconds).</p>
</dd>
<dt class="hdlist1">--audit-log-rotate-size &lt;bytes&gt;</dt>
<dd>
<p>Specifies the audit log rotate size. This is the size at which the current
audit log will be replaced with a new empty audit log file. The log
file is rotated to ensure that the audit log does not consume too much disk
space. The minimum audit log rotate size is 0 bytes and maximum is
524,288,000 (500MB). When it is set to 0 the log will not be rotated based
on size.</p>
</dd>
<dt class="hdlist1">--disabled-users &lt;user-list&gt;</dt>
<dd>
<p>A comma separated list of users to ignore events from.</p>
</dd>
<dt class="hdlist1">--disable-events &lt;events-list&gt;</dt>
<dd>
<p>A comma separated list of events IDs to disable auditing for
(e.g 8243,8255,8257). To retrieve information of what event ID maps to
what event use the --list-filterable-events to retrieve a list of IDs with
descriptions.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="host-formats"><a class="anchor" href="#host-formats"></a>HOST FORMATS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When specifying a host for the couchbase-cli command the following formats are expected:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>couchbase://&lt;addr&gt;</code></p>
</li>
<li>
<p><code>&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>http://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is recommended to use the couchbase://&lt;addr&gt; format for standard
installations. The other two formats allow an option to take a port number which
is needed for non-default installations where the admin port has been set up on
a port other that 8091.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples"><a class="anchor" href="#examples"></a>EXAMPLES</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To get the current audit settings run the command below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ couchbase-cli setting-audit -c 192.168.1.5:8091 --username Administrator \
 --password password --get-settings</pre>
</div>
</div>
<div class="paragraph">
<p>If auditing is disabled the expected output will be of the form (all the
commands can return json if <code>--output json</code> is provided):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Audit enabled: False
UUID: 44726500
Log path: /opt/couchbase/var/lib/couchbase/logs
Rotate interval: 86400
Rotate size: 20971520
Disabled users: []</pre>
</div>
</div>
<div class="paragraph">
<p>To retrieve the list of events that can be audit use the command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ couchbase-cli setting-audit -c 192.168.1.5:8091 --username Administrator \
 --password password --list-filterable-events</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>ID    | Module         | Name                                           | Description
-------------------------------------------------------------------------------------
36865 | analytics      | Service configuration change                   | A successful service configuration change was made.
36866 | analytics      | Node configuration change                      | A successful node configuration change was made.
32768 | eventing       | Create Function                                | Eventing function definition was created or updated
....
40961 | view_engine    | Delete Design Doc                              | Design Doc is Deleted
40962 | view_engine    | Query DDoc Meta Data                           | Design Doc Meta Data Query Request
40963 | view_engine    | View Query                                     | View Query Request
40964 | view_engine    | Update Design Doc                              | Design Doc is Updated</pre>
</div>
</div>
<div class="paragraph">
<p>To enable auditing on a cluster and set the audit log to the default logs folder
on a linux installation with a log rotate interval of 7 days run the command
below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ couchbase-cli setting-audit -c 192.168.1.5:8091 --username Administrator \
 --password password --set --audit-enabled 1 --audit-log-rotate-interval 604800 \
 --audit-log-path /opt/couchbase/var/lib/couchbase/logs</pre>
</div>
</div>
<div class="paragraph">
<p>To enable auditing on a cluster and set the audit log to the default logs folder
on a linux installation with a log rotate size of 20MB run the command below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ couchbase-cli setting-audit -c 192.168.1.5:8091 --username Administrator \
 --password password --set --audit-enabled 1 --audit-log-rotate-size 20971520 \
 --audit-log-path /opt/couchbase/var/lib/couchbase/logs</pre>
</div>
</div>
<div class="paragraph">
<p>To enable auditing on a cluster and set the audit log to the default logs folder
on a linux installation with a log rotate size of 20MB run the command below and disable
auditing for users backup and restore as well as disable auditing for event 40964 and 40963.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ couchbase-cli setting-audit -c 192.168.1.5:8091 --username Administrator \
 --password password --set --audit-enabled 1 --audit-log-rotate-size 20971520 \
 --audit-log-path /opt/couchbase/var/lib/couchbase/logs \
 --disabled-users backup,restore --disable-events 40964,40963</pre>
</div>
</div>
<div class="paragraph">
<p>To disable auditing run the following command.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ couchbase-cli setting-audit -c 192.168.1.5:8091 --username Administrator \
 --password password --set --audit-enabled 0</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="environment-and-configuration-variables"><a class="anchor" href="#environment-and-configuration-variables"></a>ENVIRONMENT AND CONFIGURATION VARIABLES</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">CB_REST_USERNAME</dt>
<dd>
<p>Specifies the username to use when executing the command. This environment
variable allows you to specify a default argument for the -u/--username
argument on the command line.</p>
</dd>
<dt class="hdlist1">CB_REST_PASSWORD</dt>
<dd>
<p>Specifies the password of the user executing the command. This environment
variable allows you to specify a default argument for the -p/--password
argument on the command line. It also allows the user to ensure that their
password are not cached in their command line history.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also"><a class="anchor" href="#see-also"></a>SEE ALSO</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="#">cbcli/couchbase-cli-admin-role-manage.adoc</a>,
<a href="couchbase-cli-ssl-manage.html" class="page">ssl-manage</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-cli"><a class="anchor" href="#couchbase-cli"></a>COUCHBASE-CLI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Part of the <a href="couchbase-cli.html" class="page">couchbase-cli</a> suite</p>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../../_/img/logo.svg" alt="Couchbase">
          </a>
        </div>
        <div class="contact">
          <p class="address">3250 Olcott Street
Santa Clara, CA 95054
United States</p>
          <a href="https://www.couchbase.com/contact" class="btn white-btn">Contact Us</a>
          <a class="tel" href="tel:1-650-417-7500">1-650-417-7500</a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Company</span></li>
          <li><a href="https://www.couchbase.com/about">About</a></li>
          <li><a href="https://www.couchbase.com/leadership">Leadership</a></li>
          <li><a href="https://www.couchbase.com/news-and-press-releases">News &amp; Press</a></li>
          <li><a href="https://www.couchbase.com/careers">Careers</a></li>
          <li><a href="https://www.couchbase.com/resources/events">Events</a></li>
          <li><a href="https://www.couchbase.com/contact">Contact Us</a></li>
          <li><a href="https://www.couchbase.com/request-pricing">Pricing</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Support</span></li>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://www.couchbase.com/services">Professional Services</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support Login</a></li>
          <li><a href="https://learn.couchbase.com/store" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Quicklinks</span></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Online Training</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
          <li><a href="https://www.couchbase.com/nosql-resources/why-nosql">Why NoSQL</a></li>
          <li><a href="https://www.couchbase.com/resources/security">Security</a></li>
          <li><a href="https://www.couchbase.com/resources/gdpr">GDPR</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <a href="https://www.facebook.com/Couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="26.363 116.363 560.215 560.215"><path d="m586.58 209.58c0-48.96-44.252-93.212-93.212-93.212h-373.79c-48.96 0-93.212 44.252-93.212 93.212v373.79c0 48.96 44.252 93.212 93.212 93.212h186.42v-211.85h-68.732v-93.212h68.732v-36.72c0-63.083 47.077-119.58 105.45-119.58h75.323v93.212h-75.323c-8.474 0-17.889 10.357-17.889 25.422v37.662h93.212v93.212h-93.212v211.85h99.803c48.96 0 93.212-44.252 93.212-93.212v-373.79z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://twitter.com/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="32.012 176.622 542.326 437.815"><path d="m574.34 227.46c-19.772 8.474-41.428 15.065-64.025 17.889 22.597-14.123 40.486-35.778 48.96-61.2-21.655 13.182-45.194 21.655-70.615 27.305-20.714-21.655-48.96-34.837-80.972-34.837-61.2 0-111.1 49.902-111.1 111.1 0 8.474 0.942 16.948 2.825 25.422-92.271-5.649-174.18-49.902-229.74-117.69-9.415 16.006-15.065 35.778-15.065 55.551 0 38.603 19.772 72.498 49.902 92.271-17.889-0.942-35.778-5.649-50.843-14.123v0.942c0 53.668 38.603 98.862 89.446 109.22-9.415 2.825-18.831 3.766-29.188 3.766-7.532 0-14.123-0.942-20.714-1.883 14.123 44.252 55.551 76.265 103.57 77.206-37.662 30.129-85.68 48.018-138.41 48.018-9.415 0-17.889-0.941-26.363-1.883 48.96 32.012 107.34 49.902 170.42 49.902 204.31 0 316.36-169.48 316.36-316.36v-14.123c21.656-14.125 40.487-33.897 55.551-56.494z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://www.linkedin.com/company/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="31.071 119.188 539.537 540.443"><path d="m531.97 119.19h-461.35c-21.655 0-39.545 16.948-39.545 38.603v463.24c0 21.655 17.889 38.603 39.545 38.603h460.41c21.655 0 39.545-16.948 39.545-38.603v-463.24c0.942-21.656-16.947-38.603-38.603-38.603zm-337.07 451.94h-81.914v-243.86h81.914v243.86zm-40.486-276.81c-28.246 0-46.135-18.831-46.135-42.369s17.889-42.369 46.135-42.369 45.194 17.889 45.194 42.369c0.942 23.538-16.948 42.369-45.194 42.369zm335.19 276.81h-81.914v-129.93c0-32.954-12.24-55.551-41.428-55.551-22.597 0-35.778 15.065-41.428 30.129-1.883 5.649-2.825 12.24-2.825 19.772v136.52h-81.914s0.942-221.26 0-243.86h81.914v34.837c11.298-16.948 30.129-40.486 73.44-40.486 53.668 0 94.154 34.837 94.154 110.16l1e-3 138.41zm-168.54-208.08s0.941-0.941 0 0z"/></svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <span>2019 COUCHBASE All rights reserved.</span>
      <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
      <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
      <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
      <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
    </div>
  </div>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
