<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Client Settings for the Java SDK | Couchbase Docs (Staging)</title>
    <link rel="canonical" href="https://simon-dew.github.io/docs-site/DOC-4752/java-sdk/3.0/ref/client-settings.html">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="schema.dcterms" href="https://purl.org/dc/terms/">
    <meta name="dcterms.subject" content="java-sdk">
    <meta name="dcterms.identifier" content="3.0">
    <meta name="generator" content="Antora 2.0.0">
    <link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar" id="topbar">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://www.couchbase.com"><img src="../../../_/img/logo.svg" alt="Couchbase"></a>
        <button class="navbar-burger" data-target="topbar-menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
      <div id="topbar-menu" class="navbar-menu">
        <div class="navbar-start">
          <div class="navbar-item has-dropdown">
            <a class="navbar-link" href="https://simon-dew.github.io/docs-site/DOC-4752">Docs</a>
            <div class="navbar-dropdown explore">
              <div class="title">Couchbase Documentation Overview</div>
              <div class="cols">
                <ul>
                  <li class="heading"><a href="../../../server/6.5/introduction/intro.html">Server</a></li>
                  <li><a href="../../../server/6.5/n1ql/n1ql-language-reference/index.html">N1QL</a></li>
                  <li><a href="../../../server/6.5/fts/full-text-intro.html">Full Text Search</a></li>
                  <li><a href="../../../server/6.5/analytics/introduction.html">Analytics</a></li>
                  <li><a href="../../../server/6.5/eventing/eventing-overview.html">Eventing</a></li>
                  <li><a href="#">Autonomous Operator</a></li>
                </ul>
                <ul>
                  <li class="heading">Mobile</li>
                  <li><a href="#">Lite</a></li>
                  <li><a href="#">Sync Gateway</a></li>
                </ul>
                <ul class="two-cols">
                  <li class="heading"><a href="../../../server/6.5/sdk/overview.html">SDKs</a></li>
                  <li><a href="#">C</a></li>
                  <li><a href="#">.NET</a></li>
                  <li><a href="#">Go</a></li>
                  <li><a href="../hello-world/start-using-sdk.html">Java</a></li>
                  <li><a href="#">Node.js</a></li>
                  <li><a href="#">PHP</a></li>
                  <li><a href="#">Python</a></li>
                  <li><a href="#">Scala</a></li>
                </ul>
                <ul>
                  <li class="heading"><a href="../../../server/6.5/connectors/intro.html">Connectors</a></li>
                  <li><a href="#">Elasticsearch</a></li>
                  <li><a href="../../../server/6.5/connectors/hadoop-1.2/hadoop.html">Hadoop</a></li>
                  <li><a href="#">Kafka</a></li>
                  <li><a href="#">Spark</a></li>
                  <li><a href="../../../server/6.5/connectors/odbc-jdbc-drivers.html">ODBC/JDBC</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="navbar-item has-dropdown">
            <a class="navbar-link component" href="../hello-world/start-using-sdk.html"><span class="title">Java SDK</span> <span class="version">3.0</span></a>
            <div class="navbar-dropdown versions">
              <div class="cols">
                <ul>
                  <li class="current"><a class="navbar-item" href="client-settings.html">Java SDK 3.0</a></li>
                  <li><a class="navbar-item" href="../../2.7/start-using-sdk.html">Java SDK 2.7</a></li>
                  <li><a class="navbar-item" href="../../2.6/start-using-sdk.html">Java SDK 2.6</a></li>
                  <li><a class="navbar-item" href="../../2.5/start-using-sdk.html">Java SDK 2.5</a></li>
                  <li><a class="navbar-item" href="../../2.4/start-using-sdk.html">Java SDK 2.4</a></li>
                  <li><a class="navbar-item" href="../../2.3/start-using-sdk.html">Java SDK 2.3</a></li>
                  <li><a class="navbar-item" href="../../2.2/java-intro.html">Java SDK 2.2</a></li>
                  <li><a class="navbar-item" href="../../2.1/java-intro.html">Java SDK 2.1</a></li>
                </ul>
                <ul class="related">
                  <li><a class="navbar-item" href="#">c-sdk</a></li>
                  <li><a class="navbar-item" href="#">dotnet-sdk</a></li>
                  <li><a class="navbar-item" href="#">go-sdk</a></li>
                  <li><a class="navbar-item" href="#">nodejs-sdk</a></li>
                  <li><a class="navbar-item" href="#">php-sdk</a></li>
                  <li><a class="navbar-item" href="#">python-sdk</a></li>
                  <li><a class="navbar-item" href="#">scala-sdk</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="navbar-end">
          <div class="navbar-item">
            <a class="btn red-btn" href="https://www.couchbase.com/downloads">Downloads</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body container">
<nav class="nav">
<div class="nav-menu">
<ul class="nav-list">
  <li class="nav-item is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Getting Started</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../hello-world/start-using-sdk.html">Start Using the Java SDK</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../hello-world/sample-application.html">Sample Application</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Working with Data</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/kv-operations.html">Key Value Operations</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/subdocument-operations.html">Sub-Document Operations</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/n1ql-queries-with-sdk.html">Query</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/analytics-using-sdk.html">Analytics</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/full-text-searching-with-sdk.html">Full Text Search</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Advanced Data Operations</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/concurrent-async-apis.html">Async &amp; Reactive APIs</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/distributed-acid-transactions-from-the-sdk.html">Distributed ACID Transactions</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/transcoders-nonjson.html">Transcoders &amp; Non-JSON</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/working-with-collections.html">Working with Collections DP</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Managing Couchbase</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/managing-connections.html">Managing Connections</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Errors &amp; Diagnostics</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../howtos/collecting-information-and-logging.html">Logging</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Learn</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/concepts.html">Overview</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/buckets-and-clusters.html">Buckets &amp; Clusters</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/collections.html">Collections &amp; Scope</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/compression.html">Compression</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../concept-docs/data-model.html">Data Model</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/documents.html">Documents</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/nonjson.html">Non-json Docs</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/subdocument-operations.html">Sub-Documents</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/xattr.html">XATTR &amp; Virtual XATTR</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../concept-docs/errors.html">Errors and Diagnostics</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/health-check.html">Health Check</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/response-time-observability.html">Tracing</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/durability-replication-failure-considerations.html">Failure Considerations</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/encryption.html">Field Level Encryption</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../concept-docs/data-services.html">Service Selection</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/analytics-for-sdk-users.html">Analytics</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/understanding-views.html">Map Reduce Views</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/n1ql-query.html">Query</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../concept-docs/full-text-search-overview.html">Search</a>
    </span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-path is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">References</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="https://docs.couchbase.com/sdk-api/couchbase-java-client">API Reference</a>
    </span>
  </li>
  <li class="nav-item is-current-page is-active" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="client-settings.html">Client Settings</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <span class="nav-text">Project Docs</span>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../project-docs/sdk-release-notes.html">SDK Release Notes</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../project-docs/distributed-transactions-java-release-notes.html">Transactions Release Notes</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../project-docs/compatibility.html">Compatibility</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="../project-docs/migrating-sdk-code-to-3.n.html">Migrating to SDK 3 API</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="../project-docs/sdk-licenses.html">Licenses</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../project-docs/get-involved.html">Get involved</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="https://docs.couchbase.com/home/contribute/index.html">Improve the Docs</a>
    </span>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
</div>
</nav>
<aside class="toc sidebar">
  <div class="toc-menu"></div>
</aside>
<main class="article" data-ceiling="topbar">
  <div class="article-header">
<button class="nav-control"></button>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../hello-world/start-using-sdk.html">Java SDK</a></li>
    <li class="crumb">References</li>
    <li class="crumb"><a href="client-settings.html">Client Settings</a></li>
  </ul>
</nav>
<div class="tools" role="navigation">
  <ul>
    <li class="tool edit"><a href="https://github.com/couchbase/docs-sdk-java/edit/release/3.0/modules/ref/pages/client-settings.adoc" title="Edit Page" target="_blank" rel="noopener">Edit</a></li>
  </ul>
</div>
  </div>
<article class="doc">
<h1 class="page">Client Settings for the Java SDK</h1>
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
The <code>ClusterEnvironment</code> class enables you to configure Java SDK options for bootstrapping, timeouts, reliability, and performance.
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-environment-builder"><a class="anchor" href="#the-environment-builder"></a>The Environment Builder</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most client settings are related to the <code>ClusterEnvironment</code>.
Because <code>ClusterEnvironment</code> is an immutable class, you need to configure it by using its embedded <code>Builder</code> class.
It is designed to apply the builder arguments in a fluent fashion and then create the <code>ClusterEnvironment</code> at the very end.</p>
</div>
<div class="listingblock">
<div class="title">Creating a cluster with custom settings</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClusterEnvironment env = ClusterEnvironment.builder()
    // [Customize client settings here]
    .build();

// Create a cluster using the custom client settings.
Cluster cluster = Cluster.connect(connectionString, ClusterOptions
    .clusterOptions(username, password)
    .environment(env));

// [Your code to interact with the cluster]

// Shut down gracefully.
cluster.disconnect();
env.shutdown();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="config-builders"><a class="anchor" href="#config-builders"></a>Config Builders</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Environment settings are grouped into categories, with one builder class per category.
These builders all work in the same way, which we&#8217;ll illustrate by using timeout settings as an example.</p>
</div>
<div class="paragraph">
<p>Timeout settings are configured using an instance of <code>TimeoutConfig.Builder</code>.
The usual way to create an instance is to call a static factory method on the <code>TimeoutConfig</code> class.
The method <code>TimeoutConfig.builder()</code> returns a builder with default settings.
There are also static factory methods that create a builder and set a configuration value in one step.
For example, instead of <code>TimeoutConfig.builder().kvTimeout(&#8230;&#8203;)</code> you can write simply <code>TimeoutConfig.kvTimeout(&#8230;&#8203;)</code>.</p>
</div>
<div class="listingblock">
<div class="title">Creating a new timeout config builder</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClusterEnvironment env = ClusterEnvironment.builder()
    .timeoutConfig(TimeoutConfig
        .kvTimeout(Duration.ofSeconds(5))
        .queryTimeout(Duration.ofSeconds(10)))
    .build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another way to obtain an instance of a config builder is to borrow it from the cluster environment builder.
This technique may be useful if you&#8217;re configuring the environment in stages and wish to preserve values set by a previous stage.</p>
</div>
<div class="listingblock">
<div class="title">Borrowing the existing timeout config builder</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClusterEnvironment.Builder envBuilder = ClusterEnvironment.builder();
envBuilder.timeoutConfig() // returns a TimeoutConfig.Builder
    .kvTimeout(Duration.ofSeconds(5))
    .queryTimeout(Duration.ofSeconds(10));
ClusterEnvironment env = envBuilder.build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of the cluster environment builder method for getting and setting each config builder always matches the name of the config class.
For example, <code>TimeoutConfig</code> is set via the environment builder&#8217;s <code>timeoutConfig</code> method, <code>IoConfig</code> is set via the <code>ioConfig</code> method, and so on.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="system-properties"><a class="anchor" href="#system-properties"></a>System Properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Many client settings may also be configured by setting a Java system property.
If a system property is set, it always takes precedence over the builder setting.</p>
</div>
<div id="duration-values" class="listingblock">
<div class="title">Configuration via system property</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">System.setProperty("com.couchbase.env.timeout.kvTimeout", "10s"); <i class="conum" data-value="1"></i><b>(1)</b>
System.setProperty("com.couchbase.env.timeout.queryTimeout", "15s");

ClusterEnvironment environment = ClusterEnvironment.builder()
    .timeoutConfig(TimeoutConfig.kvTimeout(Duration.ofSeconds(5))) <i class="conum" data-value="2"></i><b>(2)</b>
    .build();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>When specifying durations, <code>s</code> stands for seconds.
Other valid qualifiers are <code>ns</code> for nanoseconds, <code>us</code> for microseconds, <code>ms</code> for milliseconds, and <code>m</code> for minutes.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>kvTimeout</code> value specified via <code>TimeoutConfig.Builder</code> is overridden by the system property.
In this example the actual <code>kvTimeout</code> is 10 seconds, and the <code>queryTimeout</code> is 15 seconds.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
System property names starting with <code>com.couchbase.env</code> are paths in a Java object graph rooted at the environment builder.
Setting the property <code>com.couchbase.env.timeout.kvTimeout</code> tells the SDK to invoke <code>envBuilder.timeoutConfig().kvTimeout(&#8230;&#8203;)</code> using reflection.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-options"><a class="anchor" href="#configuration-options"></a>Configuration Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following tables cover all possible configuration options and explain their usage and default values.
The tables categorize the options into groups for bootstrapping, timeout, reliability, performance, and advanced options.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security-options"><a class="anchor" href="#security-options"></a>Security Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default the client will connect to Couchbase Server using an unencrypted connection.
If you are using the Enterprise Edition, it&#8217;s possible to secure the connection using TLS.</p>
</div>
<div class="listingblock">
<div class="title">Template for configuring security settings</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClusterEnvironment env = ClusterEnvironment.builder()
    .securityConfig(SecurityConfig
        .enableTls(true)
        ...)
    .build()</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Unless you set <code>enableTls</code> to <code>true</code>, none of the other security settings in this section have any effect.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Name: <strong>Enabling Secure Connections</strong></dt>
<dd>
<p>Builder Method: <code>SecurityConfig.enableTls(boolean)</code></p>
<div class="paragraph">
<p>Default:  <code>false</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.security.enableTls</code></p>
</div>
<div class="paragraph">
<p>Set this to <code>true</code> to encrypt all communication between the client and server using TLS.
This feature requires the Enterprise Edition of Couchbase Server 3.0 or later.
If TLS is enabled you must also specify the trusted certificates by calling exactly one of <code>trustCertificate</code>, <code>trustCertificates</code>, or <code>trustManagerFactory</code>.
Please see the <a href="../howtos/managing-connections.html" class="page">Managing Connections</a> section for more details on how to set it up properly.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Disabling Native TLS Provider</strong></dt>
<dd>
<p>Builder Method: <code>SecurityConfig.enableNativeTls(boolean)</code></p>
<div class="paragraph">
<p>Default:  <code>true</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.security.enableNativeTls</code></p>
</div>
<div class="paragraph">
<p>When TLS is enabled, the client will by default use an optimized native TLS provider if one is available.
If for some reason you need to disable the native provider and use the JDK&#8217;s portable provider instead, set this to <code>false</code>.
If <code>enableTls</code> is  <code>false</code> then <code>enableNativeTls</code> has no effect.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>TLS Certificate Location</strong></dt>
<dd>
<p>Builder Method: <code>SecurityConfig.trustCertificate(Path)</code></p>
<div class="paragraph">
<p>Default:  N/A</p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.security.trustCertificate</code></p>
</div>
<div class="paragraph">
<p>Path to a file containing a single X.509 certificate to trust as a Certificate Authority when establishing secure connections.
See the <a href="../howtos/managing-connections.html#ssl" class="page">Connection Management</a> section for more details on how to set it up properly.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>TLS Certificates</strong></dt>
<dd>
<p>Builder Method: <code>SecurityConfig.trustCertificates(List&lt;X509Certificate&gt;)</code></p>
<div class="paragraph">
<p>Default:  N/A</p>
</div>
<div class="paragraph">
<p>System Property: N/A</p>
</div>
<div class="paragraph">
<p>If you wish to trust more than one certificate, or prefer to load the certificate yourself, then call this method to specify the certificates to trust as Certificate Authorities when establishing secure connections.
See the <a href="../howtos/managing-connections.html#ssl" class="page">Connection Management</a> section for more details on how to set it up properly.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Custom TLS Trust Manager Factory</strong></dt>
<dd>
<p>Builder Method: <code>SecurityConfig.trustManagerFactory(TrustManagerFactory)</code></p>
<div class="paragraph">
<p>Default:  N/A</p>
</div>
<div class="paragraph">
<p>System Property: N/A</p>
</div>
<div class="paragraph">
<p>As an alternative to specifying the certificates to trust, you can specify a custom <code>TrustManagerFactory</code> to use when establishing secure connections.
See the <a href="../howtos/managing-connections.html#ssl" class="page">Connection Management</a> section for more details on how to set it up properly.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="io-options"><a class="anchor" href="#io-options"></a>I/O Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I/O settings are represented by the Java class <code>IoConfig</code>.
The associated <code>ClusterEnvironement.Builder</code> method is called <code>ioConfig</code>.</p>
</div>
<div class="listingblock">
<div class="title">Template for configuring I/O settings</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClusterEnvironment env = ClusterEnvironment.builder()
    .ioConfig(IoConfig
        .networkResolution(NetworkResolution.AUTO)
        ...)
    .build()</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Name: <strong>DNS SRV Enabled</strong></dt>
<dd>
<p>Builder Method: <code>IoConfig.enableDnsSrv(boolean)</code></p>
<div class="paragraph">
<p>Default:  <code>false</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.io.enableDnsSrv</code></p>
</div>
<div class="paragraph">
<p>Set this to <code>true</code> if you want to get the bootstrap node list from a DNS SRV record.
See the <a href="../howtos/managing-connections.html#using-dns-srv-records" class="page">Connection Management</a> section for more information on how to use it properly.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Mutation Tokens Enabled</strong></dt>
<dd>
<p>Builder Method: <code>IoConfig.mutationTokensEnabled(boolean)</code></p>
<div class="paragraph">
<p>Default:  <code>true</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.io.mutationTokensEnabled</code></p>
</div>
<div class="paragraph">
<p>Mutation tokens allow enhanced durability requirements as well as advanced N1QL querying capabilities.
Set this to <code>false</code> if you do not require these features and wish to avoid the associated overhead.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Network Resolution</strong></dt>
<dd>
<p>Builder Method: <code>IoConfig.networkResolution(NetworkResolution)</code></p>
<div class="paragraph">
<p>Default:  <code>auto</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.io.networkResolution</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The system property value should be one of <code>auto</code>, <code>default</code>, or <code>external</code> (lower case).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each node in the Couchbase Server cluster might have multiple addresses associated with it.
For example, a node might have one address that should be used when connecting from inside the same virtual network environment where the server is running, and a second address for connecting from outside the server&#8217;s network environment.</p>
</div>
<div class="paragraph">
<p>By default the client will use a simple matching heuristic to determine which set of addresses to use (it will select the set of addresses that contains a seed node&#8217;s host and port).</p>
</div>
<div class="paragraph">
<p>If you wish to override the heuristic, you can set this value to <code>default</code> if the client is running in the same network as the server, or <code>external</code> if the client is running in a different network.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Capture Traffic</strong></dt>
<dd>
<p>Builder Method: <code>IoConfig.captureTraffic(ServiceType&#8230;&#8203;)</code></p>
<div class="paragraph">
<p>Default:  capture is disabled</p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.io.captureTraffic</code></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Multiple services may be specified in the system property value using a comma-delimited list such as <code>KV,QUERY</code>.
To enable capture for all services, set the value of the system property to an empty string.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Call this method to log all traffic to the specified services.
If no services are specified, traffic to all services is captured.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Socket Keepalive</strong></dt>
<dd>
<p>Builder Method: <code>IoConfig.enableTcpKeepAlives(boolean)</code></p>
<div class="paragraph">
<p>Default:  <code>true</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.io.enableTcpKeepAlives</code></p>
</div>
<div class="paragraph">
<p>If enabled, the client periodically sends a TCP keepalive to the server to prevent firewalls and other network equipment from dropping idle TCP connections.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Socket Keepalive Interval</strong></dt>
<dd>
<p>Builder Method: <code>IoConfig.tcpKeepAliveTime(Duration)</code></p>
<div class="paragraph">
<p>Default:  <code>60s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.io.tcpKeepAliveTime</code></p>
</div>
<div class="paragraph">
<p>The idle time after which a TCP keepalive gets fired.
(This setting has no effect if <code>enableTcpKeepAlives</code> is <code>false</code>.)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This setting only propagates to the OS on Linux when the epoll transport is used.
On all other platforms, the OS-configured time is used (and you need to tune it there if you want to override the default interval).
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Key/Value Endpoints per Node</strong></dt>
<dd>
<p>Builder Method: <code>IoConfig.numKvConnections(int)</code></p>
<div class="paragraph">
<p>Default:  <code>1</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.io.numKvConnections</code></p>
</div>
<div class="paragraph">
<p>The number of actual endpoints (sockets) to open per node in the cluster against the Key/Value service.
By default, for every node in the cluster one socket is opened where all traffic is pushed through.
That way the SDK implicitly benefits from network batching characteristics when the workload increases.
If you suspect based on profiling and benchmarking that the socket is saturated you can think about slightly increasing it to have more "parallel pipelines".
This might be especially helpful if you need to push large documents through it.
The recommendation is keeping it at 1 unless there is other evidence.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="../concept-docs/durability-replication-failure-considerations.html#synchronous-writes" class="page">Durable Write</a> operations with Couchbase Server 6.5 and above require up to 16 KV Endpoints per node, for most efficient operation, unless the environment dictates something a little lower.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Max HTTP Endpoints per Service per Node</strong></dt>
<dd>
<p>Builder Method: <code>IoConfig.maxHttpConnections(int)</code></p>
<div class="paragraph">
<p>Default:  <code>12</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.io.maxHttpConnections</code></p>
</div>
<div class="paragraph">
<p>Each service (except the Key/Value service) has a separate dynamically sized pool of HTTP connections for issuing requests.
This setting puts an upper bound on the number of HTTP connections in each pool.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Idle HTTP Connection Timeout</strong></dt>
<dd>
<p>Builder Method: <code>IoConfig.idleHttpConnectionTimeout(Duration)</code></p>
<div class="paragraph">
<p>Default:  <code>30s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.io.idleHttpConnectionTimeout</code></p>
</div>
<div class="paragraph">
<p>The length of time an HTTP connection may remain idle before it is closed and removed from the pool.
Durations longer than 50 seconds are not recommended, since some services have a 1 minute server side idle timeout.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Config Poll Interval</strong></dt>
<dd>
<p>Builder Method: <code>IoConfig.configPollInterval(Duration)</code></p>
<div class="paragraph">
<p>Default:  <code>2.5s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.io.configPollInterval</code></p>
</div>
<div class="paragraph">
<p>The interval at which the client fetches cluster topology information in order to proactively detect changes.</p>
</div>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="circuit-breaker-options"><a class="anchor" href="#circuit-breaker-options"></a>Circuit Breaker Options</h3>
<div class="paragraph">
<p>Circuit breakers are a tool for preventing cascading failures.</p>
</div>
<div class="paragraph">
<p>When a circuit is closed, requests are sent to the server as normal.
If too many requests fail within a certain time window, the breaker opens the circuit, preventing requests from going through.</p>
</div>
<div class="paragraph">
<p>When a circuit is open, any requests to the service immediately fail without the client even talking to the server.
After a "sleep delay" elapses, the next request is allowed to go through the to the server. This trial request is called a "canary."</p>
</div>
<div class="paragraph">
<p>Each service has an associated circuit breaker which may be configured independently of the others.
The <code>IoConfig</code> builder has methods for configuring the circuit breakers of each service.</p>
</div>
<div class="listingblock">
<div class="title">Template for configuring circuit breaker settings</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClusterEnvironment env = ClusterEnvironment.builder()
    .ioConfig(IoConfig.
        kvCircuitBreakerConfig(CircuitBreakerConfig.builder()
            .enabled(true)
            .volumeThreshold(45)
            .errorThresholdPercentage(25)
            .sleepWindow(Duration.ofSeconds(1))
            .rollingWindow(Duration.ofMinutes(2))
        ))
    .build();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The corresponding system properties would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">com.couchbase.env.io.kvCircuitBreaker.enabled=true
com.couchbase.env.io.kvCircuitBreaker.volumeThreshold=45
com.couchbase.env.io.kvCircuitBreaker.errorThresholdPercentage=25
com.couchbase.env.io.kvCircuitBreaker.sleepWindow=1s
com.couchbase.env.io.kvCircuitBreaker.rollingWindow=2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the other services, replace <code>kv</code> with <code>query</code>, <code>view</code>, <code>search</code>, <code>analytics</code>, or <code>manager</code>.</p>
</div>
<div class="paragraph">
<p>The properties of a circuit breaker are described below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">enabled</dt>
<dd>
<p>Default: <code>true</code></p>
<div class="paragraph">
<p>Enables or disables this circuit breaker.</p>
</div>
<div class="paragraph">
<p>If this property is set to false, then the circuit breaker is not used and all other properties are ignored.</p>
</div>
</dd>
<dt class="hdlist1">volumeThreshold</dt>
<dd>
<p>Default: <code>20</code></p>
<div class="paragraph">
<p>The volume threshold defines how many operations must be in the window before the threshold percentage can be meaningfully calculated.</p>
</div>
</dd>
<dt class="hdlist1">errorThresholdPercentage</dt>
<dd>
<p>Default: <code>50</code></p>
<div class="paragraph">
<p>The percentage of operations in a window that may fail before the circuit is opened.
The value is an integer in the range [0,100].</p>
</div>
</dd>
<dt class="hdlist1">sleepWindow</dt>
<dd>
<p>Default: <code>5s</code></p>
<div class="paragraph">
<p>The delay between when the circuit opens and when the canary is tried.</p>
</div>
</dd>
<dt class="hdlist1">rollingWindow</dt>
<dd>
<p>Default: <code>1m</code></p>
<div class="paragraph">
<p>How long the window is in which the number of failed ops are tracked in a rolling fashion.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="timeout-options"><a class="anchor" href="#timeout-options"></a>Timeout Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default timeout values are suitable for most environments, and should be adjusted only after profiling the expected latencies in your deployment environment.
If you get a timeout exception, it may be a symptom of another issue; increasing the timeout duration is sometimes not the best long-term solution.</p>
</div>
<div class="paragraph">
<p>Most timeouts can be overridden on a per-operation basis (for example, by passing a custom options block to a "get" or "query" method).
The values set here are used as the defaults when no per-operation timeout is specified.
See <a href="#duration-values">setting duration values</a> under <a href="#system-properties">System Properties</a>.</p>
</div>
<div class="paragraph">
<p>Timeout settings are represented by the Java class <code>TimeoutConfig</code>.
The associated <code>ClusterEnvironement.Builder</code> method is called <code>timeoutConfig</code>.</p>
</div>
<div class="listingblock">
<div class="title">Template for configuring timeouts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClusterEnvironment env = ClusterEnvironment.builder()
    .timeoutConfig(TimeoutConfig
        .kvTimeout(Duration.ofMillis(2500))
        ...)
    .build()</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="timeout-options-reference"><a class="anchor" href="#timeout-options-reference"></a>Timeout Options Reference</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Name: <strong>Key-Value Timeout</strong></dt>
<dd>
<p>Builder Method: <code>TimeoutConfig.kvTimeout(Duration)</code></p>
<div class="paragraph">
<p>Default: <code>2.5s</code>&#8201;&#8212;&#8201;<em>but see TIP, below</em></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.timeout.kvTimeout</code></p>
</div>
<div class="paragraph">
<p>The Key/Value default timeout is used on operations which are performed on a specific key if not overridden by a custom timeout.
This includes all commands like get(), getFromReplica() and all mutation commands, but does not include operations that are performed with enhanced durability requirements.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<a href="../concept-docs/durability-replication-failure-considerations.html#synchronous-writes" class="page">Durable Write operations</a> have their own timeout setting, <code>kvDurableTimeout</code>, see below.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Key-Value Durable Operation Timeout</strong></dt>
<dd>
<p>Builder Method: <code>TimeoutConfig.kvDurableTimeout(Duration)</code></p>
<div class="paragraph">
<p>Default: <code>10s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.timeout.kvDurableTimeout</code></p>
</div>
<div class="paragraph">
<p>Key/Value operations with enhanced durability requirements may take longer to complete, so they have a separate default timeout.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The <code>kvDurableTimeout</code> property is not part of the stable API and may change or be removed at any time.
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Name: <strong>View Timeout</strong></dt>
<dd>
<p>Builder Method: <code>TimeoutConfig.viewTimeout(Duration)</code></p>
<div class="paragraph">
<p>Default: <code>75s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.timeout.viewTimeout</code></p>
</div>
<div class="paragraph">
<p>The View timeout is used on view operations if not overridden by a custom timeout.
Note that it is set to such a high timeout compared to key/value since it can affect hundreds or thousands of rows.
Also, if there is a node failure during the request the internal cluster timeout is set to 60 seconds.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Query Timeout</strong></dt>
<dd>
<p>Builder Method: <code>TimeoutConfig.queryTimeout(Duration)</code></p>
<div class="paragraph">
<p>Default: <code>75s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.timeout.queryTimeout</code></p>
</div>
<div class="paragraph">
<p>The Query timeout is used on all N1QL query operations if not overridden by a custom timeout.
Note that it is set to such a high timeout compared to key/value since it can affect hundreds or thousands of rows.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Search Timeout</strong></dt>
<dd>
<p>Builder Method: <code>TimeoutConfig.searchTimeout(Duration)</code></p>
<div class="paragraph">
<p>Default: <code>75s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.timeout.searchTimeout</code></p>
</div>
<div class="paragraph">
<p>The Search timeout is used on all FTS operations if not overridden by a custom timeout.
Note that it is set to such a high timeout compared to key/value since it can affect hundreds or thousands of rows.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Analytics Timeout</strong></dt>
<dd>
<p>Builder Method: <code>TimeoutConfig.analyticsTimeout(Duration)</code></p>
<div class="paragraph">
<p>Default: <code>75s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.timeout.analyticsTimeout</code></p>
</div>
<div class="paragraph">
<p>The Analytics timeout is used on all Analytics query operations if not overridden by a custom timeout.
Note that it is set to such a high timeout compared to key/value since it can affect hundreds or thousands of rows.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Connect Timeout</strong></dt>
<dd>
<p>Builder Method: <code>TimeoutConfig.connectTimeout(Duration)</code></p>
<div class="paragraph">
<p>Default: <code>10s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.timeout.connectTimeout</code></p>
</div>
<div class="paragraph">
<p>The connect timeout is used when a Bucket is opened and if not overridden by a custom timeout.
If you feel the urge to change this value to something higher, there is a good chance that your network is not properly set up.
Connecting to the server should in practice not take longer than a second on a reasonably fast network.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Disconnect Timeout</strong></dt>
<dd>
<p>Builder Method: <code>TimeoutConfig.disconnectTimeout(Duration)</code></p>
<div class="paragraph">
<p>Default: <code>10s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.timeout.disconnectTimeout</code></p>
</div>
<div class="paragraph">
<p>The disconnect timeout is used when a Cluster is disconnected and if not overridden by a custom timeout.
A timeout is applied here always to make sure that your code does not get stuck at shutdown.
The default should provide enough time to drain all outstanding operations properly, but make sure to adapt this timeout to fit your application requirements.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Management Timeout</strong></dt>
<dd>
<p>Builder Method: <code>TimeoutConfig.managementTimeout(Duration)</code></p>
<div class="paragraph">
<p>Default: <code>75s</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.timeout.managementTimeout</code></p>
</div>
<div class="paragraph">
<p>The management timeout is used on all cluster management APIs (BucketManager, UserManager, CollectionManager, QueryIndexManager, etc.) if not overridden by a custom timeout.
The default is quite high because some operations (such as flushing a bucket, for example) might take a long time.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="diagnostics-options"><a class="anchor" href="#diagnostics-options"></a>Diagnostics Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The client can periodically log diagnostic information about server connectivity.</p>
</div>
<div class="paragraph">
<p>Diagnostics settings are represented by the Java class <code>DiagnosticsConfig</code>.
The associated <code>ClusterEnvironement.Builder</code> method is called <code>diagnosticsConfig</code>.</p>
</div>
<div class="listingblock">
<div class="title">Template for configuring diagnostics settings</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClusterEnvironment env = ClusterEnvironment.builder()
    .diagnosticsConfig(DiagnosticsConfig
        .enabled(true)
        ...)
    .build()</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Name: <strong>Enabling Diagnostics</strong></dt>
<dd>
<p>Builder Method: <code>DiagnosticsConfig.enabled(boolean)</code></p>
<div class="paragraph">
<p>Default:  <code>false</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.diagnostics.enabled</code></p>
</div>
<div class="paragraph">
<p>If enabled, the client periodically logs diagnostic information.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Diagnostics Interval</strong></dt>
<dd>
<p>Builder Method: <code>DiagnosticsConfig.emitInterval(Duration)</code></p>
<div class="paragraph">
<p>Default:  <code>30m</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.diagnostics.emitInterval</code></p>
</div>
<div class="paragraph">
<p>The interval at which diagnostic information is logged.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="compression-options"><a class="anchor" href="#compression-options"></a>Compression Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The client can optionally compress documents before sending them to Couchbase Server.</p>
</div>
<div class="paragraph">
<p>Compression settings are represented by the Java class <code>CompressionConfig</code>.
The associated <code>ClusterEnvironement.Builder</code> method is called <code>compressionConfig</code>.</p>
</div>
<div class="listingblock">
<div class="title">Template for configuring compression settings</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClusterEnvironment env = ClusterEnvironment.builder()
    .compressionConfig(CompressionConfig
        .enabled(true)
        ...)
    .build()</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Name: <strong>Enabling Compression</strong></dt>
<dd>
<p>Builder Method: <code>CompressionConfig.enabled</code></p>
<div class="paragraph">
<p>Default: <code>true</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.compression.enabled(boolean)</code></p>
</div>
<div class="paragraph">
<p>If enabled, the client will compress documents before they are sent to Couchbase Server.
If this is set to <code>false</code>, the other compression settings have no effect.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Document Minimum Size</strong></dt>
<dd>
<p>Builder Method: <code>CompressionConfig.minSize(int)</code></p>
<div class="paragraph">
<p>Default: <code>32</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.compression.minSize</code></p>
</div>
<div class="paragraph">
<p>Size in bytes.
Documents smaller than this size are never compressed.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Document Minimum Compressibility</strong></dt>
<dd>
<p>Builder Method: <code>CompressionConfig.minRatio(double)</code></p>
<div class="paragraph">
<p>Default: <code>0.83</code></p>
</div>
<div class="paragraph">
<p>System Property: <code>com.couchbase.env.compression.minRatio</code></p>
</div>
<div class="paragraph">
<p>A floating point value between 0 and 1.
Specifies how "compressible" a document must be in order for the compressed form to be sent to the server.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Increasing the value allows compression to be used with less-compressible documents.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the compressed document size divided by the uncompressed document size is greater than this value, then the uncompressed version of the document will be sent to Couchbase Server instead of the compressed version.</p>
</div>
<div class="paragraph">
<p>For example, with a <code>minRatio</code> of <code>0.83</code>, compression will only be used if the size of the compressed document is less than 83% of the uncompressed document size.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="general-options"><a class="anchor" href="#general-options"></a>General Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The settings in this category apply to the client in general.
They are configured directly on the <code>ClusterEnvironment.Builder</code>.</p>
</div>
<div class="listingblock">
<div class="title">Template for configuring general settings</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClusterEnvironment env = ClusterEnvironment.builder()
    .retryStrategy(BestEffortRetryStrategy.INSTANCE)
    ...
    .build()</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Name: <strong>Retry Strategy</strong></dt>
<dd>
<p>Builder Method: <code>retryStrategy(RetryStrategy)</code></p>
<div class="paragraph">
<p>Default:  <code>BestEffortRetryStrategy.INSTANCE</code></p>
</div>
<div class="paragraph">
<p>System Property: N/A</p>
</div>
<div class="paragraph">
<p>The client&#8217;s default retry strategy.</p>
</div>
<div class="paragraph">
<p>A retry strategy decides whether a failed operation should be retried.
Implementing a custom strategy is fairly advanced, so the SDK ships with two out of the box: <code>BestEffortRetryStrategy</code> and <code>FailFastRetryStrategy</code>.</p>
</div>
<div class="paragraph">
<p>The "best effort" strategy will retry the operation until it either succeeds or the timeout expires.
The "fail fast" strategy will immediately report the failure to your application, giving you more control over how and when to retry.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Most client operations that accept an options block allow for overriding the default strategy as one of the options.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See the advanced section in the documentation on more specific information on retry strategies and failure management.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>JSON Serializer</strong></dt>
<dd>
<p>Builder Method: <code>jsonSerializer(JsonSerializer)</code></p>
<div class="paragraph">
<p>Default:  <em>see below</em></p>
</div>
<div class="paragraph">
<p>System Property: N/A</p>
</div>
<div class="paragraph">
<p>The JSON serializer handles the conversion between JSON and Java objects.</p>
</div>
<div class="paragraph">
<p>If Jackson is present in the class path, the default serializer will be an instance of <code>JacksonJsonSerializer</code> using a default <code>ObjectMapper</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To create a serializer backed by a custom <code>ObjectMapper</code>, call <code>JacksonJsonSerializer.create</code> and pass in your custom mapper.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If Jackson is not present, the client will fall back to using an unspecified default serializer.
(Actually, it will use a repackaged version of Jackson, but this is an implementation detail you should not depend on.)</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Transcoder</strong></dt>
<dd>
<p>Builder Method: <code>transcoder(Transcoder)</code></p>
<div class="paragraph">
<p>Default: <code>JsonTranscoder</code></p>
</div>
<div class="paragraph">
<p>System Property: N/A</p>
</div>
<div class="paragraph">
<p>The transcoder is responsible for converting KV binary packages to and from Java objects.</p>
</div>
<div class="paragraph">
<p>The default transcoder assumes you are working with JSON documents.
It uses the configured <code>jsonSerializer</code> to convert between JSON and Java objects.
When writing documents it sets the appropriate flags to indicate the document content is JSON.</p>
</div>
<div class="paragraph">
<p>The transcoder configured here is just the default; it can be overridden on a per-operation basis.</p>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Request Tracer</strong></dt>
<dd>
<p>Builder Method: <code>requestTracer(RequestTracer)</code></p>
<div class="paragraph">
<p>Default:  <code>ThresholdRequestTracer</code></p>
</div>
<div class="paragraph">
<p>System Property: N/A</p>
</div>
<div class="paragraph">
<p>The default tracer logs the slowest requests per service.</p>
</div>
<div class="paragraph">
<p>Various <code>RequestTracer</code> implementations exist, both as part of the core library and as external modules that can be attached (i.e. for OpenTracing and OpenTelemetry).
It is recommended to use those modules and not write your own tracer unless absolutely needed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When using a non-default tracer, you are responsible for starting and stopping it.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Computation Scheduler</strong></dt>
<dd>
<p>Builder Method: <code>scheduler(Scheduler)</code></p>
<div class="paragraph">
<p>Default: <em>see below</em></p>
</div>
<div class="paragraph">
<p>System Property: N/A</p>
</div>
<div class="paragraph">
<p>This is an advanced setting that should not be modified without good reason.</p>
</div>
<div class="paragraph">
<p>The scheduler used for all CPU-intensive, non-blocking computations in the core, client, and user space.
The default is a scheduler created from Reactor&#8217;s <code>Schedulers.newParallel</code> method, with one daemon thread per CPU core.
Extra care should be used when changing the scheduler, since many internal components depend on it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Shutting down the cluster environment will not dispose of a custom scheduler.
You are responsible for disposing of it after it is no longer needed.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">Name: <strong>Event Bus</strong></dt>
<dd>
<p>Builder Method: <code>eventBus(EventBus)</code></p>
<div class="paragraph">
<p>Default:  <code>DefaultEventBus</code></p>
</div>
<div class="paragraph">
<p>System Property: N/A</p>
</div>
<div class="paragraph">
<p>This is an advanced setting that should not be modified without good reason.</p>
</div>
<div class="paragraph">
<p>The event bus implementation used to transport system, performance, and debug events from producers to subscribers.
If you provide a custom implementation, double check that it fits with the contract of the event bus as documented.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Shutting down the cluster environment will not stop a custom event bus.
You are responsible for stopping it after it is no longer needed.
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/logo.svg" alt="Couchbase">
          </a>
        </div>
        <div class="contact">
          <p class="address">3250 Olcott Street
Santa Clara, CA 95054
United States</p>
          <a href="https://www.couchbase.com/contact" class="btn white-btn">Contact Us</a>
          <a class="tel" href="tel:1-650-417-7500">1-650-417-7500</a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Company</span></li>
          <li><a href="https://www.couchbase.com/about">About</a></li>
          <li><a href="https://www.couchbase.com/leadership">Leadership</a></li>
          <li><a href="https://www.couchbase.com/news-and-press-releases">News &amp; Press</a></li>
          <li><a href="https://www.couchbase.com/careers">Careers</a></li>
          <li><a href="https://www.couchbase.com/resources/events">Events</a></li>
          <li><a href="https://www.couchbase.com/contact">Contact Us</a></li>
          <li><a href="https://www.couchbase.com/request-pricing">Pricing</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Support</span></li>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://www.couchbase.com/services">Professional Services</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support Login</a></li>
          <li><a href="https://learn.couchbase.com/store" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Quicklinks</span></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Online Training</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
          <li><a href="https://www.couchbase.com/nosql-resources/why-nosql">Why NoSQL</a></li>
          <li><a href="https://www.couchbase.com/resources/security">Security</a></li>
          <li><a href="https://www.couchbase.com/resources/gdpr">GDPR</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <a href="https://www.facebook.com/Couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="26.363 116.363 560.215 560.215"><path d="m586.58 209.58c0-48.96-44.252-93.212-93.212-93.212h-373.79c-48.96 0-93.212 44.252-93.212 93.212v373.79c0 48.96 44.252 93.212 93.212 93.212h186.42v-211.85h-68.732v-93.212h68.732v-36.72c0-63.083 47.077-119.58 105.45-119.58h75.323v93.212h-75.323c-8.474 0-17.889 10.357-17.889 25.422v37.662h93.212v93.212h-93.212v211.85h99.803c48.96 0 93.212-44.252 93.212-93.212v-373.79z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://twitter.com/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="32.012 176.622 542.326 437.815"><path d="m574.34 227.46c-19.772 8.474-41.428 15.065-64.025 17.889 22.597-14.123 40.486-35.778 48.96-61.2-21.655 13.182-45.194 21.655-70.615 27.305-20.714-21.655-48.96-34.837-80.972-34.837-61.2 0-111.1 49.902-111.1 111.1 0 8.474 0.942 16.948 2.825 25.422-92.271-5.649-174.18-49.902-229.74-117.69-9.415 16.006-15.065 35.778-15.065 55.551 0 38.603 19.772 72.498 49.902 92.271-17.889-0.942-35.778-5.649-50.843-14.123v0.942c0 53.668 38.603 98.862 89.446 109.22-9.415 2.825-18.831 3.766-29.188 3.766-7.532 0-14.123-0.942-20.714-1.883 14.123 44.252 55.551 76.265 103.57 77.206-37.662 30.129-85.68 48.018-138.41 48.018-9.415 0-17.889-0.941-26.363-1.883 48.96 32.012 107.34 49.902 170.42 49.902 204.31 0 316.36-169.48 316.36-316.36v-14.123c21.656-14.125 40.487-33.897 55.551-56.494z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://www.linkedin.com/company/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="31.071 119.188 539.537 540.443"><path d="m531.97 119.19h-461.35c-21.655 0-39.545 16.948-39.545 38.603v463.24c0 21.655 17.889 38.603 39.545 38.603h460.41c21.655 0 39.545-16.948 39.545-38.603v-463.24c0.942-21.656-16.947-38.603-38.603-38.603zm-337.07 451.94h-81.914v-243.86h81.914v243.86zm-40.486-276.81c-28.246 0-46.135-18.831-46.135-42.369s17.889-42.369 46.135-42.369 45.194 17.889 45.194 42.369c0.942 23.538-16.948 42.369-45.194 42.369zm335.19 276.81h-81.914v-129.93c0-32.954-12.24-55.551-41.428-55.551-22.597 0-35.778 15.065-41.428 30.129-1.883 5.649-2.825 12.24-2.825 19.772v136.52h-81.914s0.942-221.26 0-243.86h81.914v34.837c11.298-16.948 30.129-40.486 73.44-40.486 53.668 0 94.154 34.837 94.154 110.16l1e-3 138.41zm-168.54-208.08s0.941-0.941 0 0z"/></svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <span>2019 COUCHBASE All rights reserved.</span>
      <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
      <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
      <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
      <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
    </div>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
