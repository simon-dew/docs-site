<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Rebalancing factors — Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/install-intro.html"><span>Installation and upgrade</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/admin-intro.html"><span>Administration</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../../admin/Misc/admin-basics.html"><span>Administration basics</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Concepts/concept-intro.html"><span>Architecture and concepts</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/security/security-intro.html"><span>Security in Couchbase </span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Concepts/bp-deployment-considerations.html"><span>Deployment considerations</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/Tasks/cluster-management.html"><span>Cluster management</span></a><ul class="sub-sections"><li class="section"><a href="../../admin/Tasks/tasks-manage-serverWarmup.html"><span>Handling server warmup</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Tasks/tasks-manage-replication.html"><span>Handling replication</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Tasks/tasks-compaction.html"><span>Compacting data files</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/Tasks/cluster-maintenance.html"><span>Cluster maintenance</span></a><ul class="sub-sections"><li class="section"><a href="../../admin/Tasks/rebalance-adding-nodes.html"><span>Adding nodes</span></a></li><li class="section"><a href="../../admin/Tasks/rebalance-remove-node.html"><span>Removing nodes</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/Tasks/tasks-rebalance.html"><span>Rebalancing</span></a><ul class="sub-sections"><li class="section"><a href="../../admin/Concepts/concept-rebalancing.html"><span>Rebalancing operation</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Tasks/rebalance-performing.html"><span>Performing a rebalance</span></a></li><li class="section"><a href="../../admin/Tasks/rebalance-behind-the-scenes.html"><span>Rebalance behind-the-scenes</span></a></li><li class="section"><a href="../../admin/Tasks/rebalance-bucket-types.html"><span>Rebalance effect on bucket types</span></a></li><li class="section"><a href="../../admin/Tasks/rebalance-swap-rebalance.html"><span>Swap rebalance</span></a></li><li class="section"><a href="../../admin/Tasks/rebalance-factors.html" class="current"><span>Rebalancing factors</span></a><ul class="sub-sections"></ul></li><li class="section"><a href="../../admin/Tasks/rebalance-questions.html"><span>Common rebalancing questions</span></a></li></ul></li></ul></li><li class="section section--has-sub-sections"><a href="../../admin/Tasks/maintenance-server-node.html"><span>Server maintenance</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Tasks/tasks-backup-restore.html"><span>Backup and restore</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Tasks/tasks-manage-xdcr.html"><span>Managing XDCR</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../admin/Monitoring/monitor-intro.html"><span>Monitoring</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/XDCR/xdcr-intro.html"><span>Cross Datacenter Replication (XDCR)</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/UI/ui-intro.html"><span>Web console</span></a></li><li class="section"><a href="../../admin/Misc/faq.html"><span>FAQs</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Misc/Trbl-intro.html"><span>Troubleshooting</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/cli-intro.html"><span>CLI reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
  <h1 class="title topictitle1" id="ariaid-title1">Rebalancing factors</h1>

  
  <div class="body"><p class="shortdesc">Choosing when, why, and how to rebalance your cluster depends on the scenario.</p>

    <p class="p">Choosing when each of situations applies is not always straightforward and various indicators 
      define when to change the node configuration and when to perform a rebalance.</p>

    
    <section class="section"><h2 class="title sectiontitle">When to expand your cluster</h2>
    <p class="p">You can increase the size of your cluster by adding more nodes. Adding more
          nodes increases the available RAM, disk I/O and network bandwidth available to your client
          applications and helps to spread the load accross more machines. There are a few different
          metrics and statistics you can use to make your decision:</p>

      
      <dl class="dl">
        
          <dt class="dt dlterm">Increase RAM capacity</dt>

          <dd class="dd">One of the most important components in a Couchbase Server cluster is the amount of
            RAM available. RAM not only stores application data and supports the Couchbase Server
            caching layer, it is also actively used for other operations by the server. Reduction in
            the overall available RAM may cause performance problems elsewhere. The following are
            common indicators for increasing RAM capacity within the cluster: <ul class="ul">
              <li class="li">If you see more disk fetches occurring, that means that your application is
                requesting more and more data from disk that is not available in RAM. Increasing the
                RAM in a cluster will allow it to store more data and provide better performance to
                your application.</li>

              <li class="li">If you want to add more buckets to the Couchbase Server cluster, you might need
                more RAM to do so. Adding nodes will increase the overall capacity of the system and
                then you can shrink any existing buckets in order to make room for new ones.</li>

            </ul>
</dd>

        
      </dl>

    
    
    <dl class="dl">
      
        <dt class="dt dlterm">Increase disk I/O throughput</dt>

        <dd class="dd">By adding nodes to the Couchbase Server cluster, you will increase the aggregate amount
            of disk I/O that can be performed across the cluster. This is especially important in
            high-write environments, but can also be a factor when you need to read large amounts of
            data from the disk.</dd>

      
    </dl>

    <dl class="dl">
      
        <dt class="dt dlterm">Increase disk capacity</dt>

        <dd class="dd">You can either add more disk space to the current nodes, or add more nodes to add
            aggregate disk space to the cluster.</dd>

      
    </dl>

      
      <dl class="dl">
        
          <dt class="dt dlterm">Increase network bandwidth</dt>

          <dd class="dd">If you see that you are at the point, or are close to the point, of saturating the
            cluster network bandwidth, it is a very strong indicator that you need more nodes. More
            nodes will cause the overall required network bandwidth to be spread out across these
            additional nodes, which will reduce the individual bandwidth of each node.</dd>

        
      </dl>

    
    </section>

      
      
      
      <section class="section"><h2 class="title sectiontitle">When to shrink your cluster</h2>Choosing to shrink a Couchbase cluster is a
      more subjective decision. It is usually based upon cost considerations, or a change in
      application requirements that doesn't require such a large cluster to support the required
      load. <p class="p">When choosing whether to shrink a cluster:</p>
<ul class="ul">
        <li class="li">Ensure that you have enough capacity in the remaining nodes to support your dataset and
          application load. Removing nodes may have a significant detrimental effect on your cluster
          if there are not enough nodes.</li>

        <li class="li">Avoid removing multiple nodes at once if you are trying to determine the ideal cluster
          size. Instead, remove each node one at a time to understand the impact on the cluster as a
          whole.</li>

        <li class="li">Remove and rebalance a node rather than using failover. When a node fails and is not
          coming back to the cluster, the failover functionality will promote its replica vBuckets
          to become active immediately. If a healthy node is failed over, there might be some data
          loss for the replication data that was in flight during that operation. Using the
            <samp class="ph codeph">remove</samp> functionality will ensure that all data is properly replicated
          and continuously available. </li>

      </ul>
</section>

    
    <section class="section"><h2 class="title sectiontitle">When to rebalance your cluster</h2>

    <p class="p">Once you decide to add or remove nodes, consider the following:</p>

      <ul class="ul">
                <li class="li">If you are planning on adding or removing multiple nodes in a short period of
          time, it is best to add them all at once and then kick-off the rebalancing operation
          rather than rebalance after each addition. This will reduce the overall load placed on the
          system as well as the amount of data that needs to be moved.</li>

                <li class="li">Choose a quiet time for adding nodes. While the rebalancing operation is meant
          to be performed online, it is not a “free” operation and will undoubtedly put increased
          load on the system as a whole in the form of disk I/O, network bandwidth, CPU resources,
          and RAM usage.</li>

                <li class="li">Voluntary rebalancing (that is, not part of a failover situation) should be
          performed during a period of low usage of the system. Rebalancing is a comparatively
          resource intensive operation as the data is redistributed around the cluster and you
          should avoid performing a rebalance during heavy usage periods to avoid having a
          detrimental affect on overall cluster performance.</li>

                <li class="li">Rebalancing requires moving large amounts of data around the cluster. The more
          available RAM will allow the operating system to cache more disk access, which will allow
          it to perform the rebalancing operation much faster. If there is not enough memory in your
          cluster,  rebalancing may be very slow. It is recommended that you don’t wait for your
          cluster to reach full capacity before adding new nodes and rebalancing.</li>

              </ul>

    </section>

    
  </div>

<nav class="related-links"><h2>Related information</h2>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../admin/Tasks/tasks-rebalance.html" title="Rebalancing is the process of redistributing information across nodes.">Rebalancing</a></div>
<div class="previouslink"><strong>Previous topic:</strong> <a class="link" href="../../admin/Tasks/rebalance-swap-rebalance.html" title="Swap rebalance is an automatic process that optimizes the movement of data when you are adding and removing the same number of nodes within the same operation.">Swap rebalance</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../../admin/Tasks/rebalance-questions.html" title="Common questions and answers about the rebalancing operation are addressed.">Common rebalancing questions</a></div>
</div>
</nav></div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../';</script><script src="../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>