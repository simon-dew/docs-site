<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Deployment strategies â€” Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/install-intro.html"><span>Installation and upgrade</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/admin-intro.html"><span>Administration</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../../admin/Misc/admin-basics.html"><span>Administration basics</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Concepts/concept-intro.html"><span>Architecture and concepts</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/security/security-intro.html"><span>Security in Couchbase </span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/Concepts/bp-deployment-considerations.html"><span>Deployment considerations</span></a><ul class="sub-sections"><li class="section"><a href="../../admin/Concepts/swap-space.html"><span>Swap space</span></a></li><li class="section"><a href="../../admin/Concepts/bp-clusterDesign.html"><span>Cluster design considerations</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Concepts/bp-sizingGuidelines.html"><span>Sizing guidelines</span></a></li><li class="section"><a href="../../admin/Concepts/bp-deployment-strategies.html" class="current"><span>Deployment strategies</span></a><ul class="sub-sections"></ul></li><li class="section"><a href="../../admin/Concepts/bp-maintenance.html"><span>Ongoing monitoring and maintenance</span></a></li><li class="section"><a href="../../admin/Concepts/bp-firewall.html"><span>Couchbase behind a secondary firewall</span></a></li><li class="section"><a href="../../admin/Concepts/bp-cloudDeployment.html"><span>Couchbase in the cloud</span></a></li><li class="section"><a href="../../admin/Tasks/xdcr-cloud.html"><span>XDCR in cloud deployments</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../admin/Tasks/cluster-management.html"><span>Cluster management</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Monitoring/monitor-intro.html"><span>Monitoring</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/XDCR/xdcr-intro.html"><span>Cross Datacenter Replication (XDCR)</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/UI/ui-intro.html"><span>Web console</span></a></li><li class="section"><a href="../../admin/Misc/faq.html"><span>FAQs</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Misc/Trbl-intro.html"><span>Troubleshooting</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/cli-intro.html"><span>CLI reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
  <h1 class="title topictitle1" id="ariaid-title1">Deployment strategies</h1>

  <div class="body">
    <p class="p">Here are a number of deployment strategies that you may want to use. Smart clients are the
      preferred deployment option if your language and development environment supports a smart
      client library. If not, use the client-side Moxi configuration for the best performance and
      functionality.</p>

    <section class="section"><h2 class="title sectiontitle">Using a smart (vBucket-aware) client</h2><p class="p">When using a smart client, the
        client library provides an interface to the cluster and performs server selection directly
        via the vBucket mechanism. The clients communicate with the cluster using a custom Couchbase
        protocol. This enables the clients to share the vBucket map, locate the node containing the
        required vBucket, and read and write information from there.</p>

      <img class="image" src="../images/couchbase-060711-1157-32_img_281.jpg" width="720">
      <p class="p">In releases prior to Couchbase Server 2.5, a developer, via a client library of their
        choice, randomly selects a host from which to request an initial topology configuration. Any
        future changes to the cluster map following the initial bootstrap are based on the
        NOT_MY_VBUCKET response from the server. This connection is made to port 8091 and is based
        on an HTTP connection. </p>
<p class="p">With Couchbase Server 2.5 or higher, client libraries query a
        cluster for initial topology configuration for a bucket from one of the nodes in the
        cluster. This is similar to prior releases. However, this information is transmitted via the
        memcached protocol on port 11210 (rather than via persistent HTTP connections to port 8091).
        This significantly improves connection scaling capabilities.</p>

      <div class="note note"><span class="notetitle">Note:</span> This change is only applicable to Couchbase-type buckets (not memcached
        buckets). An error is returned if a configuration request is received on port 8091.
      </div>
</section>

    <section class="section"><h2 class="title sectiontitle">Client-side (standalone) proxy</h2>
      <p class="p">If a smart client is not available for your chosen platform, you can deploy a standalone
        proxy. This provides the same functionality as the smart client while presenting a memcached
        compatible interface layer locally. A standalone proxy deployed on a client may also be able
        to provide valuable services, such as connection pooling. The diagram below shows the flow
        with a standalone proxy installed on the application server.</p>

      <img class="image" src="../images/couchbase-060711-1157-32_img_280.jpg" width="720">
      <p class="p">We configured the memcached client to have just one server in its server list (localhost),
        so all operations are forwarded to <samp class="ph codeph">localhost:11211</samp> â€” a port serviced by the
        proxy. The proxy hashes the document ID to a vBucket, looks up the host server in the
        vBucket table, and then sends the operation to the appropriate Couchbase Server on port
        11210.</p>
<p class="p">For the corresponding Moxi product, use the Moxi 1.8 series.</p>

    </section>

    
    <section class="section"><h2 class="title sectiontitle">Using server-side (Couchbase embedded) proxy</h2>
      <div class="note attention"><span class="attentiontitle">Attention:</span> Server-side proxy configuration is <em class="ph i">not</em> recommended for
        production use. Use either a smart client or the client-side proxy configuration unless your
        platform and environment do not support that deployment type.</div>
<p class="p">The server-side
        (embedded) proxy exists within Couchbase Server using port 11211. It supports the memcached
        protocol and enables an existing application to communicate with Couchbase Cluster without
        installing another piece of proxy software. The downside to this approach is
        performance.</p>
<p class="p">In this deployment option versus a typical memcached deployment, in a
        worse-case scenario, server mapping happens twice (such as using Ketama hashing to a server
        list on the client, then using vBucket hashing and server mapping on the proxy) with an
        additional round trip network hop introduced.</p>

      <img class="image" src="../images/couchbase-060711-1157-32_img_279.jpg" width="720">
    </section>

    
  </div>

  <nav class="related-links"><h2>Related information</h2>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../admin/Concepts/bp-deployment-considerations.html" title="Deployment configuration take into account topics such as restricted access, node communication, swap configuration, and connection timeouts.">Deployment considerations</a></div>
<div class="previouslink"><strong>Previous topic:</strong> <a class="link" href="../../admin/Concepts/bp-sizingGuidelines.html" title="The primary considerations for sizing a Couchbase Server cluster are the number of nodes and node size.">Sizing guidelines</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../../admin/Concepts/bp-maintenance.html" title="There are a number of different statistics used to monitor a cluster and diagnose and identify problems.">Ongoing monitoring and maintenance</a></div>
</div>

<div class="linklist linklist">
<div><a class="link" href="http://dustin.github.com/2010/06/29/memcached-vbuckets.html" target="_blank">vBucket article</a></div>
<div><a class="link" href="http://docs.couchbase.com/moxi-guide/" target="_blank">Moxi 1.8 Manual</a></div></div>
</nav>
</div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">Â© 2011â€“2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../';</script><script src="../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>