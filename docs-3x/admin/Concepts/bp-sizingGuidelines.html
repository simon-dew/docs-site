<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Sizing guidelines — Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/install-intro.html"><span>Installation and upgrade</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/admin-intro.html"><span>Administration</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../../admin/Misc/admin-basics.html"><span>Administration basics</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Concepts/concept-intro.html"><span>Architecture and concepts</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/security/security-intro.html"><span>Security in Couchbase </span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/Concepts/bp-deployment-considerations.html"><span>Deployment considerations</span></a><ul class="sub-sections"><li class="section"><a href="../../admin/Concepts/swap-space.html"><span>Swap space</span></a></li><li class="section"><a href="../../admin/Concepts/bp-clusterDesign.html"><span>Cluster design considerations</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/Concepts/bp-sizingGuidelines.html" class="current"><span>Sizing guidelines</span></a><ul class="sub-sections"><li class="section"><a href="../../admin/Concepts/bp-disk-throughput.html"><span>Disk throughput and sizing</span></a></li></ul></li><li class="section"><a href="../../admin/Concepts/bp-deployment-strategies.html"><span>Deployment strategies</span></a></li><li class="section"><a href="../../admin/Concepts/bp-maintenance.html"><span>Ongoing monitoring and maintenance</span></a></li><li class="section"><a href="../../admin/Concepts/bp-firewall.html"><span>Couchbase behind a secondary firewall</span></a></li><li class="section"><a href="../../admin/Concepts/bp-cloudDeployment.html"><span>Couchbase in the cloud</span></a></li><li class="section"><a href="../../admin/Tasks/xdcr-cloud.html"><span>XDCR in cloud deployments</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../admin/Tasks/cluster-management.html"><span>Cluster management</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Monitoring/monitor-intro.html"><span>Monitoring</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/XDCR/xdcr-intro.html"><span>Cross Datacenter Replication (XDCR)</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/UI/ui-intro.html"><span>Web console</span></a></li><li class="section"><a href="../../admin/Misc/faq.html"><span>FAQs</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Misc/Trbl-intro.html"><span>Troubleshooting</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/cli-intro.html"><span>CLI reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
	<h1 class="title topictitle1" id="ariaid-title1">Sizing guidelines</h1>

	
	<div class="body"><p class="shortdesc">The primary considerations for sizing a Couchbase Server cluster are the number of
		nodes and node size.</p>

		<p class="p">When sizing your Couchbase Server cluster, ask the following questions:</p>

		<ul class="ul">
			<li class="li">How many nodes do I need?</li>

			<li class="li">How large (RAM, CPU, disk space) must those nodes be?</li>

		</ul>

		<p class="p">To determine the number of nodes needed for a cluster, consider the following:</p>

		<ul class="ul">
			<li class="li">RAM</li>

			<li class="li">Disk throughput and sizing</li>

			<li class="li">Network bandwidth</li>

			<li class="li">Data distribution and safety</li>

		</ul>

		<p class="p">Due to the in-memory nature of Couchbase Server, RAM is usually the determining factor for
			sizing. However, the primary sizing factor depends on the actual data set and the
			information being stored. For example:</p>

		<ul class="ul">
			<li class="li">If you have a very small data set with a very high load, you must calculate the size based
				more on the network bandwidth than RAM.</li>

			<li class="li">If you have a very high write rate, you’ll need more nodes to support the disk throughput
				that is needed to persist all that data (and likely more RAM to buffer the incoming
				writes).</li>

			<li class="li">Even with a very small dataset under low load, you might want three nodes for proper
				distribution and safety.</li>

		</ul>

		<p class="p">You can increase the capacity of your cluster (RAM, disk, CPU, or network) by increasing the
			number of nodes within the cluster. Each limit will be increased linearly as the cluster
			size is increased.</p>

		
		<dl class="dl">
			
				<dt class="dt dlterm">RAM sizing</dt>

				<dd class="dd">RAM is usually the most critical sizing parameter. It is also the one that can have the most
					impact on performance and stability.</dd>

			
		</dl>

		<dl class="dl">
			
				<dt class="dt dlterm">Working set</dt>

				<dd class="dd">The working set is the data that the client application actively uses at any point in time.
					Ideally, all of the working set lives in memory, which impacts the amount of
					needed memory.</dd>

			
		</dl>

<dl class="dl">
	
		<dt class="dt dlterm">Memory quota</dt>

		<dd class="dd">It is very important that your Couchbase cluster’s size corresponds to the working set size
					and total data you expect. The goal is to size the available RAM so that all
					your document IDs, the document ID meta data, and the working set values fit.
					The memory must rest just below the point at which Couchbase Server will
					start evicting values to disk (the High Water Mark).</dd>

	
</dl>

		
			
			<div class="note important"><span class="importanttitle">Important:</span> You will not be able to allocate all your machine RAM to a Couchbase
			Server node (<samp class="ph codeph">per_node_ram_quota</samp> parameter) because other programs might
			be running on your machine.</div>

			
			<p class="p">How much memory and disk space per node you will need depends on several different
			variables.</p>

		<div class="note important"><span class="importanttitle">Important:</span> The maximal memory quota that Couchbase Server allows is computed from the
			total size of RAM in your machines. For optimal performance, it is recommended to leave
			a buffer from at least 20% between the quota size and the physical RAM size. For
			workloads with views, it is advised to leave even more memory for operating system's
			page cache. For such configurations, it is currently recommended to set memory quota to
			60% of the physical RAM size.</div>

			
			<p class="p">The following are per-bucket calculations and must be summed up across all buckets. If all
			the buckets have the same configuration, treat the total data as a single bucket. There
			is no per-bucket overhead that needs to be considered.</p>

			
			
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
				<col style="width:25%">
				<col style="width:75%">
				<thead class="thead" style="text-align:left;">
					<tr class="row">
						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e128">Variable</th>

						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e131">Description</th>

					</tr>

				</thead>

				<tbody class="tbody">
					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e128 "><var class="keyword varname">documents_num</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e131 ">The total number of documents you expect in your working set</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e128 "><var class="keyword varname">ID_size</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e131 ">The average size of document IDs</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e128 "><var class="keyword varname">value_size</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e131 ">The average size of values</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e128 "><var class="keyword varname">number_of_replicas</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e131 ">The number of copies of the original data you want to keep</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e128 "><var class="keyword varname">working_set_percentage</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e131 ">The percentage of your data you want in memory</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e128 "><var class="keyword varname">per_node_ram_quota</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e131 ">How much RAM can be assigned to Couchbase </td>

					</tr>

				</tbody>

			</table>
</div>

			
			<p class="p">Use the following items to calculate how much memory you need:</p>

			
			
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
				<col style="width:33.33333333333333%">
				<col style="width:66.66666666666666%">
				<thead class="thead" style="text-align:left;">
					<tr class="row">
						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e217">Constant</th>

						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e220">Description</th>

					</tr>

				</thead>

				<tbody class="tbody">
					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e217 ">Metadata per document (metadata_per_document)</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e220 ">This is the amount of memory that Couchbase needs to store metadata
							per document. Metadata uses 56 bytes. All the metadata needs to live in
							memory while a node is running and serving data.</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e217 ">SSD or Spinning</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e220 ">SSDs give better I/O performance.</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e217 ">headroom</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e220 ">The cluster needs additional overhead to store metadata called <dfn class="term">headroom</dfn>,
							which requires approximately 25–30% more space than the raw RAM
							requirements for your dataset. Since SSDs are faster than spinning
							(traditional) hard disks, you should set aside 25% of memory for SSDs
							and 30% of memory for spinning hard disks.</td>

					</tr>

					
					
					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e217 ">High Water Mark (high_water_mark)</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e220 ">By default, the high water mark for a node’s RAM is set at 85%.
						</td>

					</tr>

				</tbody>

			</table>
</div>
<p class="p">The rough guidelines to size your cluster are as follows:</p>

			
			
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
				<col style="width:33.33333333333333%">
				<col style="width:66.66666666666666%">
				<thead class="thead" style="text-align:left;">
					<tr class="row">
						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e284">Variable</th>

						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e287">Calculation</th>

					</tr>

				</thead>

				<tbody class="tbody">
					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e284 "><var class="keyword varname">no_of_copies</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e287 "><samp class="ph codeph">1 + number_of_replicas</samp></td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e284 "><var class="keyword varname">total_metadata</var>. All the documents need to live in the memory.</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e287 "><samp class="ph codeph">(documents_num) * (metadata_per_document + ID_size) *
								(no_of_copies)</samp></td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e284 "><var class="keyword varname">total_dataset</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e287 "><samp class="ph codeph">(documents_num) * (value_size) *
							(no_of_copies)</samp></td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e284 "><var class="keyword varname">working_set</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e287 "><samp class="ph codeph">total_dataset * (working_set_percentage)</samp></td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e284 ">Cluster RAM quota required</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e287 "><samp class="ph codeph">(total_metadata + working_set) * (1 + headroom) /
								(high_water_mark)</samp></td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e284 ">number of nodes</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e287 "><samp class="ph codeph">Cluster RAM quota required / per_node_ram_quota</samp>
						</td>

					</tr>

				</tbody>

			</table>
</div>

			
			<div class="note important"><span class="importanttitle">Important:</span> You will need at least the number of replicas + 1 nodes regardless of your
				data size.</div>

			<p class="p">The following is a sample sizing calculation:</p>

			
			
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
				<col style="width:25%">
				<col style="width:75%">
				<thead class="thead" style="text-align:left;">
					<tr class="row">
						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e382">Input Variable</th>

						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e385">value</th>

					</tr>

				</thead>

				<tbody class="tbody">
					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e382 "><var class="keyword varname">documents_num</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e385 ">1,000,000</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e382 "><var class="keyword varname">ID_size</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e385 ">100</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e382 "><var class="keyword varname">value_size</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e385 ">10,000</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e382 "><var class="keyword varname">number_of_replicas</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e385 ">1</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e382 "><var class="keyword varname">working_set_percentage</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e385 ">20% </td>

					</tr>

				</tbody>

			</table>
</div>

				
				
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
				<col style="width:25%">
				<col style="width:75%">
				<thead class="thead" style="text-align:left;">
					<tr class="row">
						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e457">Constants</th>

						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e460">value</th>

					</tr>

				</thead>

				<tbody class="tbody">
					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e457 ">Type of Storage</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e460 ">SSD</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e457 ">overhead_percentage</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e460 ">25%</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e457 ">metadata_per_document</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e460 ">56 for 2.1 and higher, 64 for 2.0.x</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e457 ">high_water_mark</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e460 ">85% </td>

					</tr>

				</tbody>

			</table>
</div>

			
			
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
				<col style="width:16.666666666666664%">
				<col style="width:83.33333333333334%">
				<thead class="thead" style="text-align:left;">
					<tr class="row">
					
						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e519">Variable</th>

						<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d41491e522">Calculation</th>

					</tr>

				</thead>

				<tbody class="tbody">
					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e519 "><var class="keyword varname">no_of_copies</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e522 ">= 1 for original and 1 for replica</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e519 "><var class="keyword varname">total_metadata</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e522 ">= 1,000,000 * (100 + 56) * (2) = 312,000,000</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e519 "><var class="keyword varname">total_dataset</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e522 ">= 1,000,000 * (10,000) * (2) = 20,000,000,000</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e519 "><var class="keyword varname">working_set</var></td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e522 ">= 20,000,000,000 * (0.2) = 4,000,000,000</td>

					</tr>

					<tr class="row">
						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e519 ">Cluster RAM quota required</td>

						<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d41491e522 ">= (312,000,000 + 4,000,000,000) * (1+0.25)/(0.85) = 6,341,176,470</td>

					</tr>

				</tbody>

			</table>
</div>

			
			<p class="p">For example, if you have 8GB machines and you want to use 6 GB for Couchbase:</p>

			
			<pre class="pre codeblock"><code>number of nodes =
    Cluster RAM quota required/per_node_ram_quota =
    7.9 GB/6GB = 1.3 or 2 nodes
</code></pre>

			
			
		
	
		
		<section class="section"><h2 class="title sectiontitle">Network bandwidth</h2>
			<p class="p">Network bandwidth is not normally a significant
				factor to consider for cluster sizing. However, clients require network bandwidth to
				access information in the cluster. Nodes also need network bandwidth to exchange
				information (node to node).</p>

			
			<p class="p">In general, calculate your network bandwidth requirements using the following formula:</p>

			
			<pre class="pre codeblock"><code>Bandwidth = (operations per second * item size) + overhead for rebalancing </code></pre>

			
			<p class="p">Calculate the <samp class="ph codeph">operations per second</samp> with the following formula:</p>

			
			<pre class="pre codeblock"><code>Operations per second = Application reads + (Application writes * Replica copies) </code></pre>

			</section>

		
		<section class="section"><h2 class="title sectiontitle">Data safety</h2>
			<p class="p">Make sure you have enough nodes (and the right
				configuration) in your cluster to keep your data safe. There are two areas to keep
				in mind: how you distribute data across nodes and how many replicas you store across
				your
				cluster.</p>

		</section>

		
		<section class="section"><h2 class="title sectiontitle">Data distribution</h2>More nodes are better than less. If you only have two
			nodes, your data is split across the two nodes, and half of your dataset is impacted if
			one goes away. On the other hand, with ten nodes, only 10% of the dataset is impacted if
			one node goes away. Even with automatic failover, there still is a period when data is
			unavailable if nodes fail, which is mitigated by having more nodes.<p class="p">After a failover,
				the cluster takes on an extra load. The question is - how heavy is that extra load
				and are you prepared for it? Again, with only two nodes, each one needs to be ready
				to handle the entire load. With ten, each node only needs to be able to take on an
				extra tenth of the workload should one fail.</p>
<p class="p">While two nodes does provide a
				minimal level of redundancy, we recommend that you always use at least three
				nodes.</p>
</section>

		
		<section class="section"><h2 class="title sectiontitle">Replication</h2>
			<p class="p">Couchbase Server authorizes you to configure up to three replicas (creating four copies of the dataset). 
				In the event of a failure, you can only “fail over” (either manually or automatically) as many nodes as you have
				replicas. 
				For example:</p>

			<ul class="ul">
				<li class="li">In a five node cluster with one replica, if one node goes down, you can fail
						it over. If a second node goes down, you no longer have enough replica
						copies to fail over to and will have to go through a slower process to
						recover.</li>

				<li class="li">In a five node cluster with two replicas, if one node goes down, you can fail
						it over. If a second node goes down, you can fail it over as well. Should a
						third one go down, you now no longer have replicas to fail over.</li>

			</ul>

			<p class="p">After a node goes down and is failed over, try to replace that node as soon as
				possible and rebalance. The rebalance recreates the replica copies (if you still
				have enough nodes to do so).</p>

			
			<div class="note tip"><span class="tiptitle">Tip:</span> As a rule of thumb, configure the following:
			<ul class="ul">
				<li class="li">One replica for up to five nodes.</li>

				<li class="li">One or two replicas for five to ten nodes.</li>

				<li class="li">One, two, or three replicas for over ten nodes.</li>

			</ul>

				While there can be variations to this, there are diminishing returns from having more replicas in smaller clusters.
			</div>

			
			</section>

		
		<section class="section"><h2 class="title sectiontitle">Hardware requirements</h2>
			<p class="p">In general, Couchbase Server has very low
				hardware requirements and is designed to be run on commodity or virtualized systems.
				However, as a rough guide to the primary concerns for your servers, the following is recommended:
				</p>

			<ul class="ul">
				<li class="li">RAM: This is your primary consideration. We use RAM to store active items,
						and that is the key reason Couchbase Server has such low latency.</li>

				<li class="li">CPU: Couchbase Server has very low CPU requirements. The server is multi-threaded and,
					therefore, benefits from a multi-core system. We recommend machines with at
					least four or eight physical cores.</li>

				<li class="li">Disk: By decoupling the RAM from the I/O layer, Couchbase Server can support
						low-performance disks better than other databases. 
						As a best practice, have separate devices for server install, data
						directories, and index directories.</li>

				<li class="li">Network: Most configurations work with Gigabit Ethernet interfaces. Faster
					solutions such as 10GBit and Infiniband will provide spare capacity.</li>

			</ul>

			<p class="p">Known working configurations include SAN, SAS, SATA, SSD, and EBS with the
				following recommendations:</p>

			
			<ul class="ul">
				<li class="li">SSDs have been shown to provide a great performance boost both in terms of
  draining the write queue and also in restoring data from disk (either on
  cold-boot or for purposes of rebalancing).</li>

				<li class="li">RAID provides better throughput and reliability.</li>

				<li class="li">Striping across EBS volumes (in Amazon EC2) has been shown to increase throughput.</li>

			</ul>


		</section>

		
		<section class="section"><h2 class="title sectiontitle">Considerations for Cloud environments (that is Amazon EC2)</h2>
			<p class="p">Due to the unreliability and general lack of consistent I/O performance in cloud environments,
				you should lower the per-node RAM footprint and increase the number of nodes. By
				doing that, you can achieve a better disk throughput and improve rebalancing since
				each node will have to store (and transmit) less data. When you further distribute
				the data, the impact of losing a single node will be diminished.</p>

		</section>

	</div>

	<nav class="related-links"><h2>Related information</h2>
<ol class="olchildlinks">
<li class="link olchildlink"><a href="../../admin/Concepts/bp-disk-throughput.html">Disk throughput and sizing</a><br>
Couchbase Server decouples RAM from the     I/O layer to enable high scaling.</li>
</ol>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../admin/Concepts/bp-deployment-considerations.html" title="Deployment configuration take into account topics such as restricted access, node communication, swap configuration, and connection timeouts.">Deployment considerations</a></div>
<div class="previouslink"><strong>Previous topic:</strong> <a class="link" href="../../admin/Concepts/bp-clusterDesign.html" title="Cluster design takes into account topics such as RAM, number of nodes and cores, client or server-side moxi, and so on.">Cluster design considerations</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../../admin/Concepts/bp-deployment-strategies.html">Deployment strategies</a></div>
</div>

<div class="linklist linklist">
<div><a class="link" href="bp-cloudDeployment.html" title="Couchbase Server is extremely easy to deploy in the cloud.">Couchbase in the cloud</a></div></div>
</nav>
</div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../';</script><script src="../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>