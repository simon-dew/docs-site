<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Changing shared thread pool settings — Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections"><a href="../../../admin/install-intro.html"><span>Installation and upgrade</span></a></li><li class="section section--has-sub-sections"><a href="../../../admin/admin-intro.html"><span>Administration</span></a></li><li class="section section--has-sub-sections"><a href="../../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../../admin/cli-intro.html"><span>CLI reference</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../../../admin/CLI/cli-overview.html"><span>CLI overview</span></a></li><li class="section section--has-sub-sections"><a href="../../../admin/CLI/cbcli-intro.html"><span>couchbase-cli tool</span></a></li><li class="section"><a href="../../../admin/CLI/cbanalyze-core_tool.html"><span>cbanalyze-core tool</span></a></li><li class="section section--has-sub-sections"><a href="../../../admin/CLI/cbbackup_tool.html"><span>cbbackup tool</span></a></li><li class="section"><a href="../../../admin/CLI/cbcollect_info_tool.html"><span>cbcollect_info tool</span></a></li><li class="section"><a href="../../../admin/CLI/cbdocloader_tool.html"><span>cbdocloader tool</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../../admin/CLI/cbepctl-intro.html"><span>cbepctl tool</span></a><ul class="sub-sections"><li class="section"><a href="../../../admin/CLI/CBepctl/cbepctl-threadpool-tuning.html" class="current"><span>Changing shared thread pool settings</span></a><ul class="sub-sections"></ul></li><li class="section"><a href="../../../admin/CLI/CBepctl/cbepctl-thresholds.html"><span>Changing ejection thresholds</span></a></li><li class="section"><a href="../../../admin/CLI/CBepctl/cbepctl-accesslog.html"><span>Changing access log settings</span></a></li><li class="section"><a href="../../../admin/CLI/CBepctl/cbepctl-diskcleanup.html"><span>Changing disk cleanup intervals</span></a></li><li class="section"><a href="../../../admin/CLI/CBepctl/cbepctl-diskwritequeue.html"><span>Changing disk write queue quotas</span></a></li><li class="section"><a href="../../../admin/CLI/CBepctl/cbepctl-timeout.html"><span>Changing out-of-memory thresholds</span></a></li></ul></li><li class="section"><a href="../../../admin/CLI/cbhealthchecker_tool.html"><span>cbhealthchecker tool</span></a></li><li class="section"><a href="../../../admin/CLI/cbreset_password_tool.html"><span>cbreset_password tool</span></a></li><li class="section section--has-sub-sections"><a href="../../../admin/CLI/cbrestore_tool.html"><span>cbrestore tool</span></a></li><li class="section section--has-sub-sections"><a href="../../../admin/CLI/cbstats-intro.html"><span>cbstats tool</span></a></li><li class="section"><a href="../../../admin/CLI/cbtransfer_tool.html"><span>cbtransfer tool</span></a></li><li class="section"><a href="../../../admin/CLI/cbworkloadgen_tool.html"><span>cbworkloadgen tool</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections"><a href="../../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a></li><li class="section section--has-sub-sections"><a href="../../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
  <h1 class="title topictitle1" id="ariaid-title1">Changing shared thread pool settings</h1>

  
  <div class="body refbody"><p class="shortdesc">Dynamic shared thread pool performance is tunable via <samp class="ph codeph">cbepctl set flush_param</samp> command options.</p>

    <section class="section"><h2 class="title sectiontitle">Description</h2>
      <p class="p">The dynamic shared thread pool performance is tunable by changing the thread types inside
        the ep-engine and memcached at run time. <samp class="ph codeph">cbepctl set flush_param</samp> command
        options adjust the number of threads that prioritize read, write, non-i/o and auxiliary-i/o
        operations. These settings take effect immediately and do not require that the bucket be
        restarted. </p>

        
      <div class="note note"><span class="notetitle">Note:</span> These settings only take effect if the underlying operating system has a
        sufficient number of CPU cores. The minimum number of CPU cores is four (4), however,  
        three (3) additional cores are required for each additional writer thread. 
        For example, five (5) writer threads is a valid setting if the underlying hardware has at least 
        sixteen (16) cores.</div>

    
      
      <p class="p">The following are the command option parameters used for performance tuning:</p>

      
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap">Table 1. Performance tuning parameters</span></caption>
          <col style="width:50%">
          <col style="width:50%">
          <thead class="thead" style="text-align:left;">
            <tr class="row">
              <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d10296e49">Parameter</th>

              <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d10296e52">Description</th>

            </tr>

          </thead>

          <tbody class="tbody">
            <tr class="row">
              <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d10296e49 ">max_num_readers</td>

              <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d10296e52 ">Overrides the default number of global threads that prioritize read operations.</td>

            </tr>

            <tr class="row">
              <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d10296e49 ">max_num_writers</td>

              <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d10296e52 ">Overrides the default number of global threads that prioritize write operations.</td>

            </tr>

            <tr class="row">
              <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d10296e49 ">max_num_auxio</td>

              <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d10296e52 ">Overrides the default number of global threads that prioritize auxio operations.</td>

            </tr>

            <tr class="row">
              <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d10296e49 ">max_num_nonio</td>

              <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d10296e52 ">Overrides the default number of global threads that prioritize nonio operations.</td>

            </tr>

          </tbody>

        </table>
</div>

      
    </section>

    
    <section class="section"><h2 class="title sectiontitle">Syntax</h2>
      <p class="p">The following is the basic syntax:</p>

      <pre class="pre codeblock"><code>cbepctl [localhost]:11210 -b [bucket-name] set flush_param [parameter] [value]</code></pre>


    </section>

    
    <section class="section"><h2 class="title sectiontitle">Example</h2>
      <p class="p">To set the maximum number of writers, use <samp class="ph codeph">max_num_writers</samp> parameter. 
        In the following example, <samp class="ph codeph">max_num_writers</samp> sets the number of writer threads to five (5).</p>

      <pre class="pre codeblock"><code>cbepctl 10.5.2.117:11210 -b foo_bucket set flush_param max_num_writers 5 </code></pre>

      
      
      
    </section>

    
    <section class="section"><h2 class="title sectiontitle">Response</h2>
      <p class="p">The following is an example response when setting the maximum number of writer threads.</p>

      <pre class="pre codeblock"><code>
setting param: max_num_writers 5
set max_num_writers to 5
      </code></pre>

      
      
      <p class="p">To check how many threads of various types are currently running, use <samp class="ph codeph">cbstats workload</samp>. 
        For example:</p>

      <pre class="pre codeblock"><code>cbstats [localhost]:11210 -b [bucket-name] workload </code></pre>

      
      <p class="p">For example, the following shows an example request and response for <samp class="ph codeph">cbstats
          workload</samp>, in this case, for the default bucket. The setting change,
          <samp class="ph codeph">ep_workload:max_writers: 5</samp>, is displayed via the <samp class="ph codeph">cbstats
          workload</samp> response: </p>

      
      <pre class="pre codeblock"><code>
cbstats 10.5.2.117:11210 workload

 ep_workload:LowPrioQ_AuxIO:InQsize:   2
 ep_workload:LowPrioQ_AuxIO:OutQsize:  0
 ep_workload:LowPrioQ_NonIO:InQsize:   18
 ep_workload:LowPrioQ_NonIO:OutQsize:  0
 ep_workload:LowPrioQ_Reader:InQsize:  8
 ep_workload:LowPrioQ_Reader:OutQsize: 0
 ep_workload:LowPrioQ_Writer:InQsize:  12
 ep_workload:LowPrioQ_Writer:OutQsize: 0
 ep_workload:max_auxio:                1
 ep_workload:max_nonio:                1
 ep_workload:max_readers:              4
 ep_workload:max_writers:              5
 ep_workload:num_auxio:                1
 ep_workload:num_nonio:                1
 ep_workload:num_readers:              4
 ep_workload:num_shards:               4
 ep_workload:num_sleepers:             10
 ep_workload:num_writers:              5
 ep_workload:ready_tasks:              0
      </code></pre>

      
    </section>

    
    
  </div>

<nav class="related-links"><h2>Related information</h2>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../../admin/CLI/cbepctl-intro.html" title="The cbepctl tool is used to control vBucket states, configuration, and memory and disk persistence behavior.">cbepctl tool</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../../../admin/CLI/CBepctl/cbepctl-thresholds.html" title="The item pager process ejects items from RAM when too much space is being taken up in RAM.">Changing ejection thresholds</a></div>
</div>
</nav></div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../../';</script><script src="../../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>