<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>cbbackup tool â€” Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/install-intro.html"><span>Installation and upgrade</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/admin-intro.html"><span>Administration</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/cli-intro.html"><span>CLI reference</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../../admin/CLI/cli-overview.html"><span>CLI overview</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/CLI/cbcli-intro.html"><span>couchbase-cli tool</span></a></li><li class="section"><a href="../../admin/CLI/cbanalyze-core_tool.html"><span>cbanalyze-core tool</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/CLI/cbbackup_tool.html" class="current"><span>cbbackup tool</span></a><ul class="sub-sections"><li class="section"><a href="../../admin/CLI/cbbackup-ddocs.html"><span>Backing up design documents</span></a></li><li class="section"><a href="../../admin/CLI/cli-increment-backup.html"><span>Backing up incrementally</span></a></li></ul></li><li class="section"><a href="../../admin/CLI/cbcollect_info_tool.html"><span>cbcollect_info tool</span></a></li><li class="section"><a href="../../admin/CLI/cbdocloader_tool.html"><span>cbdocloader tool</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/CLI/cbepctl-intro.html"><span>cbepctl tool</span></a></li><li class="section"><a href="../../admin/CLI/cbhealthchecker_tool.html"><span>cbhealthchecker tool</span></a></li><li class="section"><a href="../../admin/CLI/cbreset_password_tool.html"><span>cbreset_password tool</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/CLI/cbrestore_tool.html"><span>cbrestore tool</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/CLI/cbstats-intro.html"><span>cbstats tool</span></a></li><li class="section"><a href="../../admin/CLI/cbtransfer_tool.html"><span>cbtransfer tool</span></a></li><li class="section"><a href="../../admin/CLI/cbworkloadgen_tool.html"><span>cbworkloadgen tool</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
   <h1 class="title topictitle1" id="ariaid-title1">cbbackup tool</h1>

   
   
   <div class="body refbody"><p class="shortdesc">The <samp class="ph codeph">cbbackup</samp> tool creates a copy of data from an entire running cluster,
      an entire bucket, a single node, or a single bucket on a single functioning node.</p>

      <section class="section"><h2 class="title sectiontitle">Description</h2>
      <p class="p">The backup process writes a copy of data onto disk. 
         To create a backup using <samp class="ph codeph">cbbackup</samp>, the node or cluster needs to be functioning in order.</p>


      <p class="p">The <samp class="ph codeph">cbbackup</samp>, <samp class="ph codeph">cbrestore</samp>, and <samp class="ph codeph">cbtransfer</samp>
         tools do not communicate with external IP addresses for server nodes outside of a cluster.
         Backup, restore, or transfer operations are performed on data from a node within a
         Couchbase cluster. They only communicate with nodes from a node list obtained within a
         cluster. This also means that if Couchbase Server is installed with a default IP address,
         an external hostname cannot be used to access it.</p>

         
         <p class="p">This tool has several different options which you can use to:</p>

         <ul class="ul">
            <li class="li">Backup all buckets in an entire cluster</li>

            <li class="li">Backup one named bucket in a cluster</li>

            <li class="li">Backup all buckets on a node in a cluster</li>

            <li class="li">Backup one named buckets on a specified node</li>

         </ul>

         
         <div class="note tip"><span class="tiptitle">Tip:</span> We recommended that <samp class="ph codeph">cbbackup</samp> output be generated on a file system 
            local to the server. Specifically, back up to a dedicated partition. 
            A dedicated partition prevents the backup from from filling the Couchbase data stores and operating system partitions.</div>

         
         
         <div class="cautiontitle">CAUTION:</div><div class="note caution">Avoid routing the  <samp class="ph codeph">cbbackup</samp> output to remote share file systems (NFS). 
            This is because  <samp class="ph codeph">cbbackup</samp> files are based on sqlite format and sqlite-formatted  file have issues being written to remote file systems.</div>

        
         
      <p class="p">This tool is the following directories:</p>


      
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
            <col style="width:50%">
            <col style="width:50%">
            <thead class="thead" style="text-align:left;">
               <tr class="row">
                  <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d26334e89">Operating system</th>

                  <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d26334e92">Location</th>

               </tr>

            </thead>

            <tbody class="tbody">
               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e89 ">Linux</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e92 "><samp class="ph codeph">/opt/couchbase/bin/cbbackup</samp></td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e89 ">Windows</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e92 "><samp class="ph codeph">C:\Program&nbsp;Files\Couchbase\Server\bin\cbbackup</samp></td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e89 ">Mac OS X</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e92 "><samp class="ph codeph">/Applications/Couchbase&nbsp;Server.app/Contents/Resources/couchbase-core/bin/cbbackup</samp></td>

               </tr>

            </tbody>

         </table>
</div>

         
         
         <dl class="dl">
            
               <dt class="dt dlterm">Using the <span class="keyword cmdname">cbbackup</span> utility and restoring between Couchbase Server release 3.x and 2.x</dt>

               <dd class="dd">A backup generated with <span class="keyword cmdname">cbbackup</span> on a 3.x Couchbase cluster cannot be restored on a 2.x Couchbase cluster. 
                  Use either <span class="keyword cmdname">cbtransfer</span> between the two clusters, or use the legacy <span class="keyword cmdname">cbbackup</span> utility 
                  on the 2.x cluster to back up the data from the 3.x cluster into a format that <span class="keyword cmdname">cbrestore</span> from 2.x can utilize.</dd>

            
         </dl>

         
      </section>

      
      <section class="section"><h2 class="title sectiontitle">CLI commands and parameters</h2>

      <p class="p">The format of the <samp class="ph codeph">cbbackup</samp> command is:</p>

      <pre class="pre codeblock"><code>cbbackup [options] [source] [backup-dir]
</code></pre>

      <p class="p">Where:</p>

      <ul class="ul">
         <li class="li">[options]<p class="p">Same options available for <samp class="ph codeph">cbtransfer</samp> tool.</p>
</li>

         <li class="li">[source]<p class="p">Source for the backup. This can be either a URL of a node when backing up a single node or
         the cluster, or a URL specifying a directory where the data for a single bucket is
         located.</p>
</li>

         <li class="li">[backup-dir]<p class="p">The directory for the backup files to be stored. Either the directory must
         exist, and be empty, or the directory will be created. The parent directory must exist.</p>
</li>

      </ul>


      
      <p class="p">The following are the command options:</p>

      
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap">Table 1. cbbackup options</span></caption>
            <col style="width:50%">
            <col style="width:50%">
            <thead class="thead" style="text-align:left;">
               <tr class="row">
                  <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d26334e216">Parameters</th>

                  <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d26334e219">Description</th>

               </tr>

            </thead>

            <tbody class="tbody">
               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-h, --help</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">Command line help.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-b BUCKET_SOURCE, --bucket-source=BUCKET_SOURCE</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">Single named bucket from source cluster to transfer. If the backup
                        directory only contains a single bucket, then that bucket is automatically
                        used.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">--single-node</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">Use a single server node from the source only, not all server nodes from the entire cluster. 
                     This single server node is defined by the source URL.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-m MODE, --mode=MODE</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">&nbsp;</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-i ID, --id=ID</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">Transfer only items that match a vbucket ID.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-k KEY, --key=KEY</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">Transfer only items with keys that match a regexp.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-n, --dry-run</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">No actual transfer. Just validate parameters, files, connectivity and
                     configurations.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-u USERNAME, --username=USERNAME</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">REST username for source cluster or server node.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-p PASSWORD, --password=PASSWORD</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">REST password for cluster or server node.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-t THREADS, --threads=THREADS</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">Number of concurrent workers threads performing the transfer. </td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-v, --verbose</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">Verbose logging. More v's provide more verbosity. Max: -vvv.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e216 ">-x EXTRA, --extra=EXTRA</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e219 ">Provide extra, uncommon configuration parameters. Comma-separated key=val(key-val)* pairs.</td>

               </tr>

               
            </tbody>

         </table>
</div>

      <p class="p">The following are extra, specialized command options with the <samp class="ph codeph">cbbackup -x</samp>
            parameter.</p>

      
      
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap">Table 2. cbbackup -x options</span></caption>
            <col style="width:50%">
            <col style="width:50%">
            <thead class="thead" style="text-align:left;">
               <tr class="row">
                  <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d26334e359">-x options</th>

                  <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d26334e362">Description</th>

               </tr>

               
            </thead>

            <tbody class="tbody">
               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">backoff_cap=10</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">Maximum backoff time during the rebalance period.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">batch_max_bytes=400000</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">Transfer this # of bytes per batch.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">batch_max_size=1000</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">Transfer this # of documents per batch.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">cbb_max_mb=100000</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">Split backup file on destination cluster if it exceeds the MB.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">conflict_resolve=1</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">By default, disable conflict resolution.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">data_only=0</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">For value 1, transfer only data from a backup file or cluster.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">design_doc_only=0</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">For value 1, transfer only design documents from a backup file or cluster. Default: 0.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">max_retry=10</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">Max number of sequential retries if the transfer fails.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">mcd_compatible=1</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">For value 0, display extended fields for stdout output.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">nmv_retry=1</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">0 or 1, where 1 retries transfer after a NOT_MY_VBUCKET message. Default: 1.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">recv_min_bytes=4096</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">Amount of bytes for every TCP/IP batch transferred.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">rehash=0</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">For value 1, rehash the partition id's of each item. 
                     This is required when transferring data between clusters with
                     different number of partitions, such as when transferring data from an
                     Mac OS X server to a non-Mac OS X cluster.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">report=5</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">Number batches transferred before updating progress bar in console.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">report_full=2000</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">Number batches transferred before emitting progress information in console.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">seqno=0</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">By default, start seqno from beginning.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">try_xwm=1</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">Transfer documents with metadata. Default: 1. Value of 0 is only used when transferring
                     from 1.8.x to 1.8.x.</td>

               </tr>

               <tr class="row">
                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e359 ">uncompress=0</td>

                  <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d26334e362 ">For value 1, restore data in uncompressed mode.</td>

               </tr>

            </tbody>

         </table>
</div>

      </section>

      
      <section class="section"><h2 class="title sectiontitle">Syntax</h2>
         <p class="p">The following is the basic syntax:</p>

         <pre class="pre codeblock"><code>cbrestore [options] [backup-dir] [destination]</code></pre>

         
         
         <p class="p">The following syntax examples include a full backup and two incremental backups for a
            cluster.:</p>

         
         <pre class="pre codeblock"><code>
cbbackup http://HOST:8091 /backup-42
cbbackup http://HOST:8091 /backup-42
cbbackup http://HOST:8091 /backup-42
			</code></pre>

         
         <p class="p">The following syntax examples include a full backup, two differential backups, and one
            accumulative backup for a single node.</p>

         <pre class="pre codeblock"><code>
cbbackup couchbase://HOST:8091 /backup-43 [-m full] --single-node
cbbackup couchbase://HOST:8091 /backup-43 [-m diff] --single-node
cbbackup couchbase://HOST:8091 /backup-43 [-m diff] --single-node
cbbackup couchbase://HOST:8091 /backup-43 -m accu --single-node
         </code></pre>

            
         <div class="note note"><span class="notetitle">Note:</span> After backing up and restoring a cluster, be sure to rebuild your indexes. </div>


      </section>

      
      
      <section class="section"><h2 class="title sectiontitle">Example: Backing up clusters</h2>
      <p class="p">An entire cluster can be backed up. This includes all of the data buckets and data at all
            nodes and all design documents. To backup an entire cluster and all buckets for that
            cluster:</p>

      <pre class="pre codeblock"><code>cbbackup http://HOST:8091 ~/backups \
          -u Administrator -p password
</code></pre>

      <p class="p">Where <samp class="ph codeph">~/backups</samp> is the directory where you want to store the data. When
            this operation is performed, be aware that cbbackup creates the following directory
            structure and files in the <samp class="ph codeph">~/backups</samp> directory assuming there two
            buckets in the cluster named <samp class="ph codeph">my_name</samp> and <samp class="ph codeph">sasl</samp> and two
            nodes <samp class="ph codeph">N1</samp> and <samp class="ph codeph">N2</samp> :</p>

      <pre class="pre codeblock"><code>~/backups
        bucket-my_name
            N1
            N2
        bucket-sasl
            N1
            N2
</code></pre>

      <p class="p">Where <samp class="ph codeph">bucket-my_name</samp> and <samp class="ph codeph">bucket-sasl</samp> are directories
         containing data files and where <samp class="ph codeph">N1</samp> and <samp class="ph codeph">N2</samp> are two sets of
         data files for each node in the cluster. 
         </p>

         
         </section>

      
      <section class="section"><h2 class="title sectiontitle">Example: Backing up a single bucket</h2>
         <p class="p">To backup a single bucket in a cluster:</p>

      
      <pre class="pre codeblock"><code>cbbackup http://HOST:8091 /backups/backup-20120501 \
  -u Administrator -p password \
  -b default
</code></pre>

      <p class="p">In this case, the default bucket in the cluster is specified and the data from the default
            bucket is backed up. </p>

         
      </section>

      
      
      <section class="section"><h2 class="title sectiontitle">Example: Backing up multiple buckets</h2>
         <p class="p">To backup all data from multiple buckets on a single node:</p>

      <pre class="pre codeblock"><code>&gt; cbbackup http://HOST:8091 /backups/ \
  -u Administrator -p password \
  --single-node
</code></pre>

      <p class="p">To backup data from a single bucket on a single node:</p>

      <pre class="pre codeblock"><code>cbbackup http://HOST:8091 /backups \
  -u Administrator -p password \
  --single-node \
  -b bucket_name
</code></pre>

      </section>

      
      <section class="section"><h2 class="title sectiontitle">Example: Backing up keys</h2>
      <p class="p">To specify the keys that are backed up using the <samp class="ph codeph">- k</samp> option. For example,
            to backup all keys from a bucket with the prefix â€˜objectâ€™:</p>

      
      <pre class="pre codeblock"><code>&gt; cbbackup http://HOST:8091 /backups/backup-20120501 \
  -u Administrator -p password \
  -b bucket_name \
  -k '^object.*'
</code></pre>

      </section>


      
   </div>

   <nav class="related-links"><h2>Related information</h2>
<ol class="olchildlinks">
<li class="link olchildlink"><a href="../../admin/CLI/cbbackup-ddocs.html">Backing up design documents</a><br>
Design documents are backed up with the <samp class="ph codeph">design_doc_only=1</samp> option.</li>
<li class="link olchildlink"><a href="../../admin/CLI/cli-increment-backup.html">Backing up incrementally</a><br>
Incremental backups are run by using the <samp class="ph codeph">cbbackup</samp> 			command-line tool.</li>
</ol>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../admin/cli-intro.html" title="Couchbase Server command-line interface (CLI) tools are provided to manage and monitor clusters, servers, vBuckets, XDCR, and so on.">CLI reference</a></div>
<div class="previouslink"><strong>Previous topic:</strong> <a class="link" href="../../admin/CLI/cbanalyze-core_tool.html" title="The cbanalyze-core tool is used to parse and analyze core dump data.">cbanalyze-core tool</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../../admin/CLI/cbcollect_info_tool.html" title="The cbcollect_info tool provides detailed statistics for a specific node.">cbcollect_info tool</a></div>
</div>

<div class="linklist linklist">
<div><a class="link" href="../Install/hostnames.html" title="Each Couchbase Server's instance can have its own hostname.">Using hostnames</a></div>
<div><a class="link" href="cbcli-intro.html" title="The couchbase-cli tool is used to perform operations on an entire cluster.">couchbase-cli tool</a></div>
<div><a class="link" href="cbrestore_tool.html" title="The cbrestore tool restores data from a file to an entire cluster or to a single bucket in the cluster.">cbrestore tool</a></div>
<div><a class="link" href="cbtransfer_tool.html" title="The cbtransfer tool is used to transfer data between clusters and to/from files.">cbtransfer tool</a></div>
<div><a class="link" href="https://github.com/couchbase/couchbase-cli" target="_blank">Couchbase command-line tools GitHub repository</a></div></div>
</nav>
</div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">Â© 2011â€“2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../';</script><script src="../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>