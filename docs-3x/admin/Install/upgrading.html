<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Upgrading  â€” Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/install-intro.html"><span>Installation and upgrade</span></a><ul class="sub-sections"><li class="section"><a href="../../admin/Install/setup-overview.html"><span>Couchbase setup overview</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Install/pre-install.html"><span>Pre-installation</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Install/RHEL-install-intro.html"><span>Red Hat/CentOS/SUSE installation</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Install/Ubuntu-install.html"><span>Ubuntu/Debian installation</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Install/Windows-install.html"><span>Microsoft Windows installation</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Install/Mac-install.html"><span>Mac OS X installation</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Install/post-install.html"><span>Post-installation</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../admin/Install/upgrading.html" class="current"><span>Upgrading </span></a><ul class="sub-sections"><li class="section"><a href="../../admin/Install/supported_upgrade-paths.html"><span>Supported upgrade paths</span></a></li><li class="section"><a href="../../admin/Install/upgrade-online.html"><span>Online upgrade with swap rebalance</span></a></li><li class="section"><a href="../../admin/Install/upgrade-offline.html"><span>Offline upgrade</span></a></li><li class="section"><a href="../../admin/Install/upgrade-individual-nodes.html"><span>Upgrading one node</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../admin/Install/migrating.html"><span>Migrating</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../admin/admin-intro.html"><span>Administration</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/cli-intro.html"><span>CLI reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
  <h1 class="title topictitle1" id="ariaid-title1">Upgrading </h1>

  <div class="body"><p class="shortdesc">The Couchbase Server can be upgraded online (using swap rebalance or the standard online
    upgrade), offline, or using XDCR.</p>

    
    <div class="p"><div class="note remember"><span class="remembertitle">Remember:</span> Before performing an upgrade, whether it is online or offline, back up your data.</div>
</div>
 
    
    <p class="p">Install the latest version of the Couchbase Server. The installer will automatically detect
      the files from the earlier installation and convert them to the correct format, if needed.</p>

    
    
    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
        <col style="width:33.33333333333333%">
        <col style="width:33.33333333333333%">
        <col style="width:33.33333333333333%">
        <thead class="thead" style="text-align:left;">
          <tr class="row">
            <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d57999e35">Feature</th>

            <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d57999e38">Online upgrades</th>

            <th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d57999e41">Offline upgrades</th>

          </tr>

        </thead>

        <tbody class="tbody">
          <tr class="row">
            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e35 ">Applications remain available</td>

            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e38 ">Yes</td>

            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e41 ">No</td>

          </tr>

          <tr class="row">
            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e35 ">Cluster stays in operation</td>

            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e38 ">Yes</td>

            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e41 ">No</td>

          </tr>

          <tr class="row">
            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e35 ">Cluster must be shut down</td>

            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e38 ">No</td>

            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e41 ">Yes</td>

          </tr>

          <tr class="row">
            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e35 ">Time required</td>

            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e38 ">Requires rebalance, upgrade, rebalance per node</td>

            <td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d57999e41 ">All nodes in cluster upgraded at once</td>

          </tr>

        </tbody>

      </table>
</div>

    
    <div class="cautiontitle">CAUTION:</div><div class="note caution">Replication of certain per-node keys is broken after a node is first
      upgraded offline from 2.x to 3.0 and then added back to the formerly 2.x cluster that is now
      upgraded to 3.0. When performing an online upgrade from the Couchbase Server 2.x to 3.x,
      always fully delete the 2.x package (including the config files) before installing the 3.x
      package.</div>

    <section class="section"><h2 class="title sectiontitle">Online upgrades</h2></section>

    <p class="p">When you perform an online upgrade, there is no need to take 
      the cluster down and application keeps running during the upgrade process. You can upgrade the Couchbase 
      Server using a standard online upgrade, or an online upgrade
      with swap rebalance.</p>

   
    
    <dl class="dl">
      
        <dt class="dt dlterm">Online upgrade with swap rebalance</dt>

        <dd class="dd">For swap rebalance, first add a node to the cluster and then perform a swap rebalance to
          shift data from an old node to the new one. This is the preferred upgrade method when
          there is not enough cluster capacity to handle data once an old node is removed. It is
          also much faster from the standard online upgrade, because you only need to rebalance each
          upgraded node once. For this procedure see <a class="xref" href="upgrade-online.html" title="Online upgrade with swap rebalance is the preferred upgrade method because cluster capacity is always maintained throughout the upgrade.">Online upgrade
            with swap rebalance</a>.</dd>

      
    </dl>

    <dl class="dl">
      
        <dt class="dt dlterm">Standard online upgrade</dt>

        <dd class="dd">For standard online upgrade, take down one or two nodes from a cluster and rebalance so
          that remaining nodes handle incoming requests. You can use this upgrade option only if you
          have enough remaining cluster capacity to handle the nodes you want to remove and upgrade. </dd>

         <dd class="dd ddexpand">Standard online upgrades can take a while, because each node must be taken out of the
          cluster, upgraded to a current version, brought back into the cluster, and then
          rebalanced.</dd>

      
    </dl>

    <div class="p"> <div class="note important"><span class="importanttitle">Important:</span> Swap rebalance is recommended because it always maintains cluster
      capacity. Use the standard online upgrade only if upgrade with swap rebalance is not
      possible.</div>

      <div class="note important"><span class="importanttitle">Important:</span> The suggested procedure is to rebalance and remove a node, 
      proceed with a swap upgrade as if the removed node was an extra â€˜spareâ€™ node, and once 
      this is done add and rebalance the extra node back in.</div>
</div>

    
    <section class="section"><h2 class="title sectiontitle">Offline upgrades</h2>
  
    <p class="p">Offline upgrades can take less time than online upgrades
      because all nodes in the cluster can be upgraded at once.</p>

    <p class="p">An offline upgrade must be well-planned and scheduled. First, shut down your application so
        that no more incoming data arrives. Second, verify that the disk write queue is 0 and then
        shut down each node. This way you know that the Couchbase Server has stored all items onto
        disk during shutdown. After shutting down applications and nodes, perform the upgrade on
        each machine and then bring the cluster and applications back again.</p>

      <p class="p">To perform an offline upgrade, see <a class="xref" href="upgrade-offline.html" title="During an offline upgrade, the cluster must be shut down and all applications built on it will not be available during that time.">Offline upgrade</a>.</p>

    
    </section>

    
    <section class="section"><h2 class="title sectiontitle">Upgrading with XDCR</h2> This upgrade has to be taken cautiously and only in
      specific situations. Be sure that you are familiar with all requirements before deciding to
      use this process.  </section>

    
   
  
    
  </div>

  <nav class="related-links"><h2>Related information</h2>
<ol class="olchildlinks">
<li class="link olchildlink"><a href="../../admin/Install/supported_upgrade-paths.html">Supported upgrade paths</a><br>
The supplied supported paths apply both to online and offline upgrades.</li>
<li class="link olchildlink"><a href="../../admin/Install/upgrade-online.html">Online upgrade with swap rebalance</a><br>
Online upgrade with swap rebalance is the preferred upgrade method because cluster capacity is always maintained      throughout the upgrade.</li>
<li class="link olchildlink"><a href="../../admin/Install/upgrade-offline.html">Offline upgrade</a><br>
During an offline upgrade, the cluster must be shut down and all applications built on it will not be     available during that time.</li>
<li class="link olchildlink"><a href="../../admin/Install/upgrade-individual-nodes.html">Upgrading one node</a><br>
To upgrade a single Couchbase Server node, first back it up and then install the     software.</li>
</ol>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../admin/install-intro.html" title="This guide explains preinstallation, installation on various platforms, post-installation, upgrading, and migration procedures for Couchbase Server.">Installation and upgrade</a></div>
<div class="previouslink"><strong>Previous topic:</strong> <a class="link" href="../../admin/Install/post-install.html" title="Post-installation activities includes setting up the initial server and testing the server connections.">Post-installation</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../../admin/Install/migrating.html" title="This section explains how to migrate from Membase or CouchDB to Couchbase Server.">Migrating</a></div>
</div>

<div class="linklist linklist">
<div><a class="link" href="../CLI/cbbackup_tool.html" title="The cbbackup tool creates a copy of data from an entire running cluster, an entire bucket, a single node, or a single bucket on a single functioning node.">cbbackup tool</a></div>
<div><a class="link" href="../CLI/cbrestore_tool.html" title="The cbrestore tool restores data from a file to an entire cluster or to a single bucket in the cluster.">cbrestore tool</a></div></div>
</nav>
</div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">Â© 2011â€“2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../';</script><script src="../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>