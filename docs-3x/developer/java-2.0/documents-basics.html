<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Document basics — Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/install-intro.html"><span>Installation and upgrade</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/admin-intro.html"><span>Administration</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/cli-intro.html"><span>CLI reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../../developer/java-2.1/java-intro.html"><span>Java SDK 2.1</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/java-2.0/java-intro.html"><span>Java SDK 2.0</span></a><ul class="sub-sections"><li class="section"><a href="../../developer/java-2.0/overview.html"><span>Overview</span></a></li><li class="section"><a href="../../developer/java-2.0/download-links.html"><span>Download and API Reference</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/java-2.0/getting-started.html"><span>Getting started</span></a></li><li class="section"><a href="../../developer/java-2.0/managing-connections.html"><span>Managing connections</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/java-2.0/documents.html"><span>Working with documents</span></a><ul class="sub-sections"><li class="section"><a href="../../developer/java-2.0/documents-basics.html" class="current"><span>Document basics</span></a><ul class="sub-sections"></ul></li><li class="section"><a href="../../developer/java-2.0/documents-creating.html"><span>Creating documents</span></a></li><li class="section"><a href="../../developer/java-2.0/documents-updating.html"><span>Updating documents</span></a></li><li class="section"><a href="../../developer/java-2.0/documents-retrieving.html"><span>Retrieving documents</span></a></li><li class="section"><a href="../../developer/java-2.0/documents-deleting.html"><span>Deleting documents</span></a></li><li class="section"><a href="../../developer/java-2.0/documents-atomic.html"><span>Atomic operations</span></a></li><li class="section"><a href="../../developer/java-2.0/documents-bulk.html"><span>Bulk operations</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../developer/java-2.0/querying.html"><span>Querying buckets</span></a></li><li class="section"><a href="../../developer/java-2.0/observables.html"><span>Mastering observables</span></a></li><li class="section"><a href="../../developer/java-2.0/logging.html"><span>Setting up logging</span></a></li><li class="section"><a href="../../developer/java-2.0/release-notes.html"><span>Release notes</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../developer/dotnet-2.1/dotnet-intro.html"><span>.NET SDK 2.1</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dotnet-2.0/dotnet-intro.html"><span>.NET SDK 2.0</span></a></li></ul></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
	<h1 class="title topictitle1" id="ariaid-title1">Document basics</h1>

	
	<div class="body conbody"><p class="shortdesc">Describes the properties and types of <samp class="ph codeph">Document</samp> objects and how to use
		them.</p>


		<section class="section"><h2 class="title sectiontitle">The Document</h2>
			

			<p class="p">The <samp class="ph codeph">Document</samp> class encapsulates the consolidated representation of all
				attributes that relate to a document stored on a Couchbase Server cluster. It includes
				the document's identifier and related metadata. A <samp class="ph codeph">Document</samp> object
				contains the following properties:</p>


			
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
					<col style="width:50%"><col style="width:50%"><thead class="thead" style="text-align:left;">
						<tr class="row">
							<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d171184e42">Name</th>

							<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d171184e45">Description</th>

						</tr>

					</thead>

					<tbody class="tbody">
						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e42 ">
								<samp class="ph codeph">id</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e45 ">The (per bucket) unique identifier of the document.</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e42 ">
								<samp class="ph codeph">content</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e45 ">The actual content of the document.</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e42 ">
								<samp class="ph codeph">cas</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e45 ">The CAS (Compare And Swap) value of the document.</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e42 ">
								<samp class="ph codeph">expiry</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e45 ">The expiration time of the document.</td>

						</tr>

					</tbody>

				</table>
</div>


			<p class="p">There are a few different implementations of a <samp class="ph codeph">Document</samp>, the most
				prominent one is the <samp class="ph codeph">JsonDocument</samp>.</p>


			<p class="p">Because Couchbase Server is able to not only store JSON but in fact anything, many
				document types exist to satisfy the general needs of an application. You can also write
				your own <samp class="ph codeph">Document</samp> implementations, but this is not covered in this
				introduction.</p>


			<div class="p">
				<div class="note note"><span class="notetitle">Note:</span> Every <samp class="ph codeph">Document</samp> has an associated <samp class="ph codeph">Transcoder</samp> that
					handles serialization and deserialization to and from the target wire format. This
					conversion is transparent, but needs to be taken into account when custom documents
					are implemented.</div>

			</div>


			<p class="p">The following <samp class="ph codeph">Document</samp> types are supported out of the box:</p>


			<p class="p">
				<strong class="ph b">Documents with JSON content:</strong>
			</p>


			
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
					<col style="width:25%"><col style="width:25%"><col style="width:25%"><col style="width:25%"><thead class="thead" style="text-align:left;">
						<tr class="row">
							<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d171184e155">Document Name</th>

							<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d171184e158">Description</th>

							<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d171184e161">Compatible: 2.x SDKs</th>

							<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d171184e164">Compatible: 1.x Java SDK</th>

						</tr>

					</thead>

					<tbody class="tbody">
						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e155 ">
								<samp class="ph codeph">JsonDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e158 ">The default, which has a <samp class="ph codeph">JsonObject</samp> at the top level
								content.</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e161 ">Yes</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e164 ">Yes</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e155 ">
								<samp class="ph codeph">JsonArrayDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e158 ">Similar to <samp class="ph codeph">JsonDocument</samp>, but has a
									<samp class="ph codeph">JsonArray</samp> at the top level content.</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e161 ">Yes</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e164 ">Yes</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e155 ">
								<samp class="ph codeph">JsonBooleanDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e158 ">Stores JSON-compatible Boolean values.</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e161 ">Yes</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e164 ">Partially</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e155 ">
								<samp class="ph codeph">JsonLongDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e158 ">Stores JSON compatible long (number) values.</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e161 ">Yes</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e164 ">Partially</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e155 ">
								<samp class="ph codeph">JsonDoubleDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e158 ">Stores JSON compatible double (number) values.</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e161 ">Yes</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e164 ">Partially</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e155 ">
								<samp class="ph codeph">JsonStringDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e158 ">Stores JSON compatible String values. Input is automatically wrapped
								with <samp class="ph codeph">"..."</samp>.</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e161 ">Yes</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e164 ">Partially</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e155 ">
								<samp class="ph codeph">RawJsonDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e158 ">Stores any JSON value and should be used if custom JSON serializers such
								as Jackson or GSON are already in use.</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e161 ">Yes</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e164 ">Yes</td>

						</tr>

					</tbody>

				</table>
</div>


			<p class="p">
				<strong class="ph b">Documents with other content:</strong>
			</p>


			
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all">
					<col style="width:25%"><col style="width:25%"><col style="width:25%"><col style="width:25%"><thead class="thead" style="text-align:left;">
						<tr class="row">
							<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d171184e331">Document Name</th>

							<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d171184e334">Description</th>

							<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d171184e337">Compatible: 2.x SDKs</th>

							<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d171184e340">Compatible: 1.x Java SDK</th>

						</tr>

					</thead>

					<tbody class="tbody">
						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e331 ">
								<samp class="ph codeph">BinaryDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e334 ">Can be used to store arbitrary binary data.</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e337 ">Yes</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e340 ">Yes</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e331 ">
								<samp class="ph codeph">SerializableDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e334 ">Stores objects that implement <samp class="ph codeph">Serializable</samp> through
								default Java object serialization.</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e337 ">No</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e340 ">Yes</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e331 ">
								<samp class="ph codeph">LegacyDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e334 ">Uses the <samp class="ph codeph">Transcoder</samp> from the 1.x SDKs and can be used
								for full cross-compatibility between the old and new versions.</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e337 ">No</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e340 ">Yes</td>

						</tr>

						<tr class="row">
							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e331 ">
								<samp class="ph codeph">StringDocument</samp>
							</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e334 ">Can be used to store arbitrary strings. They will not be quoted, but
								stored as-is and flagged as "String".</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e337 ">Yes</td>

							<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d171184e340 ">Yes</td>

						</tr>

					</tbody>

				</table>
</div>


			<div class="p">
				<div class="note note"><span class="notetitle">Backward compatibility:</span> Other than the
						<samp class="ph codeph">LegacyDocument</samp> class, which strives for full backward
					compatibility, all <samp class="ph codeph">Document</samp> types are trying best effort in that
					regard. Specific constraints are noted in each document description, but for all
					types keep in mind that compression is not supported other than on the
						<samp class="ph codeph">LegacyDocument</samp>.</div>

			</div>


		</section>


		<section class="section"><h2 class="title sectiontitle">CAS and Expiry</h2>
			

			<p class="p">Every <samp class="ph codeph">Document</samp> also contains the <samp class="ph codeph">expiry</samp> and
					<samp class="ph codeph">cas</samp> properties. They are considered meta information and are
				optional. An expiration time of <samp class="ph codeph">0</samp> means that no expiration is set at
				all, and a <samp class="ph codeph">CAS</samp> value 0 means it won't be used.</p>


			<p class="p">You can set the <samp class="ph codeph">expiry</samp> to control when the document should be
				deleted:</p>


			<pre class="pre codeblock language-java"><code>// Expire in 10 seconds.
JsonDocument.create("id", 10, content);</code></pre>


			<pre class="pre codeblock language-java"><code>// Expire in 1 day.
JsonDocument.create("id", TimeUnit.DAYS.toSeconds(1), content);</code></pre>


			<p class="p">The expiration time starts when the document has been successfully stored on the server,
				not when the document was created on the application server. Any expiration time larger
				than 30 days in seconds is considered absolute (as in a Unix time stamp), anything
				smaller is considered relative in seconds.</p>


			<p class="p">The <samp class="ph codeph">CAS</samp> value can either be set by you directly or is populated by the
				SDK when the <samp class="ph codeph">Document</samp> is loaded from the server (which is the
				recommended way to use it).</p>


			<p class="p">For detailed information about how to utilize CAS for optimistic concurrency control,
				see <a class="xref" href="documents-updating.html#concept2677" title="Describes updating documents by using the replace() or upsert() methods.">Updating documents</a>.</p>

		</section>


		<section class="section"><h2 class="title sectiontitle">JsonDocument</h2>
			

			<p class="p">Couchbase Server uses the JSON format as a first-class citizen. It is used for querying
				(via both views and N1QL) and represents the main storage format that should be
				used.</p>


			<p class="p">The <samp class="ph codeph">JsonDocument</samp> class has factory methods named
					<samp class="ph codeph">create()</samp> that you use to create documents. If you do not want to
				pass in an expiration time or CAS value (just the ID and content) you do it like
				this:</p>


			<pre class="pre codeblock language-java"><code>JsonDocument doc = JsonDocument.create("id", content);</code></pre>


			<p class="p">The content needs to be of type <samp class="ph codeph">JsonObject</samp>, which ships with the Java
				SDK. It works very much like a <samp class="ph codeph">Map</samp> object, but makes sure only data
				types understood by JSON are used.</p>


			<p class="p">An empty JSON document can be created like this:</p>


			<pre class="pre codeblock language-java"><code>JsonObject content = JsonObject.empty();</code></pre>


			<p class="p">After it is created, you can use the various <samp class="ph codeph">put()</samp> methods to insert
				data:</p>


			<pre class="pre codeblock language-java"><code>JsonArray friends = JsonArray.empty()
    .add(JsonObject.empty().put("name", "Mike Ehrmantraut"))
    .add(JsonObject.empty().put("name", "Jesse Pinkman"));

JsonObject content = JsonObject.empty()
    .put("firstname", "Walter")
    .put("lastname", "White")
    .put("age", 52)
    .put("aliases", JsonArray.from("Walt Jackson", "Mr. Mayhew", "David Lynn"))
    .put("friends", friends);</code></pre>


			<p class="p">This generates a JSON document like this (unordered, because the actual content is
				stored in a <samp class="ph codeph">Map</samp>):</p>


			<pre class="pre codeblock language-json"><code>{
   "firstname":"Walter",
   "aliases":[
      "Walt Jackson",
      "Mr. Mayhew",
      "David Lynn"
   ],
   "age":52,
   "friends":[
      {
         "name":"Mike Ehrmantraut"
      },
      {
         "name":"Jesse Pinkman"
      }
   ],
   "lastname":"White"
}</code></pre>


			<p class="p">
				<img class="image" id="concept2677__image_i31_yqb_1" src="images/document-jsonobject.png">
			</p>


			<p class="p">In addition, the <samp class="ph codeph">JsonObject</samp> and <samp class="ph codeph">JsonArray</samp> classes
				provide convenience methods to generate and modify them.</p>


			<p class="p">The <samp class="ph codeph">JsonDocument</samp> can then be passed into the various operations on the
					<samp class="ph codeph">Bucket</samp>:</p>


			<pre class="pre codeblock language-java"><code>JsonDocument walter = JsonDocument.create("user:walter", content);
JsonDocument inserted = bucket.insert(walter);</code></pre>


			<p class="p">If you want to read values out of the <samp class="ph codeph">JsonDocument</samp>, you can use either
				the typed or untyped getter methods.</p>


			<pre class="pre codeblock language-java"><code>int age = content.getInt("age");
String name = content.getString("firstname") + content.getString("lastname");</code></pre>


			<div class="p">
				<div class="note note"><span class="notetitle">Note:</span> If you are accessing values that potentially do not exist, you need to use boxed
					values (<samp class="ph codeph">Integer</samp>, <samp class="ph codeph">Long</samp>, <samp class="ph codeph">Boolean</samp>)
					instead of their unboxed variants (<samp class="ph codeph">int</samp>, <samp class="ph codeph">long</samp>,
						<samp class="ph codeph">boolean</samp>) to avoid getting <samp class="ph codeph">NullPointerException</samp>
					exceptions. If you use unboxed variants, make sure to catch them properly.</div>

			</div>


		</section>


		<section class="section"><h2 class="title sectiontitle">JsonArrayDocument</h2>
			

			<p class="p">The <samp class="ph codeph">JsonArrayDocument</samp> class works exactly like the
					<samp class="ph codeph">JsonDocument</samp> class, with the main difference that you can have a
				JSON array at the top level content (instead of an object).</p>


			<p class="p">So if you create a <samp class="ph codeph">JsonArrayDocument</samp> like this:</p>


			<pre class="pre codeblock language-java"><code>JsonArray content = JsonArray.from("Hello", "World", 1234);
bucket.upsert(JsonArrayDocument.create("docWithArray", content));</code></pre>


			<p class="p">It will look like this on the server:</p>


			<p class="p">
				<img class="image" id="concept2677__image_json-array" src="images/document-jsonarray.png">
			</p>


			<p class="p">If you want to read the <samp class="ph codeph">JsonArrayDocument</samp> back, you need to tell the
				SDK you explicitly want to deviate from the default. This needs to be done for
				every document type other than <samp class="ph codeph">JsonDocument</samp>:</p>


			<pre class="pre codeblock language-java"><code>bucket.get("docWithArray", JsonArrayDocument.class);</code></pre>


		</section>


		<section class="section"><h2 class="title sectiontitle">RawJsonDocument</h2>
			

			<p class="p">The <samp class="ph codeph">JsonObject</samp> and <samp class="ph codeph">JsonArray</samp> types have been added for
				developer convenience. In a lot of places though, custom JSON handling is already in
				place through libraries like Jackson or Google GSON.</p>


			<p class="p">Of course we want to provide the best of both worlds, and this is where the
					<samp class="ph codeph">RawJsonDocument</samp> comes into play. You can store and read the already
				stringified JSON, but the SDK properly marks it as JSON so it is cross-compatible with
				all other documents.</p>


			<p class="p">Here is how you can read and write raw JSON data. For clarity, a plain string is used
				but it is up to you to wire this up with Jackson or a similar JSON processor:</p>


			<pre class="pre codeblock language-java"><code>// write the raw data
String content = "{\"hello\": \"couchbase\", \"active\": true}";
bucket.upsert(RawJsonDocument.create("rawJsonDoc", content));

// read the raw data
// prints RawJsonDocument{id='rawJsonDoc', cas=..., expiry=0, content={"hello": "couchbase", "active": true}}
System.out.println(bucket.get("rawJsonDoc", RawJsonDocument.class));

// read it parsed
// prints true
System.out.println(bucket.get("rawJsonDoc").content().getBoolean("active"));</code></pre>


			<p class="p">
				<img class="image" id="concept2677__image_i31_yqb_3p" src="images/document-rawjson.png">
			</p>


			<div class="p">
				<div class="note note"><span class="notetitle">Note:</span> If you use the <samp class="ph codeph">RawJsonDocument</samp> type, the SDK does not perform any
					validation because the expectation is that a JSON-compatible library is used and
					additional overhead will be avoided.</div>

			</div>

		</section>


		<section class="section"><h2 class="title sectiontitle">JSON value documents</h2>
			

			<p class="p">The JSON specification also allows you to store different values as content and it also
				specifies how these values need to be encoded. Because the type system of Java is not as
				rich as it could be, different document types are provided to represent different values
				that can be stored. Because the encoding is clearly defined, these JSON values are also
				compatible with other 2.0 SDKs.</p>


			<p class="p">A word on compatibility with the 1.X Java SDK: in a best-effort way the SDK tries to
				read properly flagged data from the old SDKs, but it stores it under the new format,
				which is not readable by the old SDKs anymore. So if you care about back-and-forth
				compatibility only read those values from the new SDK or use the
					<samp class="ph codeph">LegacyDocument</samp> right away. Another option is to use strings only on
				the old SDK, then working with it back and forth should be safe.</p>


			<p class="p">Backward compatibility for JSON value documents works only if the actual content is not
				compressed.</p>


			<p class="p">The following documents exist, which all work similarly except the content type that can
				be stored:</p>


			<ul class="ul">
				<li class="li">
					<samp class="ph codeph">JsonBooleanDocument</samp>
				</li>

				<li class="li">
					<samp class="ph codeph">JsonLongDocument</samp>
				</li>

				<li class="li">
					<samp class="ph codeph">JsonDoubleDocument</samp>
				</li>

				<li class="li">
					<samp class="ph codeph">JsonStringDocument</samp>
				</li>

			</ul>


			<p class="p">They are all encoded and decoded based on their <a class="xref" href="http://json.org" target="_blank">JSON specification</a>.</p>

		</section>


		<section class="section"><h2 class="title sectiontitle">BinaryDocument</h2>
			
			<p class="p">The <samp class="ph codeph">BinaryDocument</samp> can be used to store and read arbitrary bytes. It is
				the only default codec that directly exposes the underlying low-level Netty
					<samp class="ph codeph">ByteBuf</samp> objects.</p>

			<div class="p">
				<div class="note important"><span class="importanttitle">Important:</span> Because the raw data is exposed, it is important to free it after
					it has been properly used. Not freeing it will result in increased garbage collection
					and should be avoided by all means.</div>

			</div>

			<p class="p">Because binary data is arbitrary anyway, it is backward compatible with the old SDK in
				terms of flags, so it can be read and written back and forth. Make sure it is not
				compressed in the old SDK and that the same encoding and decoding process is used on the
				application side to avoid data corruption.</p>

			<p class="p">Here is some demo code that shows how to write and read raw data. The example writes
				binary data, reads it back, and then frees the pooled resources:</p>

			<pre class="pre codeblock language-java"><code>// Create buffer out of a string
ByteBuf toWrite = Unpooled.copiedBuffer("Hello World", CharsetUtil.UTF_8);

// Write it
bucket.upsert(BinaryDocument.create("binaryDoc", toWrite));

// Read it back
BinaryDocument read = bucket.get("binaryDoc", BinaryDocument.class);

// Print it
System.out.println(read.content().toString(CharsetUtil.UTF_8));

// Free the resources
ReferenceCountUtil.release(read.content());</code></pre>

		</section>


		<section class="section"><h2 class="title sectiontitle">SerializableDocument</h2>
			

			<p class="p">Any object that implements <samp class="ph codeph">Serializable</samp> can be safely encoded and
				decoded using the built-in Java serialization mechanism. While it is very convenient, it
				can be slow in cases where the POJOs are very complex and deeply nested. It is backward
				compatible with the old SDK unless the data has been compressed previously.</p>


			<p class="p">Here is an example that serializes a POJO, deserializes it later, and then prints one of
				its properties:</p>


			<pre class="pre codeblock language-java"><code>import java.io.Serializable;

public class User implements Serializable {

    private final String username;

    public User(String username) {
        this.username = username;
    }

    public String getUsername() {
        return username;
    }

}</code></pre>


			<pre class="pre codeblock language-java"><code>// Create the User and store it
bucket.upsert(SerializableDocument.create("user::michael",  new User("Michael")));

// Read it back
SerializableDocument found = bucket.get("user::michael", SerializableDocument.class);

// Print a property to verify
System.out.println(((User) found.content()).getUsername());</code></pre>


		</section>


		<section class="section"><h2 class="title sectiontitle">LegacyDocument</h2>
			

			<p class="p">The <samp class="ph codeph">LegacyDocument</samp> is intended to be 1:1 compatible (including
				compression) with the 1.x Java SDK. For better compatibility with the other 2.0 SDKs we
				recommend to move to JSON type documents (and other compatible ones), but the
					<samp class="ph codeph">LegacyDocument</samp> is very helpful during data migration and
				side-by-side usage.</p>


			<p class="p">Because the old and new SDKs don't share artifacts or namespaces, they can be used at
				the same time. If you're using Maven, you can add both a 1.x SDK and a 2.x SDK as
				dependencies in the <span class="ph filepath">pom.xml</span> file. For example:</p>


			<pre class="pre codeblock language-xml"><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.couchbase.client&lt;/groupId&gt;
        &lt;artifactId&gt;java-client&lt;/artifactId&gt;
        &lt;version&gt;2.0.3&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.couchbase.client&lt;/groupId&gt;
        &lt;artifactId&gt;couchbase-client&lt;/artifactId&gt;
        &lt;version&gt;1.4.5&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>


			<p class="p">Here is a snippet that writes a value using the old SDK and reads it out with the new
				one:</p>


			<pre class="pre codeblock language-java"><code>// Open bucket on the new SDK
Cluster cluster = CouchbaseCluster.create();
Bucket bucket = cluster.openBucket();

// Open bucket on the old SDK
CouchbaseClient client = new CouchbaseClient(
    Arrays.asList(URI.create("http://127.0.0.1:8091/pools")),
    "default",
    ""
);

// Create document on old SDK
client.set("fromOld", "Hello from Old!").get();

// Create document on new SDK
bucket.upsert(LegacyDocument.create("fromNew", "Hello from New!"));

// Read old from new
System.out.println(bucket.get("fromOld", LegacyDocument.class));

// Read new from old
System.out.println(client.get("fromNew"));

// Shutdown old client
client.shutdown();

// Shutdown new client
cluster.disconnect();</code></pre>


			<p class="p">This prints:</p>


			<pre class="pre codeblock"><code>LegacyDocument{id='fromOld', cas=1097880624822, expiry=0, content=Hello from Old!}
Hello from New!</code></pre>


		</section>


		<section class="section"><h2 class="title sectiontitle">StringDocument</h2>
			

			<p class="p">This document type provides an SDK 2.0 cross-compatible way to exchange strings. It
				should not be mistaken with the <samp class="ph codeph">JsonStringDocument</samp> which automatically
				quotes it and also flags it as JSON. It is also backward compatible unless compression
				was used previously.</p>


			<p class="p">If a <samp class="ph codeph">String</samp> is stored through it, it is explicitly flagged as a
				non-JSON string. The usage is straightforward:</p>


			<pre class="pre codeblock language-java"><code>// Create the document
bucket.upsert(StringDocument.create("stringDoc", "Hello World"));

// Prints:
// StringDocument{id='stringDoc', cas=1424054670330, expiry=0, content=Hello World}
System.out.println(bucket.get("stringDoc", StringDocument.class));</code></pre>


			<p class="p">You can use the <samp class="ph codeph">cbc</samp> command line tool to compare the flags and actual
				content compared to the <samp class="ph codeph">JsonStringDocument</samp>:</p>


			<pre class="pre codeblock language-java"><code>bucket.upsert(StringDocument.create("stringDoc", "Hello World"));</code></pre>


			<pre class="pre codeblock language-bash"><code>└──╼ cbc cat stringDoc
stringDoc            CAS=0x55668b55f010000, Flags=0x4000000. Size=11
Hello World</code></pre>


			<pre class="pre codeblock language-java"><code>bucket.upsert(JsonStringDocument.create("jsonStringDoc", "Hello World"));</code></pre>


			<pre class="pre codeblock language-bash"><code>└──╼ cbc cat jsonStringDoc
jsonStringDoc        CAS=0x84d77eb55f010000, Flags=0x2000000. Size=13
"Hello World"</code></pre>


			<p class="p">You can see that the JSON string got automatically quoted and also has different flags
				applied to it.</p>


		</section>


	</div>

<nav class="related-links"><h2>Related information</h2>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../developer/java-2.0/documents.html">Working with documents</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../../developer/java-2.0/documents-creating.html" title="Describes creating documents by using the insert() or upsert() methods.">Creating documents</a></div>
</div>
</nav></div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../';</script><script src="../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>