<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Java SDK 2.1 — Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/install-intro.html"><span>Installation and upgrade</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/admin-intro.html"><span>Administration</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/cli-intro.html"><span>CLI reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a><ul class="sub-sections"><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/java-2.1/java-intro.html" class="current"><span>Java SDK 2.1</span></a><ul class="sub-sections"><li class="section"><a href="../../developer/java-2.1/overview.html"><span>Overview</span></a></li><li class="section"><a href="../../developer/java-2.1/download-links.html"><span>Download and API Reference</span></a></li><li class="section"><a href="../../developer/java-2.1/migrate.html"><span>Migrating from Java SDK 1.4.x to 2.x</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/java-2.1/getting-started.html"><span>Getting started with the Java SDK</span></a></li><li class="section"><a href="../../developer/java-2.1/managing-connections.html"><span>Managing connections</span></a></li><li class="section"><a href="../../developer/java-2.1/env-config.html"><span>Configuring the environment</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/java-2.1/documents.html"><span>Working with documents</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/java-2.1/querying.html"><span>Querying buckets</span></a></li><li class="section"><a href="../../developer/java-2.1/observables.html"><span>Mastering observables</span></a></li><li class="section"><a href="../../developer/java-2.1/logging.html"><span>Setting up logging</span></a></li><li class="section"><a href="../../developer/java-2.1/release-notes.html"><span>Release notes</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../developer/java-2.0/java-intro.html"><span>Java SDK 2.0</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dotnet-2.1/dotnet-intro.html"><span>.NET SDK 2.1</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dotnet-2.0/dotnet-intro.html"><span>.NET SDK 2.0</span></a></li></ul></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
	<h1 class="title topictitle1" id="ariaid-title1">Java SDK 2.1</h1>

	
	<div class="body conbody"><p class="shortdesc">The Couchbase Java SDK provides synchronous and asynchronous (reactive) interfaces that
		allow your applications to efficiently interact with a Couchbase Server cluster. It provides
		capabilities to store, update, and retrieve documents in the database and query the database
		by using N1QL.</p>


		<p class="p">In general, every synchronous method has a corresponding asynchronous method. The SDK also
			has first-class support for Java 8.</p>


		<p class="p">Here are some samples of typical operations you can accomplish with the SDK:</p>


		<section class="section"><h2 class="title sectiontitle">Connecting</h2>
			

			<p class="p">You can connect to one or more buckets on your cluster in a very concise way, while at
				the same time making sure that the underlying resources like thread pools and sockets
				are reused as much as possible:</p>


			<pre class="pre codeblock language-java"><code>// Connect to localhost
Cluster cluster = CouchbaseCluster.create();

// Open the default bucket and the "beer-sample" one
Bucket defaultBucket = cluster.openBucket();
Bucket beerSampleBucket = cluster.openBucket("beer-sample");

// Disconnect and clear all allocated resources
cluster.disconnect();</code></pre>


		</section>


		<section class="section"><h2 class="title sectiontitle">Storing Documents</h2>
			

			<p class="p">JSON is a first-class citizen, but the SDK also provides support for any other type of
				objects (such as serialized Java objects or raw byte streams). This example shows how
				you can create a JSON document and insert it synchronously:</p>


			<pre class="pre codeblock language-java"><code>JsonObject user = JsonObject.empty()
  .put("firstname", "Walter")
  .put("lastname", "White")
  .put("job", "chemistry teacher")
  .put("age", 50);
JsonDocument stored = bucket.upsert(JsonDocument.create("walter", user));</code></pre>


		</section>


		<section class="section"><h2 class="title sectiontitle">Retrieving Documents</h2>
			

			<p class="p">You can also retrieve your stored documents in a variety of ways. This first example
				synchronously loads a document identified by its ID and prints out a field of the JSON.
				Notice how the JSON decoding is done for you:</p>


			<pre class="pre codeblock language-java"><code>JsonDocument walter = bucket.get("walter");
System.out.println("Found: " + walter.getString("firstname"));</code></pre>


			<p class="p">That doesn't impress you? Asynchronous, reactive APIs are also exposed. The following
				example uses Java 8 to showcase a more advanced query:</p>


			<pre class="pre codeblock language-java"><code>bucket
  .async()
  .get("beer")
  .onErrorResumeNext(bucket.async().getFromReplica("beer", ReplicaMode.ALL))
  .first()
  .map(doc -&gt; doc.content().getString("name"))
  .timeout(2, TimeUnit.SECONDS)
  .doOnError(System.err::println)
  .onErrorReturn(error -&gt; "Not Found!");</code></pre>


			<p class="p">This code snippet loads a document, falls back to load from replica nodes if an error
				happens, grabs the first of potentially many replica responses, and then extracts the
				beer name. Finally, a timeout is applied and more error handling (printing out the
				errors) is added as well. This gives you a glimpse of what's possible with our
				asynchronous, reactive methods that are always available. In fact, the synchronous calls
				are just convenience wrappers.</p>


		</section>


		<section class="section"><h2 class="title sectiontitle">Querying</h2>
			

			<p class="p">Couchbase Server has extensive support for querying (be it through views or the N1QL query
				language). The SDK provides various ways to query them. Here is how to query a view that
				gives us beers and breweries, filters out the beers, and prints their name:</p>


			<pre class="pre codeblock language-java"><code>ViewResult result = bucket.query(ViewQuery.from("beers_and_breweries", "by_name"));

for (ViewRow row : result) {
    JsonDocument doc = row.document();

    if (doc.content().getString("type").equals("beer")) {
        System.out.println(doc.content().getString("name"));
    }
}</code></pre>


			<p class="p">This can also be done asynchronously:</p>


			<pre class="pre codeblock language-java"><code>bucket
    .async()
    .query(ViewQuery.from("beers_and_breweries", "by_name"))
    .flatMap(AsyncViewResult::rows)
    .flatMap(AsyncViewRow::document)
    .filter(doc -&gt; doc.content().getString("type").equals("beer"))
    .subscribe(doc -&gt; System.out.println(doc.content().getString("name")));</code></pre>


			<p class="p">Here is how to run a N1QL query—notice how nicely the domain-specific language (DSL)
				leads you to your final query:</p>


			<pre class="pre codeblock language-java"><code>bucket
    .async()
    .query(Query.simple(select("*").from("beer-sample").limit(10)))
    .flatMap(AsyncQueryResult::rows)
    .toBlocking()
    .forEach(row -&gt; System.out.println(row.value()));</code></pre>


			<p class="p">The query selects all documents from the <samp class="ph codeph">beer-sample</samp> bucket and prints
				the content of each row. Of course, synchronous execution is also available.</p>


		</section>


	</div>

<nav class="related-links"><h2>Related information</h2>
<ol class="olchildlinks">
<li class="link olchildlink"><a href="../../developer/java-2.1/overview.html">Overview</a><br>
The Couchbase Java SDK enables you to interact with a Couchbase Server cluster from a 		Java or Java virtual machine (JVM) application.</li>
<li class="link olchildlink"><a href="../../developer/java-2.1/download-links.html">Download and API Reference</a><br>
The Java SDK is available on Maven Central or by downloading it as an archive. A Javadoc 		API reference is also available online.</li>
<li class="link olchildlink"><a href="../../developer/java-2.1/migrate.html">Migrating from Java SDK 1.4.x to 2.x</a><br>
Couchbase recommends that you migrate to the Java 2.x SDK to take advantage of 		enhancements to the SDK as well as new features available in Couchbase Server. The 2.x Java 		SDK is based on the reactive programming model and has a completely different architecture 		that uses a core I/O layer and a Java client layer. It's asynchronous by design and offers 		performance, scalability, and durability enhancements.  </li>
<li class="link olchildlink"><a href="../../developer/java-2.1/getting-started.html">Getting started with the Java SDK</a><br>
This guide provides a foundational introduction to the Couchbase Java SDK. It shows you 		how to install the SDK and write a basic sample application that highlights important 		aspects. After you install the SDK, you can start exploring it on your own or proceed with a 		tutorial to build a complete, production-grade application.</li>
<li class="link olchildlink"><a href="../../developer/java-2.1/managing-connections.html">Managing connections</a><br>
This section covers the different approaches to connecting and disconnecting, as well as 		how to configure encryption.</li>
<li class="link olchildlink"><a href="../../developer/java-2.1/env-config.html">Configuring the environment</a><br>
The <samp class="ph codeph">CouchbaseEnvironment</samp> class enables you to configure Java SDK 		options for bootstrapping, timeouts, reliability, and performance.</li>
<li class="link olchildlink"><a href="../../developer/java-2.1/documents.html">Working with documents</a><br>
The Java SDK offers methods you can use to accomplish the basic CRUD operations of creating, retrieving, updating, and deleting documents.</li>
<li class="link olchildlink"><a href="../../developer/java-2.1/querying.html">Querying buckets</a><br>
The Java SDK supports a wide range of querying features, including views and the N1QL query language.</li>
<li class="link olchildlink"><a href="../../developer/java-2.1/observables.html">Mastering observables</a><br>
This guide helps you getting up to speed with asynchronous programming and 		<samp class="ph codeph">Observable</samp> objects in particular. This guide is not tied to the Java 		SDK exclusively and aims to give you a general understanding of how to build full-stack, 		asynchronous applications.</li>
<li class="link olchildlink"><a href="../../developer/java-2.1/logging.html">Setting up logging</a><br>
The Couchbase Java SDK has no hard dependency on a specific logger implementation. It 		tries to find a logger on the class path and uses that logger if it is supported by the SDK. 		If no logger implementation is found, the standard JDK logger is used.</li>
<li class="link olchildlink"><a href="../../developer/java-2.1/release-notes.html">Release notes</a><br>
Release notes for the 2.1 version of the Java SDK.</li>
</ol>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../developer/dev-guide-3.0/old-versions.html" title="In addition to providing documentation for our current SDK releases, complete documentation for older versions of the SDKs is still available.">Older SDK versions</a></div>
</div>
</nav></div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../';</script><script src="../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>