<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Deleting documents — Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/install-intro.html"><span>Installation and upgrade</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/admin-intro.html"><span>Administration</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/cli-intro.html"><span>CLI reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a><ul class="sub-sections"><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/java-2.1/java-intro.html"><span>Java SDK 2.1</span></a><ul class="sub-sections"><li class="section"><a href="../../developer/java-2.1/overview.html"><span>Overview</span></a></li><li class="section"><a href="../../developer/java-2.1/download-links.html"><span>Download and API Reference</span></a></li><li class="section"><a href="../../developer/java-2.1/migrate.html"><span>Migrating from Java SDK 1.4.x to 2.x</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/java-2.1/getting-started.html"><span>Getting started with the Java SDK</span></a></li><li class="section"><a href="../../developer/java-2.1/managing-connections.html"><span>Managing connections</span></a></li><li class="section"><a href="../../developer/java-2.1/env-config.html"><span>Configuring the environment</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/java-2.1/documents.html"><span>Working with documents</span></a><ul class="sub-sections"><li class="section"><a href="../../developer/java-2.1/documents-basics.html"><span>Document basics</span></a></li><li class="section"><a href="../../developer/java-2.1/documents-creating.html"><span>Creating documents</span></a></li><li class="section"><a href="../../developer/java-2.1/documents-updating.html"><span>Updating documents</span></a></li><li class="section"><a href="../../developer/java-2.1/documents-retrieving.html"><span>Retrieving documents</span></a></li><li class="section"><a href="../../developer/java-2.1/documents-deleting.html" class="current"><span>Deleting documents</span></a><ul class="sub-sections"></ul></li><li class="section"><a href="../../developer/java-2.1/documents-atomic.html"><span>Atomic operations</span></a></li><li class="section"><a href="../../developer/java-2.1/documents-bulk.html"><span>Bulk operations</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../developer/java-2.1/querying.html"><span>Querying buckets</span></a></li><li class="section"><a href="../../developer/java-2.1/observables.html"><span>Mastering observables</span></a></li><li class="section"><a href="../../developer/java-2.1/logging.html"><span>Setting up logging</span></a></li><li class="section"><a href="../../developer/java-2.1/release-notes.html"><span>Release notes</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../developer/java-2.0/java-intro.html"><span>Java SDK 2.0</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dotnet-2.1/dotnet-intro.html"><span>.NET SDK 2.1</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dotnet-2.0/dotnet-intro.html"><span>.NET SDK 2.0</span></a></li></ul></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
	<h1 class="title topictitle1" id="ariaid-title1">Deleting documents</h1>

	
	<div class="body conbody"><p class="shortdesc">Describes how to delete documents using the <samp class="ph codeph">remove()</samp> method.</p>


		<section class="section"><h2 class="title sectiontitle">Removing</h2>
			

			<p class="p">You can remove a document by utilizing the <samp class="ph codeph">remove()</samp> method.</p>


<pre class="pre codeblock language-java"><code>// Remove the document by its ID.
Observable&lt;JsonDocument&gt; doc = bucket.remove("id");</code></pre>


			<p class="p">If you pass in a document which also has the CAS value populated, the SDK will make sure to only delete the document if they match:</p>


<pre class="pre codeblock language-java"><code>// Create document with some content
JsonDocument stored = bucket.upsert(JsonDocument.create("mydoc", JsonObject.create()));

// Delete it with the CAS check included
JsonDocument removed = bucket.remove(stored);</code></pre>


			<p class="p">If successful, the returned <samp class="ph codeph">Document</samp> has the <samp class="ph codeph">id</samp> and <samp class="ph codeph">cas</samp> fields populated, all other fields are set to their default values.</p>


			<p class="p">If the document is not found, a <samp class="ph codeph">DocumentNotFoundException</samp> is raised. When the document is found but the <samp class="ph codeph">cas</samp> values do not match, a <samp class="ph codeph">CASMismatchException</samp> is raised.</p>


		</section>


		<section class="section"><h2 class="title sectiontitle">Durability Requirements</h2>
			

			<p class="p">If no durability requirements are set on the <samp class="ph codeph">remove</samp> method, the operation will succeed when the server acknowledges the document delete in its managed cache layer. While this is a performant operation, there might be situations where you want to make sure that your document deletion has been persisted and/or replicated so that it survives power outages and other node failures.</p>


			<p class="p">The remove method provides overloads to supply such requirements:</p>


<pre class="pre codeblock language-java"><code>Observable&lt;D&gt; remove(String id, PersistTo persistTo);
Observable&lt;D&gt; remove(String id, ReplicateTo replicateTo);
Observable&lt;D&gt; remove(String id, PersistTo persistTo, ReplicateTo replicateTo);

Observable&lt;D&gt; remove(D document, PersistTo persistTo);
Observable&lt;D&gt; remove(D document, ReplicateTo replicateTo);
Observable&lt;D&gt; remove(D document, PersistTo persistTo, ReplicateTo replicateTo);</code></pre>


			<p class="p">You can configure either just one or both of the requirements when removing. From an application point of view nothing needs to be changed when working with the response, although there is something that need to be kept in mind:</p>


			<p class="p">The internal implementation first performs a regular <samp class="ph codeph">remove</samp> operation and afterwards starts polling the specific affected cluster nodes for the state of the document. If something fails during this operation (and failing the <samp class="ph codeph">Observable</samp>), the original operation might have succeeded nonetheless.</p>


<pre class="pre codeblock language-java"><code>// Remove the document and make sure the delete is persisted.
Observable&lt;JsonDocument&gt; doc = bucket.remove("id", PersistTo.MASTER);

// Remove the document and make sure the delete is replicated.
Observable&lt;JsonDocument&gt; doc = bucket.remove("id", ReplicateTo.ONE);

// Remove the document and make sure the delete is persisted and replicated.
Observable&lt;JsonDocument&gt; doc = bucket.remove("id", PersistTo.MASTER, ReplicateTo.ONE);</code></pre>


		</section>


	</div>

<nav class="related-links"><h2>Related information</h2>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../developer/java-2.1/documents.html" title="The Java SDK offers methods you can use to accomplish the basic CRUD operations of creating, retrieving, updating, and deleting documents.">Working with documents</a></div>
<div class="previouslink"><strong>Previous topic:</strong> <a class="link" href="../../developer/java-2.1/documents-retrieving.html" title="Describes how to load documents using the various get() methods.">Retrieving documents</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../../developer/java-2.1/documents-atomic.html" title="The CouchbaseBucket class provides atomic operations such as counter(), append(), and prepend().">Atomic operations</a></div>
</div>
</nav></div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../';</script><script src="../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>