<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Connecting to Couchbase Server — Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/install-intro.html"><span>Installation and upgrade</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/admin-intro.html"><span>Administration</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/cli-intro.html"><span>CLI reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a><ul class="sub-sections"><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/dev-guide-3.0/first-app.html"><span>Creating your first application</span></a><ul class="sub-sections"><li class="section"><a href="../../developer/dev-guide-3.0/dev-env.html"><span>Setting up the development environment</span></a></li><li class="section"><a href="../../developer/dev-guide-3.0/connect.html" class="current"><span>Connecting to Couchbase Server</span></a><ul class="sub-sections"></ul></li><li class="section"><a href="../../developer/dev-guide-3.0/connect-get-set.html"><span>Performing connect, set and get</span></a></li><li class="section"><a href="../../developer/dev-guide-3.0/first-query.html"><span>Performing a first query</span></a></li><li class="section"><a href="../../developer/dev-guide-3.0/telnet.html"><span>Performing basic Telnet operations</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/modeling-docs.html"><span>Modeling documents</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/access-data.html"><span>Accessing data with Couchbase SDKs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/store-data.html"><span>Storing data</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/find-data.html"><span>Finding data with views</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/advanced-topics.html"><span>Advanced topics in development</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/client-library.html"><span>Developing a client library</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content">
	<h1 class="title topictitle1" id="ariaid-title1">Connecting to Couchbase Server</h1>

	<div class="body conbody">
		<p class="p">After you have your Couchbase Server up and running, and your chosen Couchbase Client
			libraries installed on a web server, you create the code that connects to the server from
			the client.</p>

		
		<section class="section" id="concept8100__create-first-bucket"><h2 class="title sectiontitle">Create your first bucket</h2>
			
			<p class="p">The first thing you will want to do after setting up Couchbase Server and exploring the
				SDKs is to create a data bucket. You can do so with the Couchbase Admin Console, or you
				can use the REST API. For your first application in this chapter, we will show the REST
				API approach, which you may be less familiar with after your initial server install.</p>

			<p class="p">You create either a Couchbase or memcached bucket using the REST API. When you make a
				request, you provide a REST request using a REST client or a UNIX utility such as
				curl.</p>

			<ol class="ol">
				<li class="li">
					<p class="p">Make a new bucket request to the REST endpoint for buckets and provide the new
						bucket settings as request parameters:</p>

					<div class="p">
						<pre class="pre"><code>shell&gt; curl -u Administrator:password \
-d name=newBucket -d ramQuotaMB=100 -d authType=none \
-d replicaNumber=1 -d proxyPort=11215 http://localhost:8091/pools/default/buckets
						</code></pre>

					</div>

					<p class="p">To create a bucket we first provide our credentials for the bucket. These are the
						same credentials we established when we first installed Couchbase Server. For the
						sake of convenience, we create a single Couchbase bucket named
							<samp class="ph codeph">newBucket</samp> with a RAM quota of 100MB. We require no
						authentication for the bucket and set the proxy port for the bucket to 11215.</p>

					<p class="p">Couchbase Server sends back this HTTP response:</p>

					<div class="p">
						<pre class="pre"><code>202</code></pre>

					</div>

				</li>

				<li class="li">
					<p class="p">You can check your new bucket exists and is running by making a REST request to the new
						bucket:</p>

					<div class="p">
						<pre class="pre"><code>shell&gt; curl http://localhost:8091/pools/default/buckets/newBucket</code></pre>

					</div>

					<p class="p">Couchbase Server will respond with a JSON document containing information on the
						new bucket:</p>

<pre class="pre codeblock language-json"><code>
{  
   "name":"newcachebucket",
   "bucketType":"couchbase",
   ...
   "bucketCapabilities":[  
      "touch",
      "couchapi"
   ]
}
</code></pre>

					<p class="p">For this request we go to the same REST URI used when we created the bucket, plus
						we add the endpoint information for the new bucket, <samp class="ph codeph">/newBucket</samp>.
						For this type of request we do not need to provide any credentials. The response
						document contains other REST requests you can make for the bucket as well as
						bucket settings/properties.</p>

				</li>

			</ol>

			<p class="p">After you create your first data bucket, you can begin interacting with that bucket
				using a Couchbase SDK. </p>

		</section>

		<section class="section"><h2 class="title sectiontitle">Connecting with Couchbase SDKs</h2>
			
			<p class="p">To create a connection to Couchbase Server you create a Couchbase client instance which
				contains and manages connection information to the server. By default Couchbase Server
				uses the URI <samp class="ph codeph">http://localhost:8091/pools</samp> for connections with Couchbase
				SDKs. This is the URI you can use to establish an initial connection to the cluster. A
				Couchbase SDK will also automatically adjust the port uses to communicate to the
				Couchbase Server based on any changes to cluster topology. Therefore it is not necessary
				to adjust your code for connecting to accommodate cluster rebalance, or to accommodate
				node addition or deletion.</p>

			<p class="p">In order to connect and perform data operations, you will need to have at least one
				default data bucket established, for instance one that you have made in the Couchbase
				Administrative Console or the REST API.</p>

			<p class="p">The following shows a basic steps for creating a connection:</p>

			<ol class="ol">
				<li class="li">
					<p class="p">Include, import, link, or require Couchbase SDK libraries into your program files.
						In the example that follows, we <samp class="ph codeph">require 'couchbase'</samp>.</p>

				</li>

				<li class="li">
					<p class="p">Provide connection information for the Couchbase cluster. Typically this includes
						URI, bucket ID, a password and optional parameters and can be provided as a list
						or string. To avoid failure to initially connect, you should provide and try at
						least two URL’s for two different nodes. In the following example, we provide
						connection information as
							<samp class="ph codeph">"http://&lt;host&gt;:&lt;port&gt;/pools"</samp>. In this case there
						is no password required.</p>

				</li>

				<li class="li">
					<p class="p">Create an instance of a Couchbase client object. In the example that follows, we
						create a new client instance in the <samp class="ph codeph">client = Couchbase.connect</samp>
						statement.</p>

				</li>

				<li class="li">
					<p class="p">Perform any database operations for your applications, such as read, write,
						delete, or query.</p>

				</li>

				<li class="li">
					<p class="p">If needed, destroy the client, and therefore disconnect.</p>

				</li>

			</ol>

			<p class="p">In the following example, we set and retrieve data in a Ruby <samp class="ph codeph">begin rescue
					end</samp> block. The code block attempts to set the value “Hello World!” for the
				key “spoon” with an expiration of 10 seconds. Then it gets the value for the “spoon” key
				and outputs it. If the Couchbase client receives an error, it outputs “There is no
				record.”</p>

			<pre class="pre codeblock language-ruby"><code>
require 'couchbase'

client = Couchbase.connect "http://&lt;host&gt;:8091/pools"

begin
  client.set "hello", "Hello World!", :ttl =&gt; 10
  spoon = client.get "hello"
  puts spoon
rescue Couchbase::Error::NotFound =&gt; e
  puts "There is no record."
end
</code></pre>

			<div class="note tip"><span class="tiptitle">Tip:</span> Depending on the language you are using, you may need to be responsible for
				explicitly destroying the Couchbase client object, and thereby destroying the
				connection. Typically it is a best practice to try to reuse the same client instance
				across multiple processes and threads, rather than constantly create and destroy
				clients. This will provide better application performance and reduce processing times.
				For more information about client instance reuse and connection pooling, see <a class="xref" href="app-performance.html#concept_gmj_qss_np__optimize-instances">Optimizing client instances</a> and <a class="xref" href="app-performance.html#concept_gmj_qss_np__maintain-connections">Maintaining persistent connections</a>.</div>

			<p class="p">The next example in Java we demonstrate how it is safest to create at least two possible node
				URIs while creating an initial connection with the server. This way, if your application
				attempts to connect, but one node is down, the client automatically re-attempts to
				connect with the second node URL:</p>

			<pre class="pre codeblock language-java"><code>
// Set up at least two URIs in case one server fails

List&lt;URI&gt; servers = new ArrayList&lt;URI&gt;();
servers.add("http://&lt;host&gt;:8091/pools");
servers.add("http://&lt;host&gt;:8091/pools");

// Create a client talking to the default bucket

CouchbaseClient cbc = new CouchbaseClient(servers, "default", "");

// Create a client talking to the default bucket

CouchbaseClient cbc = new CouchbaseClient(servers, "default", "");

System.err.println(cbc.get(“thisname") +
  " is off developing with Couchbase!");
</code></pre>

			<p class="p">A similar approach should be followed in any language when you attempt to connect to a
				Couchbase cluster. That is, you should set up an array of two or more possible nodes and
				then attempt to connect to at least one node in an array before performing other
				operations. The following demonstrates creating a connection with more than one possible
				URI in Ruby:</p>

			<pre class="pre codeblock language-ruby"><code>Couchbase.connect(:node_list =&gt; ['&lt;host&gt;:8091', '&lt;host&gt;:8091', 'example.net'])
</code></pre>

			<p class="p">After your initial connection with Couchbase Server, you will not need to reattempt
				server connection using an explicit list of node URLs after rebalance or node failure.
				After this initial connection, your Couchbase client will receive cluster information
				with all nodes available for connection. After rebalance and failover, if a client
				instance still exists, it will get updated cluster information with updated node
				URLs.</p>

			
		</section>

		<section class="section"><h2 class="title sectiontitle">Authenticating a client</h2>
			
			<p class="p">When you create a connection to the Couchbase Server, you are actually creating a new instance
				of a Couchbase client object which contains your connection information. Typically when
				you establish a bucket for your application, either in Couchbase Admin Console, or via a
				REST API call, you provide required credentials. When you connect to the bucket, provide
				your user name and password as parameters in your SDK call to
					<samp class="ph codeph">Couchbase.connect()</samp> :</p>

<pre class="pre codeblock language-ruby"><code>
Couchbase.connect("http://&lt;host&gt;:8091/pools",
    :bucket =&gt; 'bucket1',
    :username =&gt; 'Administrator',
    :password =&gt; 'password')
</code></pre>

			<p class="p">This next example demonstrates use of credentials in PHP:</p>

<pre class="pre codeblock language-php"><code>&lt;?php
$cb = new Couchbase(”&lt;host&gt;:8091", "bucketname", "password", "user");
?&gt;
</code></pre>

		</section>

	</div>


<nav class="related-links"><h2>Related information</h2>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../developer/dev-guide-3.0/first-app.html">Creating your first application</a></div>
<div class="previouslink"><strong>Previous topic:</strong> <a class="link" href="../../developer/dev-guide-3.0/dev-env.html">Setting up the development environment</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../../developer/dev-guide-3.0/connect-get-set.html">Performing connect, set and get</a></div>
</div>
</nav></div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../';</script><script src="../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>