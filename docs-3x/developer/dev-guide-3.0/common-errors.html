<!DOCTYPE html><html xmlns:related-links="http://dita-ot.sourceforge.net/ns/200709/related-links" class="no-js developer-portal" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Handling common errors — Couchbase Server 3.0/3.1</title><meta name="apple-mobile-web-app-title" content="Couchbase"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png"><link rel="stylesheet" href="../../assets/stylesheets/application.css"><link rel="stylesheet" href="../../assets/stylesheets/docs.css"></head><body data-modules="developer-portal-sidebar-navigation developer-portal-versions-navigation">
	<!-- Google Tag Manager -->
				<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-MVPNN2"
					height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
				<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
					new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
					j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
					'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
					})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
				<!-- End Google Tag Manager -->
				<header class="developer-portal-header" role="banner"><div class="layout-wrapper"><div class="developer-portal-header__hgroup"><h1 class="developer-portal-header__logo"><a href="http://couchbase.com" rel="home">Couchbase</a></h1><p class="developer-portal-header__page-title">Couchbase Server 3.0/3.1</p></div><nav class="developer-portal-header__navigation" id="primary-navigation" role="navigation"><div class="developer-portal-header__navigation__wrapper" id="primary-navigation__wrapper"><ul class="developer-portal-header__navigation__items"><li class="developer-portal-header__navigation__item"><a href="/index.html">Documentation Home</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/nosql-databases/downloads">Downloads</a></li><li class="developer-portal-header__navigation__item"><a href="http://www.couchbase.com/open-source">Open Source Projects</a></li><li class="developer-portal-header__navigation__item"><a href="http://forums.couchbase.com">Forums</a></li></ul><div class="developer-portal-header__search"><script>
					  (function() {
					    var cx = '018016427239405524608:fkg1v30apnm';
					    var gcse = document.createElement('script');
					    gcse.type = 'text/javascript';
					    gcse.async = true;
					    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					        '//www.google.com/cse/cse.js?cx=' + cx;
					    var s = document.getElementsByTagName('script')[0];
					    s.parentNode.insertBefore(gcse, s);
					  })();
					</script><gcse:search></gcse:search></div></div></nav></div></header><main class="developer-portal-global-content" role="main"><aside class="developer-portal-sidebar"><nav class="developer-portal-sidebar__navigation"><div class="developer-portal-sidebar__navigation__wrapper" id="developer-portal-sidebar-navigation"><ul><li class="section section--has-sub-sections"><a href="../../admin/Couchbase-intro.html"><span>Introduction</span></a></li><li class="section"><a href="../../admin/Whats-new-3.0.html"><span>What's new in 3.0</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/install-intro.html"><span>Installation and upgrade</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/admin-intro.html"><span>Administration</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/Views/views-intro.html"><span>Views and indexes</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/cli-intro.html"><span>CLI reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rest-intro.html"><span>REST API reference</span></a></li><li class="section section--has-sub-sections"><a href="../../admin/rel-notes/rel-notes3.0.html"><span>Release notes</span></a></li><li class="section"><a href="../../admin/pdfs.html"><span>PDFs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/intro.html"><span>Overview</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/dev-guide-3.0/concepts.html"><span>Developing applications</span></a><ul class="sub-sections"><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/first-app.html"><span>Creating your first application</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/modeling-docs.html"><span>Modeling documents</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/access-data.html"><span>Accessing data with Couchbase SDKs</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/store-data.html"><span>Storing data</span></a></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/find-data.html"><span>Finding data with views</span></a></li><li class="section section--has-sub-sections&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;section--active"><a href="../../developer/dev-guide-3.0/advanced-topics.html"><span>Advanced topics in development</span></a><ul class="sub-sections"><li class="section"><a href="../../developer/dev-guide-3.0/bulk-set.html"><span>Performing a bulk set</span></a></li><li class="section"><a href="../../developer/dev-guide-3.0/memory-errors.html"><span>Handling temporary out of memory errors</span></a></li><li class="section"><a href="../../developer/dev-guide-3.0/sync-async-transactions.html"><span>Synchronous and asynchronous transactions</span></a></li><li class="section"><a href="../../developer/dev-guide-3.0/transactional-logic.html"><span>Providing transactional logic</span></a></li><li class="section"><a href="../../developer/dev-guide-3.0/app-performance.html"><span>Improving application performance</span></a></li><li class="section"><a href="../../developer/dev-guide-3.0/thread-safety.html"><span>Thread safety for Couchbase SDKs</span></a></li><li class="section"><a href="../../developer/dev-guide-3.0/common-errors.html" class="current"><span>Handling common errors</span></a><ul class="sub-sections"></ul></li><li class="section"><a href="../../developer/dev-guide-3.0/troubleshooting.html"><span>Troubleshooting</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/client-library.html"><span>Developing a client library</span></a></li></ul></li><li class="section section--has-sub-sections"><a href="../../developer/dev-guide-3.0/old-versions.html"><span>Older SDK versions</span></a></li></ul></div></nav></aside><div class="developer-portal-content"><div class="developer-portal-content__wrapper textblock__content"><h1 class="title topictitle1" id="ariaid-title1">Handling common errors</h1>
<div class="body conbody"><p class="p">This section describes resources and approaches to handling client- and server-
side errors.</p>
<p class="p"></p>
<section class="section" id="concept7680__client-timeouts"><h2 class="title sectiontitle">Client-side timeouts</h2><p class="p">Timeouts that occur during your application run time can be configured on the
Couchbase Client SDK side. In most cases, you should also assume that your
client application will need to receive Couchbase timeout information and handle
the timeout appropriately.</p>
<p class="p">This section is not intended to be a comprehensive guide on timeouts and
performance tuning for your application; it provides some of the most useful,
basic information about SDK-level timeout settings. It also describes
considerations and trade-offs you should have in mind when you design your
application to address timeouts.</p>
<p class="p">You can handle timeouts from Couchbase client
SDKs in the following ways:</p>
<ul class="ul">
<li class="li"><p class="p">Trigger another action, such as displaying default content or providing user
 with alternative action.</p>
</li>

<li class="li"><p class="p">Slow down the number of requests you are making from your application.</p>
</li>

<li class="li"><p class="p">Indicate system overload.</p>
</li>

</ul>
<p class="p">In many cases, a developer’s first instinct is to set very low timeouts, such as
100ms or less, in the hope that this will guarantee requests/responses happen in
a certain time. However one possible consequence of setting very low timeouts is
even a minor network delay of a few milliseconds can trigger a timeout. Timeouts
usually mean that a Couchbase SDK will retry an operation which puts more
unneeded traffic on the networks and other systems used in your application. In
other scenarios developers may have inherited an application they want to use
with Couchbase Server, but the application has not been originally designed to
handle timeout information returned by Couchbase Server.</p>
<p class="p">In either of these scenarios, the risk is to assume that setting aggressive
timeouts at the SDK-level will make a transaction occur in a certain time. Doing
so may erroneously lead to even more performance bottlenecks for your
application.</p>
<p class="p">Timeouts are actually intended as a way to trigger your application to make a
decision should a response not happen by a certain time. In other words, it is
still your application’s responsibility, and your responsibility as a developer
to appropriately handle types of requests that will take longer, or not return
at all. Time requirements for your application are best handled in your own
application logic.</p>
<p class="p">Setting timeouts so that an operation can fail fast can frequently be the right
approach if your application is appropriately designed to do something in the
case of a timeout, or slow response. For instance, if you want to set data and
it does not happen quickly, it may not be significant for your application’s
usability. You may want your application to provide some default result to
display, or do nothing. In other cases, your application may have to display a
general “all systems busy” to reflect the heavy concurrent demand.</p>
<p class="p">One common error to avoid is the case where you destroy a client instance and
recreate a new client object every time a timeout occurs. This is especially so
when you set an aggressively low timeout. Creating a new client is a heavier,
slower process; if you developed an application that responded to timeouts this
way, you would significantly impact performance.</p>
<p class="p">The other approach to consider in your application logic is to actually provide
a ‘relief valve’ by slowing your application down during certain operations. For
instance, in the context of bulk loading, you want to load as much information
as quickly as possible, but slow down the response of your application for the
user when the load is not progressing.</p>
<p class="p">Be aware too that with web applications, there may be a timeout that occurs
elsewhere in the system which is generated outside of the control of Couchbase
Server and Couchbase Client SDKs. For instance, most web application servers
will not let a request continue indefinitely.</p>
<p class="p">The default timeout for any given node in a Couchbase cluster is 2.5 seconds. If
a Couchbase SDK does not receive a response from the server by this time, it
will drop the connection to Couchbase Server and attempt to connect to another
node.</p>
<p class="p">Applications built on Couchbase can have timeouts configured at the following
levels:</p>
<ul class="ul">
<li class="li"><p class="p">Connection-level settings</p>
</li>

<li class="li"><p class="p">Authentication-level settings</p>
</li>

<li class="li"><p class="p">Request-level settings</p>
</li>

</ul>
<p class="p">The Couchbase PHP SDK does not have any connection, authentication, or request
timeouts which are configurable, however you can build timeouts which are
managed by your own application.</p>
<p class="p">The following are timeouts that can be set for a connection to Couchbase Server
from the Java SDK:</p>
<p class="p"></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:33.33333333333333%"><col style="width:33.33333333333333%"><col style="width:33.33333333333333%"><thead class="thead" style="text-align:left;"><tr class="row">
	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e83">Parameter</th>

	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e86">Description</th>

	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e89">Default Setting</th>

</tr>
</thead>
<tbody class="tbody"><tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e83 ">MaxReconnectDelay</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e86 ">Maximum number of milliseconds to wait between reconnect attempts.</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e89 ">30 seconds</td>

</tr>
<tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e83 ">ShouldOptimize</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e86 ">If multiple requests simultaneously occur for same record, the record will be retrieved only once from the database and then returned to each request. This eliminates the need for multiple retrievals.</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e89 ">true</td>

</tr>
<tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e83 ">OpQueueMaxBlockTime</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e86 ">The maximum amount of time, in milliseconds a client will wait to add a new item to a queue.</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e89 ">10 milliseconds</td>

</tr>
<tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e83 ">OpTimeout</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e86 ">Operation timeout used by this connection.</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e89 ">2.5 seconds</td>

</tr>
<tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e83 ">TimeoutExceptionThreshold</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e86 ">Maximum number of timeouts allowed before this connection will shut down.</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e89 ">998 timeouts </td>

</tr>
</tbody>
</table>
</div>
<p class="p">If you performing asynchronous transactions, you should be aware that performing
these operations allocates memory at a low level. This can create a lot of
information that needs to be garbage-collected by a VM, which will also slow
down your application performance.</p>
<p class="p">The following are some of the frequently-used timeouts that you set for a
connection to Couchbase Server from the .Net SDK. for a full list of timeouts,
their defaults, and their descriptions for .Net, see the
<em class="ph i">Couchbase .Net SDK Developer Guide</em>.</p>
<p class="p"></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:33.33333333333333%"><col style="width:33.33333333333333%"><col style="width:33.33333333333333%"><thead class="thead" style="text-align:left;"><tr class="row">
	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e166">Parameter</th>

	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e169">Description</th>

	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e172">Default Setting</th>

</tr>
</thead>
<tbody class="tbody"><tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e166 ">retryTimeout</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e169 ">The amount of time to wait in between failed attempts to read cluster configguration.</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e172 ">2 seconds</td>

</tr>
<tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e166 ">observeTimeout</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e169 ">Time to wait attempting to connect to pool when all nodes are down. In milliseconds.</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e172 ">1 minute</td>

</tr>
<tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e166 ">httpRequestTimeout</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e169 ">The amount of time to wait for the HTTP streaming connection to receive cluster configuration</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e172 ">1 minute</td>

</tr>
<tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e166 ">connectionTimeout</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e169 ">The amount of time the client waits to establish a connection to the server, or get a free connection from the pool</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e172 ">10 seconds </td>

</tr>
</tbody>
</table>
</div>
<p class="p">The following are timeouts that typically can be set for a connection to
Couchbase Server from the Ruby SDK:</p>
<p class="p"></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:33.33333333333333%"><col style="width:33.33333333333333%"><col style="width:33.33333333333333%"><thead class="thead" style="text-align:left;"><tr class="row">
	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e232">Parameter</th>

	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e235">Description</th>

	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e238">Default Setting</th>

</tr>
</thead>
<tbody class="tbody"><tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e232 ">\:timeout</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e235 ">Maximum number of microseconds to wait for a connection or a read/write to occur.</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e238 ">2500000 microseconds.</td>

</tr>
</tbody>
</table>
</div>
<p class="p">In the case of the Ruby SDK, you can set a timeout for the initial connection,
and then change the timeout setting. This new connection-level setting will
apply to any subsequent read/write requests made with the client instance:</p>
<pre class="pre codeblock"><code><samp class="ph codeph">conn = Couchbase.connect(:timeout =&gt; 3_000_000)
conn.timeout = 1_500_000
conn.set("foo", "bar")
</samp></code></pre>
<p class="p">In this example, we create a new Couchbase client instance with
<samp class="ph codeph">Couchbase.connect()</samp> and set the connection time out to 3 seconds. If the
client instance fails to connect in the three seconds, it will timeout and
return a failure to connect error. Then we set the timeout to 1.5, which will be
the timeout level of any requests made with that client instance, such as the
<samp class="ph codeph">set()</samp>.</p>
<p class="p">The following is the standard, default, non-configurable timeout for the
Couchbase C and PHP SDKs. This timeout applies to creating a connection to the
server and all read- and write- operations:</p>
<p class="p"></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:50%"><col style="width:50%"><thead class="thead" style="text-align:left;"><tr class="row">
	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e277">Description</th>

	<th class="entry cellrowborder" style="text-align:left;vertical-align:top;" id="d136806e280">Default Setting</th>

</tr>
</thead>
<tbody class="tbody"><tr class="row">
	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e277 ">Default, maximum number of microseconds to wait for a connection or a read/write to occur.</td>

	<td class="entry cellrowborder" style="text-align:left;vertical-align:top;" headers="d136806e280 ">2500000 microseconds.</td>

</tr>
</tbody>
</table>
</div>
</section>
</div>
<nav class="related-links"><h2>Related information</h2>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../developer/dev-guide-3.0/advanced-topics.html">Advanced topics in development</a></div>
<div class="previouslink"><strong>Previous topic:</strong> <a class="link" href="../../developer/dev-guide-3.0/thread-safety.html">Thread safety for Couchbase SDKs</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="../../developer/dev-guide-3.0/troubleshooting.html">Troubleshooting</a></div>
</div>
</nav></div><footer class="developer-portal-footer" role="contentinfo"><p class="legal"><span class="license">© 2011–2015 <b class="company-name">Couchbase</b>. All rights reserved.</span><a href="http://support.couchbase.com/">Customer Login</a><a href="http://www.couchbase.com/terms-of-service">Terms of Service</a><a href="http://www.couchbase.com/privacy-policy">Privacy Policy</a></p></footer></div></main><script src="../../assets/javascripts/vendor/prism.js"></script><script type="text/javascript">var BASEPATH='../../';</script><script src="../../assets/javascripts/init.js"></script><script type="text/javascript" src="https://issues.couchbase.com/s/en_US-pvmaib-418945332/845/131/1.2.9/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId=86389172"></script></body></html>