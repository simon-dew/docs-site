<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://metrics.couchbase.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
<!-- End Google Tag Manager -->
<title>Scans | Couchbase Docs (Staging)</title>
<link rel="canonical" href="https://simon-dew.github.io/docs-site/DOC-11050/cloud/learn/services-and-indexes/indexes/index-scans.html">
<link rel="stylesheet" href="../../../../../_/css/site.css">
<script src="../../../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="This section discusses how index spans are generated from query predicates and provides a number of examples.">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="cloud">
<meta name="dcterms.identifier" content="serverless">
<meta name="page-url" content="/cloud/serverless/learn/services-and-indexes/indexes/index-scans.html">
<meta name="page-nav-header-levels" content="0">
<meta name="generator" content="Antora 3.1.4">
<link rel="icon" href="../../../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://simon-dew.github.io/docs-site/DOC-11050/home/index.html">
                    <img src="../../../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>

  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://simon-dew.github.io/docs-site/DOC-11050/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../index.html">
                      Capella
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
    <template id="page-versions" style="display: none">
      <select class="version_list" data-component="cloud">
        <option value="" data-url="../../../../learn/services-and-indexes/indexes/index-scans.html">Provisioned</option>
        <option value="serverless" data-url="index-scans.html" selected>Serverless</option>
      </select>
    </template>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="https://github.com/simon-dew/docs-devex/edit/elixir/modules/learn/pages/services-and-indexes/indexes/index-scans.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
    </div>
  </div>

</aside>

<style>

</style>
<div class="feedback">
  

  <a href="#" class="btn any-feedback-btn" 
    id="feedbackTrigger"
    data-jira-component-id="">
    Report Feedback? </a>

</div>

<main
    class="article " 
    data-ceiling="topbar">

<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../../../index.html">Couchbase Capella</a></li>
<li class="crumb">Develop</li>
<li class="crumb"><a href="../../../n1ql/query.html">Query</a></li>
<li class="crumb"><a href="global-secondary-indexes.html">Using Indexes</a></li>
<li class="crumb"><a href="index-scans.html">Scans</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Scans</h1>
<div class="labels">
<ul>
<li class="concept"><span><i class="far fa-lightbulb"></i> concept</span></li>
</ul>
</div>


</div>
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
During query execution, when the index path is chosen, the query engine requests the scan by providing a range of values to return.
This range is represented as a <em>span</em> in the query plan.
Index scans play a major role in optimizing the query plan generation and execution.
This section discusses how index spans are generated from query predicates and provides a number of examples.
</blockquote>
</div>
<div class="paragraph">
<p>Couchbase SQL++ is a modern query processing engine designed to
provide SQL for JSON on distributed data with a flexible data model.
Modern databases are deployed across multiple nodes.
Using JSON provides a flexible data mode, and
SQL++ supports enhanced SQL for JSON, to make query processing easier.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="query-execution-details"><a class="anchor" href="#query-execution-details"></a>Query Execution: Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Applications and database drivers submit the SQL++ query to one of the available Query nodes on a database.
The Query node analyzes the query, uses metadata on underlying objects to figure out the optimal execution plan, which it then executes.
During execution, depending on the query, using applicable indexes, the Query node works with the Index and Data nodes to retrieve and perform the planned operations.
Because Couchbase is a modular clustered database, you scale out data, index, and query services to fit your performance and availability goals.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>@startuml query_execution

skinparam maxMessageSize 125
skinparam roundcorner 5
skinparam responseMessageBelowArrow true
skinparam sequenceMessageAlign direction
skinparam ParticipantPadding 10
skinparam BoxPadding 60
skinparam box {
BackgroundColor PaleGreen
ArrowColor SeaGreen
BorderColor SpringGreen
}

participant Clients

box Couchbase Database #White
collections "Query Service" as Query
collections "Index Service" as Index
collections "Data Service" as Data
end box

Clients -&gt; Query: Submit the\nquery
activate Query #teal
' tag::example[]
note left
  SELECT airportname, city
  FROM airport
  WHERE tz = "America/Anchorage"
  AND geo.alt &gt;= 2100;
end note
' end::example[]

Query -[#transparent]-&gt; Query: Parse, analyze, create plan

Query -&gt; Index: Scan request; index filters
activate Index #deepskyblue
|||
Index -&gt; Query: Get qualified doc keys and index keys
deactivate Index

' tag::fetch[]
Query -&gt; Data: Fetch request, doc keys
activate Data #midnightblue
|||
Data -&gt; Query: Fetch the\ndocuments
deactivate Data
' end::fetch[]

Query -[#transparent]&gt; Query: Evaluate; documents to results

Query -&gt; Clients: Query\nresult
deactivate Query
' tag::example[]
note left
  {
    "airportname": "Analtuvuk",
    "city": "Anaktuvuk Pass"
  }
end note
' end::example[]

@enduml</pre>
</div>
</div>
<div class="sect2">
<h3 id="inside_a_query_node"><a class="anchor" href="#inside_a_query_node"></a>Inside a Query Node</h3>
<div class="paragraph">
<p>The following figure shows all the possible phases a SELECT query goes through to return the results.
Not all queries need to go through every phase, some go through many of these phases multiple times.
For example, the Sort phase can be skipped when there is no ORDER BY clause in the query; and the Scan-Fetch-Join phases will execute multiple times for correlated subqueries.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>@startuml query_service

skinparam defaultTextAlignment center

rectangle Client

rectangle "Query Service"{
  rectangle Parse [
    Parse


    ▢



  ]
  rectangle Plan [
    Plan


    ▢



  ]
  rectangle Scan [
    Scan


    ▢

    ▢

  ]
  rectangle Fetch [
    Fetch


    ▢
    ▢
    ▢
    ▢
  ]
  rectangle Join [
    Join


    ▢
    ▢
    ▢
    ▢
  ]
  rectangle Filter [
    Filter


    ▢
    ▢
    ▢
    ▢
  ]
  rectangle PreAggregate [
    Pre-
    Aggregate

    ▢
    ▢
    ▢
    ▢
  ]
  rectangle Aggregate [
    Aggregate


    ▢



  ]
  rectangle Sort [
    Sort


    ▢
    ▢
    ▢
    ▢
  ]
  rectangle Offset [
    Offset


    ▢
    
    

  ]
  rectangle Limit [
    Limit


    ▢
    
    
    
  ]
  rectangle Project [
    Project


    ▢
    ▢
    ▢
    ▢
  ]
}

database "Data\nService" as Data
database "Index\nService" as Index
database "Search\nService" as Search

() " " as End

Client .d.&gt; Parse
Parse -&gt; Plan
Plan -&gt; Scan
Scan -&gt; Fetch
Fetch -&gt; Join
Join -&gt; Filter
Filter -&gt; PreAggregate
PreAggregate -&gt; Aggregate
Aggregate -&gt; Sort
Sort -&gt; Offset
Offset -&gt; Limit
Limit -&gt; Project
Project .u.&gt; End

Scan .. Index
Scan .. Search
Fetch .. Data
Join .. Data

@enduml</pre>
</div>
</div>
<div class="paragraph">
<p><a href="http://blog.couchbase.com/sql-for-documents-n1ql-brief-introduction-to-query-planning" target="_blank" rel="noopener">This brief introduction to query planning</a> has details of query planner.
When the Index path is chosen, query engine requests the scan by providing the range of values to return.
This range is represented as a SPAN in the query plan.
The index spans will play major roles in optimal plan generation and execution.
Here, we discuss how the Index spans are generated from the query predicates (filters).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spans-overview"><a class="anchor" href="#spans-overview"></a>Spans Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>FILTER, JOIN, and PROJECT are fundamental operations of database query processing.
The filtering process takes the initial keyspace and produces an optimal subset of the documents the query is interested in.
To produce the smallest possible subset, indexes are used to apply as many predicates as possible.</p>
</div>
<div class="paragraph">
<p>Query predicates indicate the subsets of data that we are interested in.
During the query planning phase, we select the indexes to be used.
Then, for each index, we decide the predicates to be applied by each index.
The query predicates are translated into spans in the query plan and passed to the Indexer.
Spans simply express the predicates in terms of data ranges.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The examples in this section use the sample dataset which is supplied with Couchbase Capella.
For instructions on how to install the sample data, see <a href="../../../clusters/data-service/import-data-documents.html#import-overview" class="xref page">Import Sample Data</a>.</p>
</div>
<div class="paragraph">
<p>To use the examples on this page, you must set the query context to the <code>samples</code> scope in the sample dataset.
For more information, see <a href="../../../n1ql/n1ql-intro/queriesandresults.html#query-context" class="xref page">Query Context</a>.</p>
</div>
<div class="paragraph">
<p>The examples on this page illustrate the spans for different predicates and require the following indexes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">CREATE INDEX idx_airline_id ON airline(`id`);

CREATE INDEX idx_airline_name ON airline(`name`);

CREATE INDEX idx_route_src_dst_stops
ON route(sourceairport, destinationairport, stops);

CREATE INDEX idx_route_sched
ON route(DISTINCT ARRAY v.day FOR v IN schedule END);</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="example-translations"><a class="anchor" href="#example-translations"></a>Example Translations</h3>
<div class="paragraph">
<p>The following table shows some example translations:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Predicate</th>
<th class="tableblock halign-left valign-top">Span Low</th>
<th class="tableblock halign-left valign-top">Span High</th>
<th class="tableblock halign-left valign-top">Span Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id = 10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 (BOTH)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id &gt; 10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No upper bound</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 (NEITHER)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id &lt;= 10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NULL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 (HIGH)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Consider the plan for the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id = 10;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see the spans in the <code>IndexScan3</code> section of the Explain for the query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
  {
    "plan": {
      "#operator": "Sequence",
      "~children": [
        {
          "#operator": "IndexScan3",
          "bucket": "&lt;BUCKET_NAME&gt;",
          "covers": [
            "cover ((`airline`.`id`))",
            "cover ((meta(`airline`).`id`))"
          ],
          "filter": "(cover ((`airline`.`id`)) = 10)",
          "index": "idx_airline_id",
          "index_id": "39cf9192429a6581",
          "keyspace": "airline",
          "namespace": "default",
          "scope": "samples",
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "10",
                  "inclusion": 3,
                  "low": "10"
                }
              ]
            }
          ],
          "using": "gsi"
        },
        {
          "#operator": "Parallel",
          "~child": {
            "#operator": "Sequence",
            "~children": [
              {
                "#operator": "InitialProject",
                "result_terms": [
                  {
                    "expr": "cover ((meta(`airline`).`id`))"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "text": "SELECT meta().id FROM airline WHERE id = 10;"
  }
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the above codeblock shows the entire EXPLAIN plan, but the examples
below show only the "spans" section.</p>
</div>
<div class="paragraph">
<p>In SQL++, Index Scan requests are based on a range where each range has a start value, an end value, and specifies whether to include the start or the end value.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A "High" field in the range indicates the end value.
If "High" is missing, then there is no upper bound.</p>
</li>
<li>
<p>A "Low" field in the range indicates the start value.
If "Low" is missing, the scan starts with <code>MISSING</code>.</p>
</li>
<li>
<p>Inclusion indicates if the values of the High and Low fields are included.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 22.2222%;">
<col style="width: 22.2222%;">
<col style="width: 55.5556%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Inclusion Number</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NEITHER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neither High nor Low fields are included.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only Low fields are included.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HIGH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only High fields are included.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOTH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both High and Low fields are included.</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="ex1-equality"><a class="anchor" href="#ex1-equality"></a>Example 1: EQUALITY Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id = 10;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id = 10</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id = 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id = 10;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "10",
                  "inclusion": 3,
                  "low": "10"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex2-one-sided-range"><a class="anchor" href="#ex2-one-sided-range"></a>Example 2: Inclusive One-Sided Range Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id &gt;= 10;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id &gt;= 10</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt;= 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unbounded</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 (LOW)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id &gt;= 10;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "inclusion": 1,
                  "low": "10"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex3-exclusive-one-sided-range"><a class="anchor" href="#ex3-exclusive-one-sided-range"></a>Example 3: Exclusive One-Sided Range Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id &gt; 10;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id &gt; 10</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt; 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unbounded</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0 (NEITHER)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id &gt; 10;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "inclusion": 0,
                  "low": "10"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex4-inclusive-one-sided-range"><a class="anchor" href="#ex4-inclusive-one-sided-range"></a>Example 4: Inclusive One-Sided Range Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id &lt;= 10;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id &lt;= 10</code> is pushed to index scan.
This query predicate doesn’t contain an explicit start value, so the start value will implicitly be the non-inclusive null value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &lt;= 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2 (HIGH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id &lt;= 10;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "10",
                  "inclusion": 2,
                  "low": "null"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex5-exclusive-one-sided-range"><a class="anchor" href="#ex5-exclusive-one-sided-range"></a>Example 5: Exclusive One-Sided Range Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id &lt; 10;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id &lt; 10</code> is pushed to index scan.
The query predicate doesn’t contain an explicit start value, so the start value will implicitly be the non-inclusive null value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &lt; 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0 (NEITHER)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id &lt; 10;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "10",
                  "inclusion": 0,
                  "low": "null"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex6-and"><a class="anchor" href="#ex6-and"></a>Example 6: AND Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id &gt;= 10 AND id &lt; 25;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id &gt;= 10 AND id &lt; 25</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt;= 10 AND id &lt; 25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 (LOW)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id &gt;=10 AND id &lt; 25;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "25",
                  "inclusion": 1,
                  "low": "10"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex7-multiple-and"><a class="anchor" href="#ex7-multiple-and"></a>Example 7: Multiple AND Predicates</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline
WHERE id &gt;= 10 AND id &lt; 25 AND id &lt;= 20;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id &gt;= 10 AND id &lt; 25 AND id &lt;= 20</code> is pushed to the index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id &gt;= 10 AND id &lt; 25 AND id &lt;= 20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 (BOTH)</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline
WHERE id &gt;=10 AND id &lt; 25 AND id &lt;= 20;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "20",
                  "inclusion": 3,
                  "low": "10"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Observe that the optimizer created the span without the <code>id &lt; 25</code> predicate because the AND predicate <code>id &lt;=20</code> makes the former predicate redundant.
Internally, the optimizer breaks down each predicate and then combines it in a logically consistent manner.
If this is too detailed for now, you can skip over to <a href="#ex8-and-makes-empty">Example 8</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt;= 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unbounded</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 (LOW)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &lt; 25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0 (NEITHER)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt;= 10 AND id &lt; 25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 (LOW)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &lt;= 20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2 (HIGH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt;= 10 AND id &lt; 25 AND id &lt;= 20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Internally, the following steps occur:</p>
</div>
<div id="ul_xkc_vky_mx" class="olist arabic">
<ol class="arabic">
<li>
<p>Combined Low becomes highest of both Low values (NULL is the lowest.)</p>
</li>
<li>
<p>Combined High becomes lowest of both High values (Unbounded is the highest.)</p>
</li>
<li>
<p>Combined Inclusion becomes OR of corresponding inclusions of Step 1 and Step 2.</p>
</li>
<li>
<p>Repeat Steps 1 to 3 for each AND clause.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="ex8-and-makes-empty"><a class="anchor" href="#ex8-and-makes-empty"></a>Example 8: AND Predicate Makes Empty</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id &gt; 10 AND id &lt; 5;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id &gt; 10 AND id &lt; 5</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt; 10 AND id &lt; 5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0 (NEITHER)</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This is a special case where the span is Low: 10, High: 5, and Inclusion: 0.
In this case, the start value is higher than the end value and will not produce results; so, the span is converted to EMPTY SPAN, which will not do any IndexScan.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id &gt; 10 AND id &lt; 5;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "null",
                  "inclusion": 0,
                  "low": "null"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex9-between"><a class="anchor" href="#ex9-between"></a>Example 9: BETWEEN Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id BETWEEN 10 AND 25;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id BETWEEN 10 AND 25</code> (that is, id &gt;= 10 AND id &lt;= 25) is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id BETWEEN 10 AND 25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id BETWEEN 10 AND 25;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "25",
                  "inclusion": 3,
                  "low": "10"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex10-simple-or"><a class="anchor" href="#ex10-simple-or"></a>Example 10: Simple OR Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id = 10 OR id = 20;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id = 10 OR id = 20</code> produces two independent ranges and both of them are pushed to index scan.
Duplicate ranges are eliminated, but overlaps are not eliminated.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id = 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id = 20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id = 10 OR id = 20;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
            "spans": [
              {
                "exact": true,
                "range": [
                  {
                    "high": "10",
                    "inclusion": 3,
                    "low": "10"
                  }
                ]
              },
              {
                "exact": true,
                "range": [
                  {
                    "high": "20",
                    "inclusion": 3,
                    "low": "20"
                  }
                ]
              }
            ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex11-simple-in"><a class="anchor" href="#ex11-simple-in"></a>Example 11: Simple IN Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id IN [10, 20];</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate is <code>id IN [10,20]</code> (that is, id = 10 OR id = 20).
After eliminating the duplicates, each element is pushed as a separate range to index scan.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In version 4.5, up to 8192 IN elements are pushed as separate ranges to the index service.
If the number of elements exceed 8192, then the index service performs a full scan on that key.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id = 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id = 20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id IN [10, 20];</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "10",
                  "inclusion": 3,
                  "low": "10"
                }
              ]
            },
            {
              "exact": true,
              "range": [
                {
                  "high": "20",
                  "inclusion": 3,
                  "low": "20"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex12-or-between-and"><a class="anchor" href="#ex12-or-between-and"></a>Example 12: OR, BETWEEN, AND Predicates</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline
WHERE (id BETWEEN 10 AND 25)
   OR (id &gt; 50 AND id &lt;= 60);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>(id BETWEEN 10 AND 25) OR (id &gt; 50 AND id &lt;= 60)</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id BETWEEN 10 AND 25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt; 50 AND id &lt;= 60</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>50</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>60</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2 (HIGH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline
WHERE (id BETWEEN 10 AND 25)
   OR (id &gt; 50 AND id &lt;= 60);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
            "spans": [
              {
                "exact": true,
                "range": [
                  {
                    "high": "25",
                    "inclusion": 3,
                    "low": "10"
                  }
                ]
              },
              {
                "exact": true,
                "range": [
                  {
                    "high": "60",
                    "inclusion": 2,
                    "low": "50"
                  }
                ]
              }
            ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex13-not"><a class="anchor" href="#ex13-not"></a>Example 13: NOT Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id &lt;&gt; 10;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id &lt;&gt; 10</code> is transformed to <code>id &lt; 10 OR id &gt; 10</code> and then pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &lt; 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0 (NEITHER)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt; 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unbounded</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0 (NEITHER)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id &lt;&gt; 10;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
            "spans": [
              {
                "exact": true,
                "range": [
                  {
                    "high": "10",
                    "inclusion": 0,
                    "low": "null"
                  }
                ]
              },
              {
                "exact": true,
                "range": [
                  {
                    "inclusion": 0,
                    "low": "10"
                  }
                ]
              }
            ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex14-not-and"><a class="anchor" href="#ex14-not-and"></a>Example 14: NOT, AND Predicates</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline
WHERE NOT (id &gt;= 10 AND id &lt; 25);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id &gt;= 10 AND id &lt; 25</code> is transformed to <code>id &lt;10 OR id &gt;=25</code> and pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &lt; 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0 (NEITHER)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt;= 25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>25</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unbounded</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 (LOW)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline
WHERE NOT (id &gt;= 10 AND id &lt; 25);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
            "spans": [
              {
                "exact": true,
                "range": [
                  {
                    "high": "10",
                    "inclusion": 0,
                    "low": "null"
                  }
                ]
              },
              {
                "exact": true,
                "range": [
                  {
                    "inclusion": 1,
                    "low": "25"
                  }
                ]
              }
            ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex15-equality-string"><a class="anchor" href="#ex15-equality-string"></a>Example 15: EQUALITY Predicate on String Type</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline
WHERE name = "American Airlines";</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>name &gt;= "American Airlines"</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name = "American Airlines"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"American Airlines"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"American Airlines"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline
WHERE name = "American Airlines";</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
         "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "\"American Airlines\"",
                  "inclusion": 3,
                  "low": "\"American Airlines\""
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex16-range-string"><a class="anchor" href="#ex16-range-string"></a>Example 16: Range Predicate on String Type</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline
WHERE name &gt;= "American Airlines"
  AND name &lt;= "United Airlines";</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>name &gt;= "American Airlines" AND name &lt;= "United Airlines"</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name &gt;= "American Airlines" AND name &lt;= "United Airlines"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"American Airlines"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"United Airlines"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline
  WHERE name &gt;= "American Airlines"
    AND name &lt;= "United Airlines";</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "\"United Airlines\"",
                  "inclusion": 3,
                  "low": "\"American Airlines\""
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex17-like-1"><a class="anchor" href="#ex17-like-1"></a>Example 17: LIKE Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline
WHERE name LIKE "American%";</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>name LIKE "American%"</code> is transformed to <code>name &gt;= "American"</code> AND <code>name &lt; "Americao"</code> (where "Americao" is the next string in SQL++ collation order after "American") and then pushed to index scan.
In the LIKE predicate, the % means match with any number of any characters.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name LIKE "American%"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"American"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"Americao"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 (LOW)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline
WHERE name LIKE "American%";</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "\"Americao\"",
                  "inclusion": 1,
                  "low": "\"American\""
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex18-like-2"><a class="anchor" href="#ex18-like-2"></a>Example 18: LIKE Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline
WHERE name LIKE "%American%";</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>name LIKE "%American%"</code> is transformed and pushed to index scan.
In this LIKE predicate '%' is the leading portion of the string, so we can&#8217;t push any portion of the string to the index service.
<code>""</code> is the lowest string.
<code>[]</code> is an empty array and is greater than every string value in the SQL++ collation order.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name LIKE "%American%"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>""</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"[]"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 (LOW)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline
WHERE name LIKE "%American%";</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "range": [
                {
                  "high": "[]",
                  "inclusion": 1,
                  "low": "\"\""
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex19-and-composite-index-1"><a class="anchor" href="#ex19-and-composite-index-1"></a>Example 19: AND Predicate with Composite Index</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM route
WHERE sourceairport = "SFO"
  AND destinationairport = "JFK"
  AND stops BETWEEN 0 AND 2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>sourceairport = "SFO" AND destinationairport = "JFK" AND stops BETWEEN 0 AND 2</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sourceairport = "SFO"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SFO"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SFO"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>destinationairport = "JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stops BETWEEN 0 AND 2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM route
WHERE sourceairport = "SFO"
  AND destinationairport = "JFK"
  AND stops BETWEEN 0 AND 2;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "\"SFO\"",
                  "inclusion": 3,
                  "low": "\"SFO\""
                },
                {
                  "high": "\"JFK\"",
                  "inclusion": 3,
                  "low": "\"JFK\""
                },
                {
                  "high": "2",
                  "inclusion": 3,
                  "low": "0"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex20-and-composite-index-2"><a class="anchor" href="#ex20-and-composite-index-2"></a>Example 20: AND Predicate with Composite Index</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM route
WHERE sourceairport IN ["SFO", "SJC"]
  AND destinationairport = "JFK"
  AND stops = 0;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>sourceairport IN ["SFO", "SJC"] AND destinationairport = "JFK" AND stops = 0</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sourceairport IN ["SFO", "SJC"]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SFO"</code></p>
<p class="tableblock"><code>"SJC"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SFO"</code></p>
<p class="tableblock"><code>"SJC"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p>
<p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>destinationairport = "JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stops</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM route
WHERE sourceairport IN ["SFO", "SJC"]
  AND destinationairport = "JFK"
  AND stops = 0;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "\"SFO\"",
                  "inclusion": 3,
                  "low": "\"SFO\""
                },
                {
                  "high": "\"JFK\"",
                  "inclusion": 3,
                  "low": "\"JFK\""
                },
                {
                  "high": "0",
                  "inclusion": 3,
                  "low": "0"
                }
              ]
            },
            {
              "exact": true,
              "range": [
                {
                  "high": "\"SJC\"",
                  "inclusion": 3,
                  "low": "\"SJC\""
                },
                {
                  "high": "\"JFK\"",
                  "inclusion": 3,
                  "low": "\"JFK\""
                },
                {
                  "high": "0",
                  "inclusion": 3,
                  "low": "0"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex21-composite-and-trailing-keys-missing"><a class="anchor" href="#ex21-composite-and-trailing-keys-missing"></a>Example 21: Composite AND Predicate with Trailing Keys Missing in Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM route
WHERE sourceairport = "SFO"
  AND destinationairport = "JFK";</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>sourceairport = "SFO" AND destinationairport = "JFK"</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sourceairport = "SFO"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SFO"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SFO"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>destinationairport = "JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM route
WHERE sourceairport = "SFO"
  AND destinationairport = "JFK";</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "\"SFO\"",
                  "inclusion": 3,
                  "low": "\"SFO\""
                },
                {
                  "high": "\"JFK\"",
                  "inclusion": 3,
                  "low": "\"JFK\""
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex22-composite-and-unbounded-high-trailing"><a class="anchor" href="#ex22-composite-and-unbounded-high-trailing"></a>Example 22: Composite AND Predicate with Unbounded High of Trailing Key</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM route
WHERE sourceairport = "SFO"
  AND destinationairport = "JFK"
  AND stops &gt;= 0;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>sourceairport = "SFO" AND destinationairport = "JFK" AND stops &gt;= 0</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sourceairport = "SFO"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SFO"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SFO"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>destinationairport = "JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"JFK"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stops &gt;= 0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unbounded</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 (LOW)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM route
WHERE sourceairport = "SFO"
  AND destinationairport = "JFK"
  AND stops &gt;= 0;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "\"SFO\"",
                  "inclusion": 3,
                  "low": "\"SFO\""
                },
                {
                  "high": "\"JFK\"",
                  "inclusion": 3,
                  "low": "\"JFK\""
                },
                {
                  "inclusion": 1,
                  "low": "0"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex23-equality-query-params"><a class="anchor" href="#ex23-equality-query-params"></a>Example 23: EQUALITY Predicate with Query Parameters</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id = $1;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example pushes the predicate <code>id = $1</code> to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id = $1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id = $1;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "$1",
                  "inclusion": 3,
                  "low": "$1"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex24-and-query-params"><a class="anchor" href="#ex24-and-query-params"></a>Example 24: AND Predicate with Query Parameters</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id &gt;= $1 AND id &lt; $2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id &gt;= $1 AND id &lt; $2</code> is pushed to the index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &gt;= $1 AND id &lt; $2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1 (LOW)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id &gt;= $1 AND id &lt; $2;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "$2",
                  "inclusion": 1,
                  "low": "$1"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex25-or-query-params"><a class="anchor" href="#ex25-or-query-params"></a>Example 25: OR Predicate with Query Parameters</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id = $1 OR id &lt; $2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example pushes the predicate <code>id = $1 OR id &lt; $2</code> to the index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id = $1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &lt; $2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0 (NEITHER)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id = $1 OR id &lt; $2;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
            "spans": [
              {
                "exact": true,
                "range": [
                  {
                    "high": "$1",
                    "inclusion": 3,
                    "low": "$1"
                  }
                ]
              },
              {
                "exact": true,
                "range": [
                  {
                    "high": "$2",
                    "inclusion": 0,
                    "low": "null"
                  }
                ]
              }
            ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex26-in-query-params"><a class="anchor" href="#ex26-in-query-params"></a>Example 26: IN Predicate with Query Parameters</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE id IN [ $1, 10, $2] ;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>id IN [$1, 10, $2]</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id IN [$1, 10, $2]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1</code></p>
<p class="tableblock"><code>10</code></p>
<p class="tableblock"><code>$2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$1</code></p>
<p class="tableblock"><code>10</code></p>
<p class="tableblock"><code>$2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p>
<p class="tableblock"><code>3 (BOTH)</code></p>
<p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE id IN [$1, 10, $2];</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
            "spans": [
              {
                "exact": true,
                "range": [
                  {
                    "high": "$1",
                    "inclusion": 3,
                    "low": "$1"
                  }
                ]
              },
              {
                "exact": true,
                "range": [
                  {
                    "high": "10",
                    "inclusion": 3,
                    "low": "10"
                  }
                ]
              },
              {
                "exact": true,
                "range": [
                  {
                    "high": "$2",
                    "inclusion": 3,
                    "low": "$2"
                  }
                ]
              }
            ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex27-any-1"><a class="anchor" href="#ex27-any-1"></a>Example 27: ANY Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM route
WHERE ANY v IN schedule SATISFIES v.day = 0
END;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>v.day = 0</code> is pushed to ARRAY index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>v.day = 0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM route
WHERE ANY v IN schedule SATISFIES v.day = 0
END;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
            "spans": [
              {
                "exact": true,
                "range": [
                  {
                    "high": "0",
                    "inclusion": 3,
                    "low": "0"
                  }
                ]
              }
            ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex28-any-2"><a class="anchor" href="#ex28-any-2"></a>Example 28: ANY Predicate</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM route
WHERE ANY v IN schedule SATISFIES v.day IN [1,2,3]
END;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicate <code>v.day IN [1,2,3]</code> is pushed to ARRAY index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>v.day IN [1,2,3]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p>
<p class="tableblock"><code>2</code></p>
<p class="tableblock"><code>3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p>
<p class="tableblock"><code>2</code></p>
<p class="tableblock"><code>3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p>
<p class="tableblock"><code>3 (BOTH)</code></p>
<p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM route
WHERE ANY v IN schedule SATISFIES v.day IN [1,2,3]
END;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
            "spans": [
              {
                "exact": true,
                "range": [
                  {
                    "high": "1",
                    "inclusion": 3,
                    "low": "1"
                  }
                ]
              },
              {
                "exact": true,
                "range": [
                  {
                    "high": "2",
                    "inclusion": 3,
                    "low": "2"
                  }
                ]
              },
              {
                "exact": true,
                "range": [
                  {
                    "high": "3",
                    "inclusion": 3,
                    "low": "3"
                  }
                ]
              }
            ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex29-equality-on-expr"><a class="anchor" href="#ex29-equality-on-expr"></a>Example 29: EQUALITY Predicate on Expression</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The following examples don&#8217;t have the right indexes, or the queries need to be modified to produce an optimal plan.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline WHERE abs(id) = 10;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, no predicate is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unbounded</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0 (NEITHER)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline WHERE abs(id) = 10;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "range": [
                {
                  "inclusion": 0,
                  "low": "null"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The span indicates that the index service is performing a complete index scan.
If the index does not cover the query, the query service fetches the document from the data node and then applies the predicate.
For better performance, create a new index as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">CREATE INDEX `idx_airline_absid` ON airline(abs(`id`));</code></pre>
</div>
</div>
<div class="paragraph">
<p>When index <code>idx_airline_absid</code> is used, the predicate <code>abs(id) = 10</code> is pushed to index scan.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>abs(id) = 10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline
USE INDEX (idx_airline_absid)
WHERE abs(id) = 10;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
          "spans": [
            {
              "exact": true,
              "range": [
                {
                  "high": "10",
                  "inclusion": 3,
                  "low": "10"
                }
              ]
            }
          ],
// ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ex30-overlap"><a class="anchor" href="#ex30-overlap"></a>Example 30: Overlapping Predicates</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT meta().id FROM airline
WHERE id &lt;= 100
  OR (id BETWEEN 50 AND 150);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the predicates <code>id &lt;= 100 OR (id BETWEEN 50 AND 150)</code> are pushed to index scan as two ranges.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Span Range for</th>
<th class="tableblock halign-left valign-top">Low</th>
<th class="tableblock halign-left valign-top">High</th>
<th class="tableblock halign-left valign-top">Inclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id &lt;= 100</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>100</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2 (HIGH)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id BETWEEN 50 AND 150</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>50</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>150</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 (BOTH)</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">EXPLAIN SELECT meta().id FROM airline
WHERE id &lt;= 100
  OR (id BETWEEN 50 AND 150);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">// ...
            "spans": [
              {
                "exact": true,
                "range": [
                  {
                    "high": "100",
                    "inclusion": 2,
                    "low": "null"
                  }
                ]
              },
              {
                "exact": true,
                "range": [
                  {
                    "high": "150",
                    "inclusion": 3,
                    "low": "50"
                  }
                ]
              }
            ],
// ...</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary"><a class="anchor" href="#summary"></a>Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you analyze the explain plan, correlate the predicates in the explain to the spans.
Ensure the most optimal index is selected and the spans have the expected range for all the index keys.
More keys in each span will make the query more efficient.</p>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2023 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Capella","components":["cloud"],"url":"/cloud/index.html","latestVersions":{"cloud":""}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab"></script>
<script defer src="../../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
</body>
</html>
