<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://metrics.couchbase.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
<!-- End Google Tag Manager -->
<title>Command Line Tools | Couchbase Docs (Staging)</title>
<link rel="canonical" href="https://simon-dew.github.io/docs-site/AV-64941/cloud/reference/command-line-tools.html">
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Use Couchbase command line tools to import and export large amounts of data, and manage ad hoc backups.">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="cloud">
<meta name="dcterms.identifier" content="serverless">
<meta name="page-url" content="/cloud/serverless/reference/command-line-tools.html">
<meta name="page-nav-header-levels" content="0">
<meta name="generator" content="Antora 3.1.4">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://simon-dew.github.io/docs-site/AV-64941/home/index.html">
                    <img src="../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>

  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://simon-dew.github.io/docs-site/AV-64941/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../index.html">
                      Capella
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
    <template id="page-versions" style="display: none">
      <select class="version_list" data-component="cloud">
        <option value="" data-url="../../reference/command-line-tools.html">Provisioned</option>
        <option value="serverless" data-url="command-line-tools.html" selected>Serverless</option>
      </select>
    </template>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="2">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/simondew/GitHub/couchbaselabs/project-avengers/docs/serverless/modules/reference/pages/command-line-tools.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
    </div>
  </div>

</aside>

<style>

</style>
<div class="feedback">
  

  <a href="#" class="btn any-feedback-btn" 
    id="feedbackTrigger"
    data-jira-component-id="">
    Report Feedback? </a>

</div>

<main
    class="article " 
    data-ceiling="topbar">

<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../index.html">Couchbase Capella</a></li>
<li class="crumb">Reference</li>
<li class="crumb"><a href="command-line-tools.html">Command Line Tools</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Command Line Tools</h1>
<div class="labels">
<ul></ul>
</div>


</div>
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
Use Couchbase command line tools to import and export large amounts of data, and manage ad hoc backups.
</blockquote>
</div>
<div class="paragraph">
<p>Couchbase Server includes a suite of command line tools, available as a separate package for Couchbase Capella.
Couchbase command line tools for Capella include <a href="#server:tools:cbimport.adoc" class="xref unresolved">cbimport</a>,
<a href="#server:tools:cbexport.adoc" class="xref unresolved">cbexport</a>,
and <a href="#server:backup-restore:cbbackupmgr.adoc" class="xref unresolved">cbbackupmgr</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use <code>cbimport</code> to import data up to the maximum size of your Capella database, rather than the 2GiB limit of the UI tool.
See <a href="#cbimport">Using the Database Tools: cbimport</a>, <em>below</em>.</p>
</li>
<li>
<p>Use <code>cbexport</code> to quickly export data from your Capella database, in handy formats such as JSON.
See <a href="#cbexport">Using the Database Tools: cbexport</a>, <em>below</em>.</p>
</li>
<li>
<p><code>cbbackupmgr</code> is the flexible way to back up and restore data across multiple Capella databases&#8201;&#8212;&#8201;which can be very useful during development work, as well as allowing you to manage your own backups in production, where you have particular granular use cases.
See <a href="#cbbackupmgr">Using the Database Tools: cbbackupmgr</a>, <em>below</em>.</p>
</li>
<li>
<p><code>cbsh</code> is our interactive shell for Couchbase Capella, as well as self-managed Couchbase clusters, currently in Beta.
See <a href="#couchbase-shell-cbsh">Other CLI Tools: cbsh</a>, <em>below</em>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have added your IP address to the allow list. For more information, see <a href="../clusters/allow-ip-address.html" class="xref page">Configure Allowed IP Addresses</a>.</p>
</li>
<li>
<p>You have an API Key and API Secret to use as a username and password.</p>
</li>
<li>
<p>For the bucket name (<code>-b</code> option with the command line tools), use the database name given in the Data API tab (<strong>not</strong> the database name in Settings)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="download-and-install-the-database-tools"><a class="anchor" href="#download-and-install-the-database-tools"></a>Download and Install the Database Tools</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For the Private Preview of Serverless, packages of the command line tools for Linux (aarch64 and x86_64), Mac (M1 and x86_64), and Windows are available from a shared <a href="https://drive.google.com/drive/folders/1EyuyIEcIsdVZJk-CXZxxcQexI87FSdjI">Google Drive</a>.
This is a developer preview of the next release of the tools.
Contact your Couchbase representative if you have not been granted access to this folder&#8201;&#8212;&#8201;or fill in the access request form which GDrive will display.</p>
</div>
<div class="paragraph">
<p>Unzip or untar the packages, and the binaries are ready to run.
The zipped package also contains a <code>README</code> file, and a copy of the software licenses.</p>
</div>
<div class="paragraph">
<p>For example, for Linux x86_64:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ mkdir capella_server_tools_7.5.0</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ cd capella_server_tools_7.5.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Visit the <a href="https://drive.google.com/drive/folders/1EyuyIEcIsdVZJk-CXZxxcQexI87FSdjI">GDrive folder hosting the Serverless Private Preview versions of the tools packages</a>,
and download the package for your platform.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ tar -xf couchbase-server-tools_7.5.0-linux_x86_64.tar.gz</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ls -1
bin
couchbase-server-tools_7.5.0-linux_x86_64.tar.gz
lib
LICENSE.txt
README.txt
share</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ cd bin</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ls -1
cbbackupmgr
cbexport
cbimport</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbimport --version
cbimport version 7.5.0-4100 (0a93674)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbexport --version
cbexport version 7.5.0-4100 (0a93674)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbbackupmgr --version
cbbackupmgr version 7.5.0-4100 (0a93674)</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
On Windows, you will need to have a recent Microsoft Visual C Redistributable already installed.
Download the latest Visual C Redistributable from <a href="https://docs.microsoft.com/en-us/cpp/windows/latest-supported-vc-redist?view=msvc-170">Microsoft Visual C++ Redistributable latest supported downloads</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-the-database-tools"><a class="anchor" href="#using-the-database-tools"></a>Using the Database Tools</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For full details for each command line tool, see the Server documentation for
<a href="#server:tools:cbimport.adoc" class="xref unresolved">cbimport</a>,
<a href="#server:tools:cbexport.adoc" class="xref unresolved">cbexport</a>,
and <a href="#server:backup-restore:cbbackupmgr.adoc" class="xref unresolved">cbbackupmgr</a>&#8201;&#8212;&#8201;Refer to the following sections for a quick reference.</p>
</div>
<div class="paragraph">
<p>Note that when connecting to a serverless database, you do not need to specify <code>--cacert &lt;cert_file&gt;</code> or the <code>--no-ssl-verify</code> options (documented elsewhere, for use with Capella Provisioned, or with self-managed installations of Couchbase Server).</p>
</div>
<div class="paragraph">
<p>The examples below feature a scope called <code>music</code>, containing three collections called <code>artists1</code>, <code>artists2</code>, and <code>profiles</code>.
The <code>samples</code> scope has also been loaded.</p>
</div>
<div class="sect2">
<h3 id="cbimport"><a class="anchor" href="#cbimport"></a>cbimport</h3>
<div class="paragraph">
<p>Use the <code>cbimport csv</code> command to import data into your Capella database from a CSV file:</p>
</div>
<div class="listingblock">
<div class="title">Import a csv file, and create document keys from the artist_id field</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbimport csv -c couchbases://cb.hjv-serverless1-so15ur.sdk.cloud.couchbase.com -u 5OfOcjn32ZsJRH9uyIynbAEtR5DZ594w -p 'c4hKsEyVOb!GNiC2LlXKRguUu0Uk4DUYHFh#avi46lKgEnXcxmNknCf4OiRH15aq' -b hjv-serverless1-so15ur -d file://./music1.csv -g '%artist_id%' --scope-collection-exp music.artists1</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">CSV `./music.csv` imported to `couchbases://cb.hjv-serverless1-so15ur.sdk.cloud.couchbase.com` successfully
Documents imported: 10000 Documents failed: 0</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Import a json file with --format lines</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbimport json -c couchbases://cb.hjv-serverless1-so15ur.sdk.cloud.couchbase.com -u 5OfOcjn32ZsJRH9uyIynbAEtR5DZ594w -p 'c4hKsEyVOb!GNiC2LlXKRguUu0Uk4DUYHFh#avi46lKgEnXcxmNknCf4OiRH15aq' -b hjv-serverless1-so15ur --dataset file://./profile_docs.json --format lines  --generate-key '%profile_id%' --scope-collection-exp music.profiles --threads 4</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">JSON `./profile_docs.json` imported to `couchbases://cb.hjv-serverless1-so15ur.sdk.cloud.couchbase.com` successfully
Documents imported: 3888 Documents failed: 0</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Import a csv file, and create document keys as random UUID</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbimport csv -c couchbases://cb.hjv-serverless1-so15ur.sdk.cloud.couchbase.com -u 5OfOcjn32ZsJRH9uyIynbAEtR5DZ594w -p 'c4hKsEyVOb!GNiC2LlXKRguUu0Uk4DUYHFh#avi46lKgEnXcxmNknCf4OiRH15aq' -b hjv-serverless1-so15ur -d file://./music2.csv --generate-key '#UUID#'  --scope-collection-exp music.artists2</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">CSV `./music.csv` imported to `couchbases://cb.hjv-serverless1-so15ur.sdk.cloud.couchbase.com` successfully
Documents imported: 10000 Documents failed: 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>For an example on how to create the following <code>serverless_samples_export.json</code> file, see the <a href="#cbexport">cbexport example</a>.
Import the contents of <code>serverless_samples_export.json</code> into <code>samples2</code> scope, retrieving the collection names from the field collection_name, generating document keys from the field <code>doc_key</code>, and do not include the <code>doc_key</code>, <code>scope_name</code>, and <code>collection_name</code> fields in the documents created.</p>
</div>
<div class="paragraph">
<p>For this import, a scope named <code>scope2</code> was created with collections <code>airline</code>, <code>airport</code>, <code>route</code>, <code>landmark</code>, and <code>hotel</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbimport json -c couchbases://cb.hjv-serverless1-so15ur.sdk.cloud.couchbase.com -u 5OfOcjn32ZsJRH9uyIynbAEtR5DZ594w -p 'c4hKsEyVOb!GNiC2LlXKRguUu0Uk4DUYHFh#avi46lKgEnXcxmNknCf4OiRH15aq' -b hjv-serverless1-so15ur --dataset file://./serverless_samples_export.json --scope-collection-exp samples2.%collection_name% --format lines --generate-key %doc_key% --ignore-fields doc_key,scope_name,collection_name</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">JSON `./serverless_samples_export.json` imported to `couchbases://cb.hjv-serverless1-so15ur.sdk.cloud.couchbase.com` successfully
Documents imported: 31591 Documents failed: 0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cbexport"><a class="anchor" href="#cbexport"></a>cbexport</h3>
<div class="paragraph">
<p>Use the <code>cbexport json</code> command to export JSON documents from your Capella database.</p>
</div>
<div class="paragraph">
<p>This example exports the serverless database samples scope to the file <code>serverless_samples_export.json</code>.
The document id/key is included in the field <code>doc_key</code>, the scope name in the field <code>scope_name</code>, and the collection name in the field <code>collection_name</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbexport json -c couchbases://cb.hjv-serverless1-so15ur.sdk.cloud.couchbase.com -u 5OfOcjn32ZsJRH9uyIynbAEtR5DZ594w -p 'c4hKsEyVOb!GNiC2LlXKRguUu0Uk4DUYHFh#avi46lKgEnXcxmNknCf4OiRH15aq' -b hjv-serverless1-so15ur --format lines --output ./serverless_samples_export.json --scope-field scope_name --collection-field collection_name --include-key doc_key --include-data samples</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">JSON exported to `./serverless_samples_export.json` successfully
Documents exported: 31591 Documents skipped: 0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cbbackupmgr"><a class="anchor" href="#cbbackupmgr"></a>cbbackupmgr</h3>
<div class="paragraph">
<p>Use the <code>cbbackupmgr backup</code> and <code>cbbackupmgr restore</code> commands to back up and restore your Capella database.
 For example, you can backup data from your Serverless database and restore to your local Couchbase Server, to a different Serverless database, or to a Capella Provisioned database bucket.
You will need to use <code>--disable</code> options to disable backup or restore of data that can&#8217;t be read or written by the Capella database access credentials.</p>
</div>
<div class="paragraph">
<p>You must use the following <code>--disable</code> options with <code>cbbackupmgr config</code> to configure the backup repository for a Serverless database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">--disable-analytics
--disable-cluster-analytics
--disable-bucket-query
--disable-cluster-query
--disable-ft-indexes
--disable-ft-alias
--disable-bucket-config</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Views</div>
<div class="paragraph">
<p>In addition to the other <code>--disable</code> options already noted,
 if you are restoring data backed up from a self-managed cluster to a Capella database, using <code>cbbackupmgr restore</code>,
you should use <code>--disable-views</code> in case the backup contains <a href="#7.1@server:learn:views/views-basics.adoc" class="xref unresolved">views</a>, since you cannot create views in a Capella database.
Please note that the <code>beer-sample</code> and <code>gamesim-sample</code> data sets contain views.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Configure the backup repository</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbbackupmgr config --archive ./cb_backups --repo serverless1 --disable-analytics --disable-cluster-analytics --disable-bucket-query --disable-cluster-query --disable-ft-indexes --disable-ft-alias --disable-bucket-config</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">Backup repository `serverless1` created successfully in archive `./cb_backups`</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Run the backup</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbbackupmgr backup --archive ./cb_backups --repo serverless1 -c couchbases://cb.hjv-serverless1-so15ur.sdk.cloud.couchbase.com -u 5OfOcjn32ZsJRH9uyIynbAEtR5DZ594w -p 'c4hKsEyVOb!GNiC2LlXKRguUu0Uk4DUYHFh#avi46lKgEnXcxmNknCf4OiRH15aq' --full-backup</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">…
Backup completed successfully</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Only the data in all scopes and collections will be backed up.
cbbackupmgr doesn&#8217;t back up index definitions.
Index definitions will not be backed up.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="restore-examples-to-local-to-serverless-to-provisioned"><a class="anchor" href="#restore-examples-to-local-to-serverless-to-provisioned"></a>Restore Examples (to Local, to Serverless, to Provisioned)</h4>
<div class="paragraph">
<p>Only the data in all scopes and collections in a Serverless database can be restored from a backup.
You can&#8217;t restore index definitions.</p>
</div>
<div class="paragraph">
<p>However, for simple use cases like these, <code>cbbackupmgr</code> may be simpler to use than <code>cbexport</code> and <code>cbimport</code>, since you do not have to manually create the scopes and collections when you restore.</p>
</div>
<div class="sect4">
<h5 id="restore-to-a-local-couchbase-server"><a class="anchor" href="#restore-to-a-local-couchbase-server"></a>Restore to a Local Couchbase Server</h5>
<div class="paragraph">
<p>To restore a Serverless database to a bucket in a local Couchbase Server:</p>
</div>
<div class="paragraph">
<p>First, create a bucket on the 7.1.3 local Server, called <code>serverless1</code>, with Timestamp conflict resolution (this is because the Serverless databases in Capella are always created with Timestamp conflict resolution).
. Restore the Serverless data into the bucket, <code>serverless1</code>.</p>
</div>
<div class="paragraph">
<p>+
Use the <code>--exclude-data</code> option to avoid restoring the <code>_system</code> scope.
This scope can&#8217;t be restored to Couchbase Server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbbackupmgr restore --archive ./cb_backups --repo serverless1 -c localhost -u Administrator -p 'myadminpassword' --map-data hjv-serverless1-so15ur=serverless1 --exclude-data hjv-serverless1-so15ur._system</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">…
Restore completed successfully</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="restore-to-a-different-serverless-database"><a class="anchor" href="#restore-to-a-different-serverless-database"></a>Restore to a Different Serverless Database</h5>
<div class="paragraph">
<p>To restore to another Serverless database, without any loaded sample data:</p>
</div>
<div class="paragraph">
<p>Note that in this case you do not need to use the <code>--exclude-data</code> option to exclude the <code>_system</code> scope, since this is a Serverless database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbbackupmgr restore --archive ./cb_backups --repo serverless1 -c couchbases://cb.hjv-serverless2-pmw9d0.sdk.cloud.couchbase.com -u YpCaBTCTajab7UUCgued6FCGcgev15Iw -p '1pYPsuwl@LrOtwUMS2V@TBDO7KMv@K8wiZcyphjnYuGb41zHRn#k5QIVabHm#V#m --map-data hjv-serverless1-so15ur=hjv-serverless2-pmw9d0</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">…
Restore completed successfully</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="restore-to-a-bucket-in-a-capella-provisioned-database"><a class="anchor" href="#restore-to-a-bucket-in-a-capella-provisioned-database"></a>Restore to a Bucket in a Capella Provisioned Database</h5>
<div class="paragraph">
<p>To restore a backup to a bucket called <code>serverless1</code> in a Capella Provisioned database:
The bucket must be created with Timestamp conflict resolution (since that is the conflict resolution used in the Serverless databases).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For a provisioned database, you must specify either the <code>--no-ssl-verify</code> or the <code>--cacert /root/capella.pem</code> (where capella.pem has the security certificate from the provisioned database) options.
You must use the <code>--exclude-data</code> option to exclude the <code>_system</code> scope.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbbackupmgr restore --archive ./cb_backups --repo serverless1 -c couchbases://cb.yubzwcohbbkpzrxc.cloud.couchbase.com -u dbuser -p 'somepassword1!' --map-data hjv-serverless1-so15ur=serverless1 --exclude-data hjv-serverless1-so15ur._system --no-ssl-verify</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">…
Restore completed successfully</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="other-cli-tools"><a class="anchor" href="#other-cli-tools"></a>Other CLI Tools</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="couchbase-shell-cbsh"><a class="anchor" href="#couchbase-shell-cbsh"></a>Couchbase Shell (cbsh)</h3>
<div class="paragraph">
<p>The new Couchbase shell, or REPL, to interact with Couchbase Capella is now in <a href="https://couchbase.sh/">public beta</a>.</p>
</div>
<div class="paragraph">
<p>Use cbsh to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Extract, transform, and load different data formats.</p>
</li>
<li>
<p>Export data as JSON or CSV.</p>
</li>
<li>
<p>Import data from SQLite.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>cbsh provides useful tooling both during development and production operation&#8201;&#8212;&#8201;everything from generating fake data to checking the status of your indexes.</p>
</div>
<div class="sect3">
<h4 id="installing-cbsh"><a class="anchor" href="#installing-cbsh"></a>Installing cbsh</h4>
<div class="paragraph">
<p>For the Private Preview of Serverless, prebuilt binaries of cbsh for Linux (aarch64 and x86_64), Mac (M1 and x86_64), and Windows are available from a shared <a href="https://drive.google.com/drive/folders/1zIQ5ysDWzK0MjkO7T-gv92ipzxkOSGNu">Google Drive</a>.
Contact your Couchbase representative if you have not been granted access to this folder&#8201;&#8212;&#8201;or fill in the access request form which GDrive will display.
This is a special release for the Serverless preview&#8201;&#8212;&#8201;do not use the binaries from the <a href="https://couchbase.sh/">cbsh website</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">macOS Users</div>
<div class="paragraph">
<p>If you are running a recent macOS release (from 10.15.x), you’ll probably see an error similar to <code>"cbsh" was blocked from use because it is not from an identified developer</code>.
This is because our binaries are not yet signed.
To run it nonetheless you need to navigate to <strong>System Preferences → Security &amp; Privacy</strong> and click <strong>Allow Anyway</strong>.
Next time you run the binary you’ll get another prompt but then it should run fine.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To run cbsh:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After extracting the archive, create a <code>.cbsh</code> dot folder in the same folder where the binaries are unzipped.</p>
</li>
<li>
<p>Then create a file called <code>config</code>, in this dot folder, with the contents as below:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">version = 1

[[database]]
identifier = "Serverless"
connstr = "couchbases://cb.adatabase-h4rt9w.sdk.couchbase.com"                <i class="conum" data-value="1"></i><b>(1)</b>
user-display-name = "Joe"
username = "XpkHmZXTUh4g8QMhCNHNTdqdsEKetOPE"                                 <i class="conum" data-value="2"></i><b>(2)</b>
password = "a9es8f8EYXoEXgisnmEy8zO9lnEd1RoW1j0Nn5VOrskRFJe8z8GH3xSebcC5y7xr" <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Replace <code>connstr</code> with the string that you see from <strong>settings &#8594; internet &#8594; connection string</strong>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use the API key as the username value.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Use the API secret as the password value.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run the cbsh binary in your terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./cbsh --version</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">The Couchbase Shell 0.75.0</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cbsh-in-use"><a class="anchor" href="#cbsh-in-use"></a>cbsh in Use</h4>
<div class="paragraph">
<p>Below are a couple of examples of cbsh in use.</p>
</div>
<div class="listingblock">
<div class="title">Fetch a document from the travel-sample bucket.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">&gt;  doc get airline_10 --bucket travel-sample | flatten
───┬────────────┬─────────────────────┬────────────┬─────────┬─────────────┬──────┬──────┬──────────┬───────────────┬───────┬─────────
 # │     id     │         cas         │ content_id │  type   │    name     │ iata │ icao │ callsign │    country    │ error │ cluster
───┼────────────┼─────────────────────┼────────────┼─────────┼─────────────┼──────┼──────┼──────────┼───────────────┼───────┼─────────
 0 │ airline_10 │ 1629809626107281408 │         10 │ airline │ 40-Mile Air │ Q5   │ MLA  │ MILE-AIR │ United States │       │ default
───┴────────────┴─────────────────────┴────────────┴─────────┴─────────────┴──────┴──────┴──────────┴───────────────┴───────┴─────────</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Importing data from a csv file.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">&gt; cat airports.csv
airportname,city,country,faa,icao,id,type,tz
Calais Dunkerque,Calais,France,CQF,LFAC,1254,airport,Europe/Paris
Peronne St Quentin,Peronne,France,,LFAG,1255,airport,Europe/Paris
Les Loges,Nangis,France,,LFAI,1256,airport,Europe/Paris
Couterne,Bagnole-de-l'orne,France,,LFAO,1257,airport,Europe/Paris
Bray,Albert,France,,LFAQ,1258,airport,Europe/Paris

&gt; open airports.csv | each { |it| wrap content | insert id {echo $it.content.airportname}  } | doc upsert
───┬───────────┬─────────┬────────
 # │ processed │ success │ failed
───┼───────────┼─────────┼────────
 0 │         5 │       5 │      0
───┴───────────┴─────────┴────────</code></pre>
</div>
</div>
<div class="paragraph">
<p>For documentation on the Beta release, and more examples, see the <a href="https://couchbase.sh/docs/">Couchbase Shell Documentation</a>&#8201;&#8212;&#8201;particularly sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://couchbase.sh/docs/#_loading_data_into_the_shell">2.5&#8201;&#8212;&#8201;Loading Data into the Shell</a></p>
</li>
<li>
<p><a href="https://couchbase.sh/docs/#_exporting_data_from_the_shell">2.6&#8201;&#8212;&#8201;Exporting Data from the Shell</a></p>
</li>
<li>
<p><a href="https://couchbase.sh/docs/#_cb_env_and_the_environment">3&#8201;&#8212;&#8201;cb-env and the Environment</a></p>
</li>
<li>
<p><a href="https://couchbase.sh/docs/#_couchbase_commands">4&#8201;&#8212;&#8201;Couchbase Commands</a>
Sections 4.1 and 4.2 don&#8217;t apply to Serverless.</p>
</li>
<li>
<p><a href="https://couchbase.sh/docs/#_couchbase_capella_dbaas">5&#8201;&#8212;&#8201;Couchbase Capella (DBaaS)</a>
Section 5.3 doesn&#8217;t apply to Serverless.</p>
</li>
<li>
<p><a href="https://couchbase.sh/docs/#_reference">6&#8201;&#8212;&#8201;Reference</a></p>
</li>
<li>
<p><a href="https://couchbase.sh/docs/#_recipes">7&#8201;&#8212;&#8201;Recipes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2023 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Capella","components":["cloud"],"url":"/cloud/index.html","latestVersions":{"cloud":""}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab"></script>
<script defer src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
