<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>cbbackup | Couchbase Docs (Staging)</title>
<link rel="canonical" href="https://simon-dew.github.io/docs-site/DOC-7724/server/6.6/cli/cbtools/old/cbbackup-tool.html">
<link rel="stylesheet" href="../../../../../_/css/site.css">
<script src="../../../../../_/js/vendor/jquery.js"></script>
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">
<meta name="dcterms.subject" content="server">
<meta name="dcterms.identifier" content="6.6">
<meta name="generator" content="Antora 2.3.0">
<link rel="icon" href="../../../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">

              <a class="navbar-brand" href="https://www.couchbase.com">
                <img src="../../../../../_/img/couchbase-documentation-logo.svg" alt="Couchbase" />
              </a>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://simon-dew.github.io/docs-site/DOC-7724/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../../home/cloud.html">
                      Cloud
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      Tutorials
                      <span class="arrow">
                        <i class="fas fa-arrow-right"></i>
                      </span>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <form class="navbar-item search">
                  <input type="text" placeholder="Search Docs" class="query" id="search-query" />
                  <button type="button" class="search-btn">
                    <i class="fas fa-search"></i>
                  </button>
                </form>
                <a class="btn btn-primary try-btn" href="https://www.couchbase.com/downloads">
                  Downloads
                </a>
              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<nav class="nav">
</nav>
<aside class="toc sidebar">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/simondew/GitHub/couchbase/couchbase-cli/docs/modules/cli/pages/cbtools/old/cbbackup-tool.adoc" title="Edit Page" target="_blank" rel="noopener">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../../../index.html">server</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">cbbackup</h1>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
The <code class="cmd">cbbackup</code> tool creates a copy of data from an entire running cluster, an entire bucket, a single node, or a single bucket on a single functioning node.
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="syntax"><a class="anchor" href="#syntax"></a>Syntax</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The basic syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cbbackup [options] [source] [backup-dir] -u [admin] -p [password]</pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>[backup-dir]</code></p>
<div class="paragraph">
<p>The directory for the backup files to be stored.
If an empty directory doesn&#8217;t exist,  it will be created; the parent directory <strong>must</strong> exist.</p>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The backup directory must only be used by <code class="cmd">cbbackup</code> and <code class="cmd">cbrestore</code>.
If you create the backup in a location which may be used by other processes, like <em class="path">/tmp</em>, the structure of the archive may become corrupted.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following syntax example includes a full backup and two incremental backups for a cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cbbackup http://HOST:8091 /backup-42 -u Administrator -p password
cbbackup http://HOST:8091 /backup-42 -m diff -u Administrator -p password
cbbackup http://HOST:8091 /backup-42 -m diff -u Administrator -p password</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the backup directory exists, the following backup command will automatically be incremental.
The only way to generate a full backup is to choose an unused directory.
If backing up a Couchbase Server Community Edition cluster, then incremental backup is not available â€” all backups will be full backups.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following syntax example includes a full backup, two differential backups, and one accumulative backup for a single node.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cbbackup couchbase://HOST:8091 /backup-43 -m full --single-node -u Administrator -p password
cbbackup couchbase://HOST:8091 /backup-43 -m diff --single-node -u Administrator -p password
cbbackup couchbase://HOST:8091 /backup-43 -m diff --single-node -u Administrator -p password
cbbackup couchbase://HOST:8091 /backup-43 -m accu --single-node -u Administrator -p password</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A full backup task is always triggered for a new sink location no matter what backup mode is specified.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="description"><a class="anchor" href="#description"></a>Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The backup process writes a copy of data onto the disk.
To create a backup using <code>cbbackup</code>, the node or cluster needs to be functional.</p>
</div>
<div class="paragraph">
<p>The <code>cbbackup</code>, <code>cbrestore</code>, and <code>cbtransfer</code> tools do not communicate with external IP addresses for server nodes outside of a cluster.
Backup, restore, or transfer operations are performed on data from a node within a Couchbase Server cluster.
They only communicate with nodes from a node list obtained within a cluster.
This also means that if Couchbase Server is installed with a default IP address, an external hostname cannot be used to access it.</p>
</div>
<div class="paragraph">
<p>This tool has several different options which you can use to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Backup all buckets in an entire cluster</p>
</li>
<li>
<p>Backup one named bucket in a cluster</p>
</li>
<li>
<p>Backup all buckets on a node in a cluster</p>
</li>
<li>
<p>Backup one named buckets on a specified node</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We recommended that <code>cbbackup</code> output be generated on a file system local to the server.
Specifically, back up to a dedicated partition.
A dedicated partition prevents the backup from filling the Couchbase Server data stores and operating system partitions.
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Avoid routing the <code>cbbackup</code> output to remote share file systems (NFS).
This is because <code>cbbackup</code> files are based on sqlite format which have issues being written to remote file systems.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, <code>cbbackup</code> backs up all global secondary indexes in a cluster.
If you are using <code>cbbackup</code> to backup a single node in the cluster then global secondary index definitions will only be backed up if the node has the index service enabled.
If you backup a single index node, then all index definitions across the cluster will be stored in the backup, not just indexes on that one node.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To backup global secondary indexes, the cluster administrator username and password must be passed as parameters to <code>cbbackup</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As with map-reduce views, <code>cbbackup</code> only stores the definitions of these indexes (i.e which fields are being indexed), not the contents of the index itself.
These definitions are stored in the file <code>index.json</code>, located in the backup directory.</p>
</div>
<div class="paragraph">
<p>This tool is located in the following directories:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operating system</th>
<th class="tableblock halign-left valign-top">Location</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt/couchbase/bin/cbbackup</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C:\ProgramÂ Files\Couchbase\Server\bin\cbbackup</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mac OS X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/Applications/CouchbaseÂ Server.app/Contents/Resources/couchbase-core/bin/cbbackup</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="options"><a class="anchor" href="#options"></a>Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following are the command options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. cbbackup options</caption>
<colgroup>
<col style="width: 30.7692%;">
<col style="width: 69.2308%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameters</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-h, --help</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Command line help.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-b BUCKET_SOURCE, --bucket-source=BUCKET_SOURCE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single named bucket from source cluster to transfer.
If the backup directory only contains a single bucket, then that bucket is automatically used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--single-node</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use a single server node from the source only, not all server nodes from the entire cluster.
This single server node is defined by the source URL.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-m MODE</code>, <code>--mode=MODE</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Backup mode.
The mode option takes any one of the following values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>full</code></dt>
<dd>
<p>Perform a full backup</p>
</dd>
<dt class="hdlist1"><code>diff</code></dt>
<dd>
<p>Perform a differential incremental backup, which backs up only the changes since the last full or incremental backup.</p>
</dd>
<dt class="hdlist1"><code>accu</code></dt>
<dd>
<p>Perform a cumulative incremental backup, which backs up all changes since the last full backup.</p>
</dd>
</dl>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-i ID, --id=ID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer only items that match a vbucket ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-k KEY, --key=KEY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer only items with keys that match a regular expression.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-n, --dry-run</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No actual transfer.
Just validate parameters, files, connectivity and configurations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-u USERNAME, --username=USERNAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST username for source cluster or server node.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-p PASSWORD, --password=PASSWORD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST password for cluster or server node.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-s, --ssl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer data with SSL enablec.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-t THREADS, --threads=THREADS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of concurrent workers threads performing the transfer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-v, --verbose</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Verbose logging.
More v&#8217;s provide more verbosity.
Max: -vvv.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--silent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reduce logging verbosity to only include errors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-x EXTRA, --extra=EXTRA</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provide extra, uncommon configuration parameters.
Comma-separated key=val(key-val)* pairs.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following are extra, specialized command options with the <code>cbbackup -x</code> parameter.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. cbbackup -x options</caption>
<colgroup>
<col style="width: 30.9597%;">
<col style="width: 69.0403%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">-x options</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>backoff_cap=10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum backoff time during the rebalance period.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch_max_bytes=400000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer this # of bytes per batch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch_max_size=1000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer this # of documents per batch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cbb_max_mb=100000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Split backup file on destination cluster if it exceeds the MB.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conflict_resolve=1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By default, disable conflict resolution.</p>
<p class="tableblock">This option doesn&#8217;t work in Couchbase Server versions 4.0 and 4.1 but will be re-implemented in version 4.1.1 and in subsequent versions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data_only=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For value 1, transfer only data from a backup file or cluster.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>design_doc_only=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For value 1, transfer only design documents from a backup file or cluster.
Default: 0.</p>
<p class="tableblock">Back up only design documents which include view and secondary index definitions from a cluster or bucket with the option <code>design_doc_only=1</code>.
Restore only design documents with <code>cbrestore -x design_doc_only=1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max_retry=10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max number of sequential retries if the transfer fails.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mcd_compatible=1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For value 0, display extended fields for stdout output.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nmv_retry=1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 or 1, where 1 retries transfer after a NOT_MY_VBUCKET message.
Default: 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>recv_min_bytes=4096</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amount of bytes for every TCP/IP batch transferred.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rehash=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For value 1, rehash the partition id&#8217;s of each item.
This is required when transferring data between clusters with different number of partitions, such as when transferring data from an Mac OS X server to a non-Mac OS X cluster.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>report=5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number batches transferred before updating progress bar in console.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>report_full=2000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number batches transferred before emitting progress information in console.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>seqno=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By default, start seqno from beginning.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>try_xwm=1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer documents with metadata.
Default: 1.
Value of 0 is only used when transferring from 1.8.x to 1.8.x.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uncompress=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For value 1, restore data in uncompressed mode.</p>
<p class="tableblock">This option is unsupported.
To create backups with compression, use <code>cbbackupmgr</code>, which is available for Couchbase Server Enterprise Edition only.
See <a href="#backup-restore:enterprise-backup-restore.adoc" class="page unresolved">Backup</a>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Example 1:</strong></p>
</div>
<div class="paragraph">
<p>An entire cluster can be backed up.
This includes all of the data buckets and all design documents which includes view and secondary index definitions.
To backup an entire cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cbbackup http://HOST:8091 ~/backups -u Administrator -p password</pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>~/backups</code> is the directory where you want to store the data.
When this operation is performed, be aware that cbbackup creates the following directory structure and files in the <code>~/backups</code> directory assuming there two buckets in the cluster named <code>my_name</code> and <code>sasl</code> and two nodes <code>N1</code> and <code>N2</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>~/backups
        bucket-my_name
            N1
            N2
            design.json
            index.json
        bucket-sasl
            N1
            N2
            design.json
            index.json</pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>bucket-my_name</code> and <code>bucket-sasl</code> are directories containing data files, view definitions, index definitions and where <code>N1</code> and <code>N2</code> are two sets of data files for each node in the cluster.</p>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong></p>
</div>
<div class="paragraph">
<p>To backup a single bucket in a cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cbbackup http://HOST:8091 /backups/backup-20120501 -u Administrator -p password \
 -b default</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the default bucket in the cluster is specified and the data from the default bucket is backed up.</p>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong></p>
</div>
<div class="paragraph">
<p>To backup all data from multiple buckets on a single node:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; cbbackup http://HOST:8091 /backups/ -u Administrator -p password \
 --single-node</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong></p>
</div>
<div class="paragraph">
<p>To backup data from a single bucket on a single node:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cbbackup http://HOST:8091 /backups -u Administrator -p password \
 --single-node  -b bucket_name</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong></p>
</div>
<div class="paragraph">
<p>To specify the keys that are backed up using the <code>- k</code> option.
For example, to backup all keys from a bucket with the prefix â€˜objectâ€™:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; cbbackup http://HOST:8091 /backups/backup-20120501 -u Administrator -p password \
 -b bucket_name -k '^object.*'</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 6:</strong></p>
</div>
<div class="paragraph">
<p>The following example creates a backup copy of all design documents which includes view definitions and secondary index definitions from <code>foo-bucket</code> and store this as <code>design.json</code> in the directory <code>~/backup/foo-bucket</code>.
If a bucket is not specified, design documents for all buckets in the cluster are backed up.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cbbackup http://10.5.2.117:8091 ~/backup -x design_doc_only=1 -u Administrator -p password</pre>
</div>
</div>
<div class="paragraph">
<p>Response</p>
</div>
<div class="paragraph">
<p>The following example response shows only design documents for all buckets being backed up.
In this case, the source node had two (2) buckets including the default bucket.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>transfer design doc only. bucket msgs will be skipped.
transfer design doc only. bucket msgs will be skipped.
done</pre>
</div>
</div>
<div class="paragraph">
<p>In the following output, two design documents were backed up.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[
   {
      "controllers":{
         "compact":"/pools/default/buckets/default/ddocs/_design%2Fddoc1/controller/compactView",
         "setUpdateMinChanges":"/pools/default/buckets/default/ddocs/_design%2Fddoc1/controller/setUpdateMinChanges"
      },
      "doc":{
         "json":{
            "views":{
               "view1":{
                  "map":"function(doc){emit(doc.key,doc.key_num);}"
               },
               "view2":{
                  "map":"function(doc,meta){emit(meta.id,doc.key);}"
               }
            }
         },
         "meta":{
            "rev":"1-6f9bfe0a",
            "id":"_design/ddoc1"
         }
      }
   },
   {
      "controllers":{
         "compact":"/pools/default/buckets/default/ddocs/_design%2Fddoc2/controller/compactView",
         "setUpdateMinChanges":"/pools/default/buckets/default/ddocs/_design%2Fddoc2/controller/setUpdateMinChanges"
      },
      "doc":{
         "json":{
            "views":{
               "dothis":{
                  "map":"function (doc, meta) {\n  emit(meta.id, null);\n}"
               }
            }
         },
         "meta":{
            "rev":"1-4b533871",
            "id":"_design/ddoc2"
         }
      }
   },
   {
      "controllers":{
         "compact":"/pools/default/buckets/default/ddocs/_design%2Fdev_ddoc2/controller/compactView",
         "setUpdateMinChanges":"/pools/default/buckets/default/ddocs/_design%2Fdev_ddoc2/controller/setUpdateMinChanges"
      },
      "doc":{
         "json":{
            "views":{
               "dothat":{
                  "map":"function (doc, meta) {\n  emit(meta.id, null);\n}"
               }
            }
         },
         "meta":{
            "rev":"1-a8b6f59b",
            "id":"_design/dev_ddoc2"
         }
      }
   }
]</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example 7:</strong></p>
</div>
<div class="paragraph">
<p>The following example requests a full backup of all the data on the specified cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cbbackup -m full http://example.com:8091 /backups/backup-1 -u Administrator -p password</pre>
</div>
</div>
<div class="paragraph">
<p>After an initial full backup, incremental backups can be performed.
This example requests a differential incremental backup of all the data on the specified cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cbbackup -m diff http://example.com:8091 /backups/backup-1 -u Administrator -p password</pre>
</div>
</div>
<div class="paragraph">
<p>This example requests a cumulative incremental backup of all the data on the specified cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>cbbackup -m accu http://example.com:8091 /backups/backup-1 -u Administrator -p password</pre>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../../../_/img/couchbase_logo_black.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>Â© 2020 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
</body>
</html>
