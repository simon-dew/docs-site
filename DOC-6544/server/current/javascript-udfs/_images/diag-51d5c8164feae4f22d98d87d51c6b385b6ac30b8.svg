<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="481px" preserveAspectRatio="none" style="width:500px;height:481px;background:#FFFFFF;" version="1.1" viewBox="0 0 500 481" width="500px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="88.8" style="stroke:#181818;stroke-width:1.0;" width="10" x="174" y="113.3999"/><rect fill="#FFFFFF" height="29.6" style="stroke:#181818;stroke-width:1.0;" width="10" x="312" y="143"/><rect fill="#FFFFFF" height="88.8" style="stroke:#181818;stroke-width:1.0;" width="10" x="312" y="286"/><rect fill="#FFFFFF" height="29.6" style="stroke:#181818;stroke-width:1.0;" width="10" x="455" y="315.6"/><rect height="165.6001" style="stroke:#000000;stroke-width:1.5;fill:none;" width="484" x="10" y="217.2"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="35" x2="35" y1="81.7999" y2="399.8001"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="178.5" x2="178.5" y1="81.7999" y2="399.8001"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="316.5" x2="316.5" y1="81.7999" y2="399.8001"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="460" x2="460" y1="81.7999" y2="399.8001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="20" y="78.9999">Dev</text><ellipse cx="35" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M35,21.5 L35,48.5 M22,29.5 L48,29.5 M35,48.5 L22,63.5 M35,48.5 L48,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="20" y="412.8">Dev</text><ellipse cx="35" cy="424.1" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M35,432.1 L35,459.1 M22,440.1 L48,440.1 M35,459.1 L22,474.1 M35,459.1 L48,474.1 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="142.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="149.5" y="70.9999">JSEngine</text><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="142.5" y="398.8001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="149.5" y="419.8">JSEngine</text><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95" x="269.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="276.5" y="70.9999">QueryEngine</text><rect fill="#E2E2F0" height="30.7999" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95" x="269.5" y="398.8001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="276.5" y="419.8">QueryEngine</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="436" y="78.9999">Bucket</text><path d="M442,29 C442,19 460,19 460,19 C460,19 478,19 478,29 L478,55 C478,65 460,65 460,65 C460,65 442,65 442,55 L442,29 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M442,29 C442,39 460,39 460,39 C460,39 478,39 478,29 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="436" y="412.8">Bucket</text><path d="M442,425.6 C442,415.6 460,415.6 460,415.6 C460,415.6 478,415.6 478,425.6 L478,451.6 C478,461.6 460,461.6 460,461.6 C460,461.6 442,461.6 442,451.6 L442,425.6 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M442,425.6 C442,435.6 460,435.6 460,435.6 C460,435.6 478,435.6 478,425.6 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#FFFFFF" height="88.8" style="stroke:#181818;stroke-width:1.0;" width="10" x="174" y="113.3999"/><rect fill="#FFFFFF" height="29.6" style="stroke:#181818;stroke-width:1.0;" width="10" x="312" y="143"/><rect fill="#FFFFFF" height="88.8" style="stroke:#181818;stroke-width:1.0;" width="10" x="312" y="286"/><rect fill="#FFFFFF" height="29.6" style="stroke:#181818;stroke-width:1.0;" width="10" x="455" y="315.6"/><line style="stroke:#181818;stroke-width:1.0;" x1="172" x2="162" y1="113.3999" y2="109.3999"/><line style="stroke:#181818;stroke-width:1.0;" x1="172" x2="162" y1="113.3999" y2="117.3999"/><line style="stroke:#181818;stroke-width:1.0;" x1="35" x2="173" y1="113.3999" y2="113.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="42" y="108.7999">JS: var q = select …</text><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="300" y1="143" y2="139"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="300" y1="143" y2="147"/><line style="stroke:#181818;stroke-width:1.0;" x1="184" x2="311" y1="143" y2="143"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="191" y="138.4">N1QL(…) call</text><line style="stroke:#181818;stroke-width:1.0;" x1="184" x2="194" y1="172.6" y2="168.6"/><line style="stroke:#181818;stroke-width:1.0;" x1="184" x2="194" y1="172.6" y2="176.6"/><line style="stroke:#181818;stroke-width:1.0;" x1="184" x2="316" y1="172.6" y2="172.6"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="201" y="168">return query</text><line style="stroke:#181818;stroke-width:1.0;" x1="35" x2="45" y1="202.2" y2="198.2"/><line style="stroke:#181818;stroke-width:1.0;" x1="35" x2="45" y1="202.2" y2="206.2"/><line style="stroke:#181818;stroke-width:1.0;" x1="35" x2="178" y1="202.2" y2="202.2"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="52" y="197.6">return q</text><path d="M10,217.2 L83,217.2 L83,224.8 L73,234.8 L10,234.8 L10,217.2 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="165.6001" style="stroke:#000000;stroke-width:1.5;" width="484" x="10" y="217.2"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="25" y="231.2">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="117" x="98" y="230.1999">[Every document in q]</text><line style="stroke:#181818;stroke-width:1.0;" x1="177" x2="167" y1="256.4" y2="252.4"/><line style="stroke:#181818;stroke-width:1.0;" x1="177" x2="167" y1="256.4" y2="260.4"/><line style="stroke:#181818;stroke-width:1.0;" x1="35" x2="178" y1="256.4" y2="256.4"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="42" y="251.8">operate on document</text><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="300" y1="286" y2="282"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="300" y1="286" y2="290"/><line style="stroke:#181818;stroke-width:1.0;" x1="179" x2="311" y1="286" y2="286"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="186" y="281.4">get document</text><line style="stroke:#181818;stroke-width:1.0;" x1="453" x2="443" y1="315.6" y2="311.6"/><line style="stroke:#181818;stroke-width:1.0;" x1="453" x2="443" y1="315.6" y2="319.6"/><line style="stroke:#181818;stroke-width:1.0;" x1="322" x2="454" y1="315.6" y2="315.6"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="329" y="311">get document</text><line style="stroke:#181818;stroke-width:1.0;" x1="322" x2="332" y1="345.2001" y2="341.2001"/><line style="stroke:#181818;stroke-width:1.0;" x1="322" x2="332" y1="345.2001" y2="349.2001"/><line style="stroke:#181818;stroke-width:1.0;" x1="322" x2="459" y1="345.2001" y2="345.2001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="339" y="340.6">retrieved document</text><line style="stroke:#181818;stroke-width:1.0;" x1="179" x2="189" y1="374.8001" y2="370.8001"/><line style="stroke:#181818;stroke-width:1.0;" x1="179" x2="189" y1="374.8001" y2="378.8001"/><line style="stroke:#181818;stroke-width:1.0;" x1="179" x2="316" y1="374.8001" y2="374.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="196" y="370.2001">retrieved document</text><!--MD5=[a0c5af2b54efcb9b005ee9021991bd05]
@startuml
actor Dev
 participant JSEngine
 participant QueryEngine
 database Bucket

 Dev ->> JSEngine: JS: var q = select …
 activate JSEngine
 JSEngine ->> QueryEngine : N1QL(…) call
 activate QueryEngine
 QueryEngine ->> JSEngine  : return query
 deactivate QueryEngine
 JSEngine ->> Dev : return q
 deactivate JSEngine

    loop Every document in q
      Dev ->> JSEngine   : operate on document
      JSEngine ->> QueryEngine ++ : get document
      QueryEngine ->> Bucket ++ : get document
      Bucket ->> QueryEngine - - : retrieved document
      QueryEngine ->> JSEngine - - : retrieved document
    end
@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>