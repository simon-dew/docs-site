<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://metrics.couchbase.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
<!-- End Google Tag Manager -->
<title>Connecting to Couchbase | Couchbase Docs (Preview)</title>
<link rel="canonical" href="https://simon-dew.github.io/docs-site/DOC-11696/server/current/guides/connect.html">
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="How to connect to a Couchbase Cluster.">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="server">
<meta name="dcterms.identifier" content="7.0">
<meta name="page-url" content="/server/7.0/guides/connect.html">
<meta name="page-nav-header-levels" content="0">
<meta name="generator" content="Antora 3.1.4">
<link rel="icon" href="../../../_/img/favicon.svg" type="image/svg+xml">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://simon-dew.github.io/docs-site/DOC-11696/home/index.html">
                    <img src="../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://simon-dew.github.io/docs-site/DOC-11696/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../cloud/index.html">
                      Capella
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
    <template id="page-versions" style="display: none">
      <select class="version_list" data-component="server">
        <option value="7.2" data-url="../../current/guides/connect.html">7.2</option>
        <option value="7.0" data-url="connect.html" selected>7.0</option>
      </select>
    </template>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="2">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/simondew/GitHub/simon-dew/docs-server/modules/guides/pages/connect.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-banner">
<i class="fas fa-file-alt"></i> <p>A newer version of this documentation is available.</p>
<a class="btn" href="../../current/guides/connect.html">View Latest</a>
</div>
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../introduction/intro.html">server</a></li>
<li class="crumb">Develop</li>
<li class="crumb"><a href="intro.html">Developer Guides</a></li>
<li class="crumb"><a href="connect.html">Connecting to Couchbase</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Connecting to Couchbase</h1>
<div class="labels">
<ul><li class="guide"><span><i class="far fa-check-square"></i> how-to</span></li>
</ul>
</div>


</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
How to connect to a Couchbase Cluster.
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Connecting to Couchbase can be done in several ways.
This guide will take you through some of the most common methods used to access a Couchbase cluster with an SDK client or CLI tool.</p>
</div>
<div class="paragraph">
<p>A Couchbase <a href="../learn/clusters-and-availability/clusters-and-availability.html" class="xref page">Cluster</a> is a combination of multiple server nodes, which can be accessed by users or applications with a <a href="../learn/security/usernames-and-passwords.html" class="xref page">username and password</a>.
Each server node can also be its own cluster or join an existing multi-node setup.</p>
</div>
<div class="paragraph">
<p>Couchbase uses <a href="../learn/security/roles.html" class="xref page">Role Based Access Control (RBAC)</a> to control access to its various <a href="../learn/services-and-indexes/services/services.html" class="xref page">services</a>.
A user or application can connect to a cluster and use these services, assuming that valid credentials with relevant access roles are provided.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="before-you-begin"><a class="anchor" href="#before-you-begin"></a>Before You Begin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to try out the examples in this section, follow the instructions given in <a href="../getting-started/do-a-quick-install.html" class="xref page">Do a Quick Install</a> to install Couchbase Server, configure a cluster, and load a sample dataset.</p>
</div>
<div class="sect2">
<h3 id="couchbase-clients"><a class="anchor" href="#couchbase-clients"></a>Couchbase Clients</h3>
<div class="paragraph">
<p>Clients access data by connecting to a Couchbase cluster over the network.
The most common type of client is a Couchbase SDK, which is a full programmatic API that enables applications to take the best advantage of Couchbase.
This developer guide focuses on the most commonly-used SDKs, but full explanations and reference documentation for all SDKs is available.</p>
</div>
<div class="paragraph">
<p>The command line clients also provide a quick and streamlined interface for simple access and are suitable if you just want to access an item without writing any code.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>With some editions, the command line clients are provided as part of the installation of Couchbase Server.
Assuming a default installation, you can find them in the following location, depending on your operating system:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Linux
</td>
<td class="hdlist2">
<p><code>/opt/couchbase/bin</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
Windows
</td>
<td class="hdlist2">
<p><code>C:\Program Files\Couchbase\Server\bin</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
macOS
</td>
<td class="hdlist2">
<p><code>/Applications/Couchbase Server.app/Contents/Resources/couchbase-core/bin</code></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the command line client is not provided with your installation of Couchbase Server, you must install the C SDK in order to use the command line clients.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Read the following for further information about the clients available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#c-sdk:hello-world:cbc.adoc" class="xref unresolved">Command Line Clients</a></p>
</li>
<li>
<p><a href="../../../home/sdk.html" class="xref page">SDK Clients</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connecting-to-couchbase-server"><a class="anchor" href="#connecting-to-couchbase-server"></a>Connecting to Couchbase Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Couchbase Server can be configured to run with <em>unencrypted</em> or <em>encrypted</em> network access.
When running Couchbase in a production environment, the latter is always recommended.</p>
</div>
<div class="sect2">
<h3 id="basic-auth"><a class="anchor" href="#basic-auth"></a>Basic Auth</h3>
<div class="paragraph">
<p>To connect to a standalone or Docker installation with <em>unencrypted</em> network access, set up a user with <a href="../learn/security/roles.html" class="xref page">appropriate access levels</a> and a secure password.</p>
</div>
<div id="tabs-1" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="tabs-1-web-console" class="tab">
<p>Web Console</p>
</li>
<li id="tabs-1-cbc" class="tab">
<p>cbc</p>
</li>
<li id="tabs-1-net" class="tab">
<p>.NET</p>
</li>
<li id="tabs-1-java" class="tab">
<p>Java</p>
</li>
<li id="tabs-1-node-js" class="tab">
<p>Node.js</p>
</li>
<li id="tabs-1-python" class="tab">
<p>Python</p>
</li>
</ul>
</div>
<div id="tabs-1-web-console--panel" class="tabpanel" aria-labelledby="tabs-1-web-console">
<div class="paragraph">
<p>To access a cluster via the Couchbase Server Web Console over an <em>unencrypted</em> connection, navigate to the Web Console address with your browser (by default, <code>localhost:8091</code>) and enter your credentials.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/login.png" alt="The Couchbase Admin">
</div>
</div>
<div class="paragraph">
<p>See <a href="../manage/manage-ui/manage-ui.html#authenticating-with-the-console" class="xref page">Authenticating with the Console</a> for more information.</p>
</div>
</div>
<div id="tabs-1-cbc--panel" class="tabpanel" aria-labelledby="tabs-1-cbc">
<div class="paragraph">
<p>Most <code>cbc</code> sub-commands will require some form of authentication to access a cluster or perform operations on data within a bucket.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To connect to Couchbase Server using <code>cbc</code>, pass <code>-u</code> for the username, <code>-P</code> for the password and <code>-U</code> for the connection URL immediately after a sub-command.</p>
</li>
<li>
<p>Provide the bucket name required in the connection URL (i.e., couchbase://localhost/&lt;bucket-name&gt;).</p>
</li>
</ol>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to the <code>travel-sample</code> bucket with <em>Admin</em> level credentials and performs a <code>ping</code> to check what services are running in a single-node cluster environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell" data-source-url="file:///Users/simondew/GitHub/simon-dew/docs-server/modules/guides/examples/connect/connect-cbc.sh#L4-L6">cbc ping -u Administrator -P password -U couchbase://localhost/travel-sample \
	--count=1 \
	--table</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">-------------------------------------------------------------------------------
| type  | id       | status | latency, us | remote          | local           |
-------------------------------------------------------------------------------
| cbas  | 0xec22b0 | ok     |        3003 | localhost:8095  | 127.0.0.1:38612 |
| fts   | 0xec0dc0 | ok     |        3842 | localhost:8094  | 127.0.0.1:35636 |
| kv    | 0xeaa220 | ok     |        4446 | localhost:11210 | 127.0.0.1:49426 |
| n1ql  | 0xead260 | ok     |        4249 | localhost:8093  | 127.0.0.1:56740 |
| views | 0xec0430 | ok     |        4045 | localhost:8092  | 127.0.0.1:60088 |
-------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the user credentials are invalid, <code class="cmd">cbc</code> will return a <code>LCB_ERR_AUTHENTICATION_FAILURE</code> error.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-c-client/md_doc_cbc.html" target="_blank" rel="noopener">cbc(1)</a>.</p>
</div>
</div>
<div id="tabs-1-net--panel" class="tabpanel" aria-labelledby="tabs-1-net">
<div class="paragraph">
<p>Call the <code>Cluster.ConnectAsync()</code> method with a connection URL, username and password.</p>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a single-node cluster environment with basic auth credentials.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp" data-source-url="https://github.com/couchbase/docs-sdk-dotnet/blob/3deaf02d1368c31e6802ecea8b65ef471da0c391/modules/howtos/examples/ManagingConnections.csx#L16-L29">var cluster = await Cluster.ConnectAsync("couchbase://localhost", "username", "password");
var bucket =  await cluster.BucketAsync("travel-sample");
var collection = bucket.DefaultCollection();

// You can access multiple buckets using the same Cluster object.
var anotherBucket = await cluster.BucketAsync("travel-sample");

// You can access collections other than the default
// if your version of Couchbase Server supports this feature.
var customerA = bucket.Scope("customer-a");
var widgets = customerA.Collection("widgets");

// For a graceful shutdown, disconnect from the cluster when the program ends.
await cluster.DisposeAsync();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-net-client/api/Couchbase.Cluster.html" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
<div id="tabs-1-java--panel" class="tabpanel" aria-labelledby="tabs-1-java">
<div class="paragraph">
<p>Call the <code>Cluster.connect()</code> method with a connection URL, username and password.</p>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a single-node cluster environment with basic auth credentials.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java" data-source-url="https://github.com/couchbase/docs-sdk-java/blob/4b52fe9c4c38bcc46fb7ba50ad816b898e9f122c/modules/howtos/examples/ManagingConnections.java#L39-L52">Cluster cluster = Cluster.connect("127.0.0.1", "username", "password");
Bucket bucket = cluster.bucket("travel-sample");
Collection collection = bucket.defaultCollection();

// You can access multiple buckets using the same Cluster object.
Bucket anotherBucket = cluster.bucket("beer-sample");

// You can access collections other than the default
// if your version of Couchbase Server supports this feature.
Scope customerA = bucket.scope("customer-a");
Collection widgets = customerA.collection("widgets");

// For a graceful shutdown, disconnect from the cluster when the program ends.
cluster.disconnect();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the user credentials provided are invalid, the SDK will return a <code>AuthenticationFailureException</code> error.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-java-client/com/couchbase/client/java/Cluster.html" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
<div id="tabs-1-node-js--panel" class="tabpanel" aria-labelledby="tabs-1-node-js">
<div class="paragraph">
<p>Call the <code>connect()</code> function with a connection URL, and a <code>ConnectOptions</code> object containing the username and password.</p>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a single-node cluster environment with basic auth credentials.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-nodejs hljs" data-lang="nodejs" data-source-url="https://github.com/couchbase/docs-sdk-nodejs/blob/7e0f8507c12c7102b070e99046ce91e6f78ca814/modules/howtos/examples/auth.js#L10-L13">var cluster = await couchbase.connect('couchbase://localhost', {
  username: 'Administrator',
  password: 'password',
})</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the user credentials provided are invalid, the SDK will return a <code>AuthenticationFailureError</code> error.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-node-client/classes/Cluster.html" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
<div id="tabs-1-python--panel" class="tabpanel" aria-labelledby="tabs-1-python">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Call the <code>Cluster.connect()</code> function with a connection URL, and a <code>ClusterOptions</code> object containing a <code>PasswordAutheticator</code>.</p>
</li>
<li>
<p>Provide a username and password to the <code>PasswordAutheticator</code>.</p>
</li>
</ol>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a single-node cluster environment with basic auth credentials.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python" data-source-url="https://github.com/couchbase/docs-sdk-python/blob/01f4c183c94e07bf7c64ff0c3d2532c1df043165/modules/howtos/examples/managing_connections.py#L17-L27">cluster = Cluster.connect("couchbase://localhost", ClusterOptions(PasswordAuthenticator("username", "password")))
bucket = cluster.bucket("travel-sample")
collection = bucket.default_collection()

# You can access multiple buckets using the same Cluster object.
another_bucket = cluster.bucket("beer-sample")

# You can access collections other than the default
# if your version of Couchbase Server supports this feature.
customer_a = bucket.scope("customer-a")
widgets = customer_a.collection("widgets")</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the user credentials provided are invalid, the SDK will return a <code>AuthenticationException</code> error.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-python-client/api/couchbase.html#cluster-object" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tls"><a class="anchor" href="#tls"></a>TLS</h3>
<div class="paragraph">
<p>To connect to a cluster configured with TLS (Transport Layer Security), for <em>encrypted</em> network access, you must supply an <a href="../learn/security/certificates.html" class="xref page">X.509 certificate</a>.
Before using X.509 certificate based authentication, you should run through the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../manage/manage-security/configure-server-certificates.html" class="xref page">Configure Server Certificates</a></p>
</li>
<li>
<p><a href="../manage/manage-security/configure-client-certificates.html" class="xref page">Configure Client Certificates</a></p>
</li>
</ul>
</div>
<div id="tabs-2" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="tabs-2-web-console" class="tab">
<p>Web Console</p>
</li>
<li id="tabs-2-cbc" class="tab">
<p>cbc</p>
</li>
<li id="tabs-2-net" class="tab">
<p>.NET</p>
</li>
<li id="tabs-2-java" class="tab">
<p>Java</p>
</li>
<li id="tabs-2-node-js" class="tab">
<p>Node.js</p>
</li>
<li id="tabs-2-python" class="tab">
<p>Python</p>
</li>
</ul>
</div>
<div id="tabs-2-web-console--panel" class="tabpanel" aria-labelledby="tabs-2-web-console">
<div class="paragraph">
<p>To access a cluster via the Couchbase Server Web Console over an <em>encrypted</em> connection, navigate to the secure Web Console address with your browser (by default, <code><a href="https://localhost:18091" class="bare">https://localhost:18091</a></code>) and enter your credentials.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/login.png" alt="The Couchbase Admin">
</div>
</div>
<div class="paragraph">
<p>See <a href="../manage/manage-security/manage-console-access.html" class="xref page">Manage Console Access</a> for more information.</p>
</div>
</div>
<div id="tabs-2-cbc--panel" class="tabpanel" aria-labelledby="tabs-2-cbc">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To securely connect to Couchbase Server using <code>cbc</code>, pass <code>-U</code> for the connection URL immediately after a sub-command.</p>
</li>
<li>
<p>Provide the bucket name required in the connection URL (i.e., couchbases://127.0.0.1/&lt;bucket-name&gt;). Note that "couchbases://" implies an encrypted connection scheme is used.</p>
</li>
<li>
<p>Pass a <code>certpath</code> query parameter to the connection URL, after the bucket name.</p>
</li>
</ol>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to the <code>travel-sample</code> bucket with a client certificate, and performs a <code>ping</code> to check what services are running in a single-node <em>secured</em> cluster environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell" data-source-url="file:///Users/simondew/GitHub/simon-dew/docs-server/modules/guides/examples/connect/connect-cbc.sh#L10-L12">cbc ping -v -U "couchbases://127.0.0.1/travel-sample?certpath=ca.pem" \
	--count=1 \
	--table</code></pre>
</div>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-c-client/md_doc_cbc.html" target="_blank" rel="noopener">cbc(1)</a>.</p>
</div>
</div>
<div id="tabs-2-net--panel" class="tabpanel" aria-labelledby="tabs-2-net">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Call the <code>WithX509CertificateFactory()</code> method on a <code>ClusterOptions()</code> object.</p>
</li>
<li>
<p>Provide the certificate store information to the <code>WithX509CertificateFactory()</code> method.</p>
</li>
<li>
<p>Call the <code>ConnectAsync()</code> method and pass it the cluster options object.</p>
</li>
</ol>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a single-node cluster over a secure connection with a client certificate.</p>
</div>
<div class="paragraph">
<p>It is assumed that a valid client certificate and certificate store have been set up.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp" data-source-url="https://github.com/couchbase/docs-sdk-dotnet/blob/3deaf02d1368c31e6802ecea8b65ef471da0c391/modules/howtos/examples/Auth.cs#L29-L39">var options = new ClusterOptions().
    WithX509CertificateFactory(CertificateFactory.GetCertificatesFromStore(
        new CertificateStoreSearchCriteria
        {
            FindValue = "value",
            X509FindType = X509FindType.FindBySubjectName,
            StoreLocation = StoreLocation.CurrentUser,
            StoreName = StoreName.CertificateAuthority
        }));

var cluster = await Cluster.ConnectAsync(options);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-net-client/api/Couchbase.Cluster.html" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
<div id="tabs-2-java--panel" class="tabpanel" aria-labelledby="tabs-2-java">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Load a Java keystore file containing your client certificate and pass it to the <code>CertificateAuthenticator.fromKeyStore()</code> method along with the required password.</p>
</li>
<li>
<p>Call the <code>Cluster.connect()</code> method and pass the connection string along with cluster options containing the <code>CertificateAuthenticator</code> object previously created.</p>
</li>
</ol>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a single-node cluster over a secure connection with a client certificate.</p>
</div>
<div class="paragraph">
<p>It is assumed that a valid client certificate and a Java keystore have been set up.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java" data-source-url="https://github.com/couchbase/docs-sdk-java/blob/4b52fe9c4c38bcc46fb7ba50ad816b898e9f122c/modules/howtos/examples/Auth.java#L56-L60">// should be replaced with your actual KeyStore
KeyStore keyStore = loadKeyStore();

CertificateAuthenticator authenticator = CertificateAuthenticator.fromKeyStore(keyStore, "keyStorePassword");
Cluster cluster = Cluster.connect("127.0.0.1", clusterOptions(authenticator));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-java-client/com/couchbase/client/java/Cluster.html" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
<div id="tabs-2-node-js--panel" class="tabpanel" aria-labelledby="tabs-2-node-js">
<div class="paragraph">
<p>Call the <code>connect()</code> function with a connection URL, and a <code>ConnectOptions</code> object containing a certificate <code>trustStorePath</code> and user credentials.</p>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a single-node cluster over a secure connection with a client certificate.</p>
</div>
<div class="paragraph">
<p>It is assumed that a valid client certificate has been set up.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-nodejs hljs" data-lang="nodejs" data-source-url="https://github.com/couchbase/docs-sdk-nodejs/blob/7e0f8507c12c7102b070e99046ce91e6f78ca814/modules/howtos/examples/auth.js#L42-L46">cluster = await couchbase.connect('couchbases://localhost', {
  trustStorePath: '/path/to/ca/certificates.pem',
  username: 'Administrator',
  password: 'password',
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-node-client/classes/Cluster.html" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
<div id="tabs-2-python--panel" class="tabpanel" aria-labelledby="tabs-2-python">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Call the <code>Cluster.connect()</code> function with a connection URL, and a <code>ClusterOptions</code> object containing a <code>PasswordAutheticator</code>.</p>
</li>
<li>
<p>Provide a username and password to the <code>PasswordAutheticator</code>.</p>
</li>
<li>
<p>Supply a certificate path to the <code>PasswordAutheticator</code>.</p>
</li>
</ol>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a single-node cluster over a secure connection with a client certificate.</p>
</div>
<div class="paragraph">
<p>It is assumed that a valid client certificate has been set up.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python" data-source-url="https://github.com/couchbase/docs-sdk-python/blob/01f4c183c94e07bf7c64ff0c3d2532c1df043165/modules/howtos/examples/managing_connections.py#L145">cluster = Cluster("couchbases://localhost",ClusterOptions(PasswordAuthenticator("username","password",cert_path="/path/to/cluster.crt")))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-python-client/api/couchbase.html#cluster-object" target="_blank" rel="noopener">Cluser</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connecting-to-couchbase-capella"><a class="anchor" href="#connecting-to-couchbase-capella"></a>Connecting to Couchbase Capella</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To connect to the database via Couchbase Capella, create a valid account and set up some <a href="../../../cloud/get-started/run-first-queries.html#credentials" class="xref page">database credentials</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/capella-security-cert.png" alt="The Security Certificate">
</div>
</div>
<div class="paragraph">
<p>Download a security certificate to <a href="../../../cloud/get-started/run-first-queries.html#connect" class="xref page">connect</a> an SDK or CLI client to Capella.</p>
</div>
<div id="tabs-3" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="tabs-3-web-console" class="tab">
<p>Web Console</p>
</li>
<li id="tabs-3-cbc" class="tab">
<p>cbc</p>
</li>
<li id="tabs-3-net" class="tab">
<p>.NET</p>
</li>
<li id="tabs-3-java" class="tab">
<p>Java</p>
</li>
<li id="tabs-3-node-js" class="tab">
<p>Node.js</p>
</li>
<li id="tabs-3-python" class="tab">
<p>Python</p>
</li>
</ul>
</div>
<div id="tabs-3-web-console--panel" class="tabpanel" aria-labelledby="tabs-3-web-console">
<div class="paragraph">
<p>Navigate to <a href="https://cloud.couchbase.com/login" class="bare">https://cloud.couchbase.com/login</a> to access the Capella Web Console.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/capella-login.png" alt="The Couchbase Capella Login">
</div>
</div>
<div class="paragraph">
<p>See <a href="../../../cloud/get-started/run-first-queries.html" class="xref page">Cluster and Data</a> for more information.</p>
</div>
</div>
<div id="tabs-3-cbc--panel" class="tabpanel" aria-labelledby="tabs-3-cbc">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To connect to Couchbase Capella using <code>cbc</code>, pass <code>-u</code> for the username, <code>-P</code> for the password and <code>-U</code> for the connection URL immediately after a sub-command.</p>
</li>
<li>
<p>Provide the bucket name required in the connection URL (i.e., cb.&lt;your endpoint address&gt;.dp.cloud.couchbase.com/&lt;bucket-name&gt;).</p>
</li>
</ol>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a bucket on Couchbase Capella with a client certificate, and performs a <code>ping</code> to check what services are running.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell" data-source-url="file:///Users/simondew/GitHub/simon-dew/docs-server/modules/guides/examples/connect/connect-cbc.sh#L16-L19">cbc ping -u username -P "passworD#1" \
	-U "couchbases://cb.oawlpi4audpc6jp5.cloud.couchbase.com/travel-sample?certpath=cert.pem" \
	--count=1 \
	--table</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">-----------------------------------------------------------------------------------------------------------------------------------
| type  | id             | status | latency, us | remote                                                      | local             |
-----------------------------------------------------------------------------------------------------------------------------------
| fts   | 0x7fecf9407a70 | ok     |      198657 | evb8loulphaibjnn.oawlpi4audpc6jp5.cloud.couchbase.com:18094 | 172.20.10.6:54394 |
| kv    | 0x7fecfb00d110 | ok     |       69737 | evb8loulphaibjnn.oawlpi4audpc6jp5.cloud.couchbase.com:11207 | 172.20.10.6:54391 |
| n1ql  | 0x7fecfb0110f0 | ok     |      210735 | evb8loulphaibjnn.oawlpi4audpc6jp5.cloud.couchbase.com:18093 | 172.20.10.6:54392 |
| views | 0x7fecf961e2e0 | ok     |      330057 | evb8loulphaibjnn.oawlpi4audpc6jp5.cloud.couchbase.com:18092 | 172.20.10.6:54393 |
-----------------------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-c-client/md_doc_cbc.html" target="_blank" rel="noopener">cbc(1)</a>.</p>
</div>
</div>
<div id="tabs-3-net--panel" class="tabpanel" aria-labelledby="tabs-3-net">
<div class="paragraph">
<p>Call the <code>Cluster.ConnectAsync()</code> method with a Couchbase Capella endpoint, username, password, and client certificate.</p>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a Couchbase Capella instance over a secure connection with a client certificate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">Unresolved include directive in modules/guides/pages/connect.adoc - include::dotnet-sdk:devguide:example$dotnet/Cloud.cs[]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-net-client/api/Couchbase.Cluster.html" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
<div id="tabs-3-java--panel" class="tabpanel" aria-labelledby="tabs-3-java">
<div class="paragraph">
<p>Call the <code>Cluster.connect()</code> method method with a Couchbase Capella endpoint, username, password, and client certificate.</p>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a Couchbase Capella instance over a secure connection with a client certificate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java" data-source-url="https://github.com/couchbase/docs-sdk-java/blob/4b52fe9c4c38bcc46fb7ba50ad816b898e9f122c/modules/devguide/examples/Cloud.java">/*
 * Copyright (c) 2020 Couchbase, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import static com.couchbase.client.java.query.QueryOptions.queryOptions;

import java.io.ByteArrayInputStream;
import java.nio.charset.StandardCharsets;
import java.security.KeyStore;
import java.security.cert.CertificateException;
import java.security.cert.CertificateFactory;
import java.security.cert.X509Certificate;
import java.util.Collections;
import java.util.List;
import java.util.stream.Collectors;

import com.couchbase.client.core.deps.io.netty.handler.ssl.util.InsecureTrustManagerFactory;
import com.couchbase.client.core.env.IoConfig;
import com.couchbase.client.core.env.SecurityConfig;
import com.couchbase.client.java.Bucket;
import com.couchbase.client.java.Cluster;
import com.couchbase.client.java.ClusterOptions;
import com.couchbase.client.java.Collection;
import com.couchbase.client.java.Scope;
import com.couchbase.client.java.env.ClusterEnvironment;
import com.couchbase.client.java.json.JsonArray;
import com.couchbase.client.java.json.JsonObject;
import com.couchbase.client.java.manager.query.CreatePrimaryQueryIndexOptions;
import com.couchbase.client.java.query.QueryResult;

/**
 * Example of Cas (Check and Set) handling in Java for the Couchbase Developer
 * Guide ported from 2.x. See CloudConnect.java for 3.x.
 */

public class Cloud {
    // Update this to your certificate.
    private static final String CERT = "-----BEGIN CERTIFICATE-----\n"
            + "MIIDFTCCAf2gAwIBAgIRANLVkgOvtaXiQJi0V6qeNtswDQYJKoZIhvcNAQELBQAw\n"
            + "JDESMBAGA1UECgwJQ291Y2hiYXNlMQ4wDAYDVQQLDAVDbG91ZDAeFw0xOTEyMDYy\n"
            + "MjEyNTlaFw0yOTEyMDYyMzEyNTlaMCQxEjAQBgNVBAoMCUNvdWNoYmFzZTEOMAwG\n"
            + "A1UECwwFQ2xvdWQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCfvOIi\n"
            + "enG4Dp+hJu9asdxEMRmH70hDyMXv5ZjBhbo39a42QwR59y/rC/sahLLQuNwqif85\n"
            + "Fod1DkqgO6Ng3vecSAwyYVkj5NKdycQu5tzsZkghlpSDAyI0xlIPSQjoORA/pCOU\n"
            + "WOpymA9dOjC1bo6rDyw0yWP2nFAI/KA4Z806XeqLREuB7292UnSsgFs4/5lqeil6\n"
            + "rL3ooAw/i0uxr/TQSaxi1l8t4iMt4/gU+W52+8Yol0JbXBTFX6itg62ppb/Eugmn\n"
            + "mQRMgL67ccZs7cJ9/A0wlXencX2ohZQOR3mtknfol3FH4+glQFn27Q4xBCzVkY9j\n"
            + "KQ20T1LgmGSngBInAgMBAAGjQjBAMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYE\n"
            + "FJQOBPvrkU2In1Sjoxt97Xy8+cKNMA4GA1UdDwEB/wQEAwIBhjANBgkqhkiG9w0B\n"
            + "AQsFAAOCAQEARgM6XwcXPLSpFdSf0w8PtpNGehmdWijPM3wHb7WZiS47iNen3oq8\n"
            + "m2mm6V3Z57wbboPpfI+VEzbhiDcFfVnK1CXMC0tkF3fnOG1BDDvwt4jU95vBiNjY\n"
            + "xdzlTP/Z+qr0cnVbGBSZ+fbXstSiRaaAVcqQyv3BRvBadKBkCyPwo+7svQnScQ5P\n"
            + "Js7HEHKVms5tZTgKIw1fbmgR2XHleah1AcANB+MAPBCcTgqurqr5G7W2aPSBLLGA\n"
            + "fRIiVzm7VFLc7kWbp7ENH39HVG6TZzKnfl9zJYeiklo5vQQhGSMhzBsO70z4RRzi\n"
            + "DPFAN/4qZAgD5q3AFNIq2WWADFQGSwVJhg==\n" + "-----END CERTIFICATE-----";

    public static void main(String... args) throws Exception {
        // Update this to your cluster
        String endpoint = "cb.&lt;your endpoint address&gt;.dp.cloud.couchbase.com";
        String bucketName = "yourBucketName";
        String username = "user";
        String password = "password";
        // User Input ends here.

        KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
        trustStore.load(null, null);
        trustStore.setCertificateEntry("server", decodeCertificates(Collections.singletonList(CERT)).get(0));

        ClusterEnvironment env = ClusterEnvironment.builder()
                .securityConfig(
                        SecurityConfig.enableTls(true).trustManagerFactory(InsecureTrustManagerFactory.INSTANCE))
                .ioConfig(IoConfig.enableDnsSrv(true))
                .build();

        // Initialize the Connection
        Cluster cluster = Cluster.connect(endpoint, ClusterOptions.clusterOptions(username, password).environment(env));
        Bucket bucket = cluster.bucket(bucketName);
        Scope scope = bucket.defaultScope();
        Collection collection = bucket.defaultCollection();

        // Create a N1QL Primary Index (but ignore if it exists)
        cluster.queryIndexes().createPrimaryIndex(bucketName,
                CreatePrimaryQueryIndexOptions.createPrimaryQueryIndexOptions().ignoreIfExists(true));

        // Create a JSON Document
        JsonObject arthur = JsonObject.create()
                .put("name", "Arthur")
                .put("email", "kingarthur@couchbase.com")
                .put("interests", JsonArray.from("Holy Grail", "African Swallows"));

        // Store the Document
        collection.upsert("u:king_arthur", arthur);

        // Load the Document and print it
        // Prints Content and Metadata of the stored Document
        System.out.println(collection.get("u:king_arthur"));

        // Perform a N1QL Query
        QueryResult result = cluster.query(
                String.format("SELECT name FROM `%s` WHERE $1 IN interests", bucketName),
                queryOptions().parameters(JsonArray.from("African Swallows"))
        );

        // Print each found Row
        for (JsonObject row : result.rowsAsObject()) {
            System.out.println(row);
        }
    }

    public static List&lt;X509Certificate&gt; decodeCertificates(final List&lt;String&gt; certificates) {
        final CertificateFactory cf;
        try {
            cf = CertificateFactory.getInstance("X.509");
        } catch (CertificateException e) {
            throw new RuntimeException(e);
        }
        return certificates.stream().map(c -&gt; {
            try {
                return (X509Certificate) cf.generateCertificate(
                        new ByteArrayInputStream(c.getBytes(StandardCharsets.UTF_8))
                );
            } catch (CertificateException e) {
                throw new RuntimeException(e);
            }
        }).collect(Collectors.toList());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-java-client/com/couchbase/client/java/Cluster.html" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
<div id="tabs-3-node-js--panel" class="tabpanel" aria-labelledby="tabs-3-node-js">
<div class="paragraph">
<p>Call the <code>connect()</code> function with a Couchbase Capella endpoint, and a <code>ConnectOptions</code> object containing the username, password and client certificate.</p>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a Couchbase Capella instance over a secure connection with a client certificate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-nodejs hljs" data-lang="nodejs" data-source-url="https://github.com/couchbase/docs-sdk-nodejs/blob/7e0f8507c12c7102b070e99046ce91e6f78ca814/modules/devguide/examples/nodejs/cloud.js">// tag::imports[]
var couchbase = require('couchbase')
// end::imports[]

async function main() {
  // tag::connect[]
  const clusterConnStr = 'couchbases://cb.&lt;your-endpoint&gt;.cloud.couchbase.com'
  const username = 'Administrator'
  const password = 'Password123!'
  const bucketName = 'travel-sample'

  const cluster = await couchbase.connect(clusterConnStr, {
    username: username,
    password: password,
    timeouts: {
      kvTimeout: 10000, // milliseconds
    },
  })
  // end::connect[]

  // tag::bucket[]
  const bucket = cluster.bucket(bucketName)
  // end::bucket[]

  // tag::default-collection[]
  // Get a reference to the default collection, required only for older Couchbase server versions
  const defaultCollection = bucket.defaultCollection()
  // end::default-collection[]

  // tag::collection[]
  const collection = bucket.scope('tenant_agent_00').collection('users')
  // end::collection[]

  // tag::test-doc[]
  const user = {
    type: 'user',
    name: 'Michael',
    email: 'michael123@test.com',
    interests: ['Swimming', 'Rowing'],
  }
  // end::test-doc[]

  // tag::upsert[]
  // Create and store a document
  await collection.upsert('michael123', user)
  // end::upsert[]

  // tag::get[]
  // Load the Document and print it
  // Prints Content and Metadata of the stored Document
  let getResult = await collection.get('michael123')
  console.log('Get Result: ', getResult)
  // end::get[]

  // tag::query[]
  // Perform a SQL++ (N1QL) Query
  const queryResult = await bucket
    .scope('inventory')
    .query('SELECT name FROM `airline` WHERE country=$1 LIMIT 10', {
      parameters: ['United States'],
    })
  console.log('Query Results:')
  queryResult.rows.forEach((row) =&gt; {
    console.log(row)
  })
  // end::query[]
}

// tag::run-main[]
// Run the main function
main()
  .catch((err) =&gt; {
    console.log('ERR:', err)
    process.exit(1)
  })
  .then(process.exit)
// end::run-main[]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-node-client/classes/Cluster.html" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
<div id="tabs-3-python--panel" class="tabpanel" aria-labelledby="tabs-3-python">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Call the <code>Cluster.connect()</code> function with a Couchbase Capella endpoint, and a <code>ClusterOptions</code> object containing a <code>PasswordAutheticator</code>.</p>
</li>
<li>
<p>Provide a username and password to the <code>PasswordAutheticator</code>.</p>
</li>
<li>
<p>Provide a client certificate path to the <code>PasswordAutheticator</code>.</p>
</li>
</ol>
</div>
<hr>
<div class="paragraph">
<p>The example below connects to a Couchbase Capella instance over a secure connection with a client certificate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python" data-source-url="https://github.com/couchbase/docs-sdk-python/blob/01f4c183c94e07bf7c64ff0c3d2532c1df043165/modules/hello-world/examples/cloud.py"># tag::imports[]
from datetime import timedelta

# needed for any cluster connection
from couchbase.auth import PasswordAuthenticator
from couchbase.cluster import Cluster
# needed for options -- cluster, timeout, SQL++ (N1QL) query, etc.
from couchbase.options import (ClusterOptions, ClusterTimeoutOptions,
                               QueryOptions)

# end::imports[]

# tag::connect[]
# Update this to your cluster
endpoint = "--your-instance--.dp.cloud.couchbase.com"
username = "username"
password = "Password123!"
bucket_name = "travel-sample"
# User Input ends here.

# Connect options - authentication
auth = PasswordAuthenticator(username, password)

# Connect options - global timeout opts
timeout_opts = ClusterTimeoutOptions(kv_timeout=timedelta(seconds=10))

# get a reference to our cluster
cluster = Cluster('couchbases://{}'.format(endpoint),
                  ClusterOptions(auth, timeout_options=timeout_opts))

# Wait until the cluster is ready for use.
cluster.wait_until_ready(timedelta(seconds=5))
# end::connect[]

# tag::bucket[]
# get a reference to our bucket
cb = cluster.bucket(bucket_name)
# end::bucket[]

# tag::collection[]
cb_coll = cb.scope("inventory").collection("airline")
# end::collection[]

# tag::upsert-func[]


def upsert_document(doc):
    print("\nUpsert CAS: ")
    try:
        # key will equal: "airline_8091"
        key = doc["type"] + "_" + str(doc["id"])
        result = cb_coll.upsert(key, doc)
        print(result.cas)
    except Exception as e:
        print(e)
# end::upsert-func[]

# tag::get-func[]
# get document function


def get_airline_by_key(key):
    print("\nGet Result: ")
    try:
        result = cb_coll.get(key)
        print(result.content_as[str])
    except Exception as e:
        print(e)
# end::get-func[]

# tag::lookup-func[]
# query for new document by callsign


def lookup_by_callsign(cs):
    print("\nLookup Result: ")
    try:
        sql_query = 'SELECT VALUE name FROM `travel-sample`.inventory.airline WHERE callsign = $1'
        row_iter = cluster.query(
            sql_query,
            QueryOptions(positional_parameters=[cs]))
        for row in row_iter:
            print(row)
    except Exception as e:
        print(e)
# end::lookup-func[]


# tag::test-doc[]
airline = {
    "type": "airline",
    "id": 8091,
    "callsign": "CBS",
    "iata": None,
    "icao": None,
    "name": "Couchbase Airways",
}
# end::test-doc[]

# tag::upsert-invoke[]
upsert_document(airline)
# end::upsert-invoke[]

# tag::get-invoke[]
get_airline_by_key("airline_8091")
# end::get-invoke[]

# tag::lookup-invoke[]
lookup_by_callsign("CBS")
# end::lookup-invoke[]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Click the GitHub button <span class="icon"><i class="fa fa-github"></i></span> to view this code in context.</p>
</div>
<div class="paragraph">
<p>For further details, refer to <a href="https://docs.couchbase.com/sdk-api/couchbase-python-client/api/couchbase.html#cluster-object" target="_blank" rel="noopener">Cluster</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-links"><a class="anchor" href="#related-links"></a>Related Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Reference and explanation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../learn/security/security-overview.html" class="xref page">Security Overview</a></p>
</li>
<li>
<p><a href="../learn/clusters-and-availability/clusters-and-availability.html" class="xref page">Clusters and Availability</a></p>
</li>
<li>
<p><a href="../../../cloud/get-started/connect.html" class="xref page">Couchbase Capella</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Connecting with SDKs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#c-sdk:howtos:managing-connections.adoc" class="xref unresolved">C</a>
| <a href="../../../dotnet-sdk/current/howtos/managing-connections.html" class="xref page">.NET</a>
| <a href="#go-sdk:howtos:managing-connections.adoc" class="xref unresolved">Go</a>
| <a href="../../../java-sdk/current/howtos/managing-connections.html" class="xref page">Java</a>
| <a href="../../../nodejs-sdk/current/howtos/managing-connections.html" class="xref page">Node.js</a>
| <a href="#php-sdk:howtos:managing-connections.adoc" class="xref unresolved">PHP</a>
| <a href="../../../python-sdk/current/howtos/managing-connections.html" class="xref page">Python</a>
| <a href="#ruby-sdk:howtos:managing-connections.adoc" class="xref unresolved">Ruby</a>
| <a href="#scala-sdk:howtos:managing-connections.adoc" class="xref unresolved">Scala</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span> 2024 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Server","components":["server"],"url":"/home/server.html","latestVersions":{"server":"7.2"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab"></script>
<script defer src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
