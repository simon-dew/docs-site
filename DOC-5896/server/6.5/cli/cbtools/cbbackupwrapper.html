<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>cbbackupwrapper | Couchbase Docs (Staging)</title>
    <link rel="canonical" href="https://simon-dew.github.io/docs-site/DOC-5003/server/6.5/cli/cbtools/cbbackupwrapper.html">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="schema.dcterms" href="https://purl.org/dc/terms/">
    <meta name="dcterms.subject" content="server">
    <meta name="dcterms.identifier" content="6.5">
    <meta name="generator" content="Antora 2.0.0">
    <link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar" id="topbar">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://www.couchbase.com"><img src="../../../../_/img/logo.svg" alt="Couchbase"></a>
        <button class="navbar-burger" data-target="topbar-menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
      <div id="topbar-menu" class="navbar-menu">
        <div class="navbar-start">
          <div class="navbar-item has-dropdown">
            <a class="navbar-link" href="https://simon-dew.github.io/docs-site/DOC-5003">Docs</a>
            <div class="navbar-dropdown explore">
              <div class="title">Couchbase Documentation Overview</div>
              <div class="cols">
                <ul>
                  <li class="heading"><a href="../../index.html">Server</a></li>
                  <li><a href="../../../../server/6.5/n1ql/n1ql-language-reference/index.html">N1QL</a></li>
                  <li><a href="../../../../server/6.5/fts/full-text-intro.html">Full Text Search</a></li>
                  <li><a href="../../../../server/6.5/analytics/introduction.html">Analytics</a></li>
                  <li><a href="../../../../server/6.5/eventing/eventing-overview.html">Eventing</a></li>
                  <li><a href="#">Autonomous Operator</a></li>
                </ul>
                <ul>
                  <li class="heading">Mobile</li>
                  <li><a href="#">Lite</a></li>
                  <li><a href="#">Sync Gateway</a></li>
                </ul>
                <ul class="two-cols">
                  <li class="heading"><a href="../../../../server/6.5/sdk/overview.html">SDKs</a></li>
                  <li><a href="#">C</a></li>
                  <li><a href="#">.NET</a></li>
                  <li><a href="#">Go</a></li>
                  <li><a href="#">Java</a></li>
                  <li><a href="#">Node.js</a></li>
                  <li><a href="#">PHP</a></li>
                  <li><a href="#">Python</a></li>
                  <li><a href="#">Scala</a></li>
                </ul>
                <ul>
                  <li class="heading"><a href="../../../../server/6.5/connectors/intro.html">Connectors</a></li>
                  <li><a href="#">Elasticsearch</a></li>
                  <li><a href="../../../../server/6.5/connectors/hadoop-1.2/hadoop.html">Hadoop</a></li>
                  <li><a href="#">Kafka</a></li>
                  <li><a href="#">Spark</a></li>
                  <li><a href="../../../../server/6.5/connectors/odbc-jdbc-drivers.html">ODBC/JDBC</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="navbar-item has-dropdown">
            <a class="navbar-link component" href="../../index.html"><span class="title">server</span> <span class="version">6.5</span></a>
            <div class="navbar-dropdown versions">
              <div class="cols">
                <ul>
                  <li><a class="navbar-item" href="../../../6.0/introduction/intro.html">server 6.0</a></li>
                  <li><a class="navbar-item" href="../../../5.5/index.html">server 5.5</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="navbar-end">
          <div class="navbar-item">
            <a class="btn red-btn" href="https://www.couchbase.com/downloads">Downloads</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body container">
<nav class="nav">
</nav>
<aside class="toc sidebar">
  <div class="toc-menu"></div>
</aside>
<main class="article" data-ceiling="topbar">
  <div class="article-header">
<button class="nav-control"></button>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../../index.html">server</a></li>
    <li class="crumb"><a href="cbbackupwrapper.html">cbbackupwrapper</a></li>
  </ul>
</nav>
<div class="tools" role="navigation">
  <ul>
    <li class="tool edit"><a href="https://github.com/couchbase/couchbase-cli/edit/master/docs/modules/cli/pages/cbtools/cbbackupwrapper.adoc" title="Edit Page" target="_blank" rel="noopener">Edit</a></li>
  </ul>
</div>
  </div>
<article class="doc">
<h1 class="page">cbbackupwrapper</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A wrapper around <code>cbbackup</code> that was made to improve performance for
enterprise user since then <code>cbbackupmgr</code> has been made and should be use
instead of this tool.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synopsis"><a class="anchor" href="#synopsis"></a>SYNOPSIS</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content"><em>cbbackupwrapper</em> [--username &lt;user&gt;] [--password &lt;password&gt;] [--ssl]
                  [--bucket-source &lt;name&gt;] [--single-node]
                  [--mode &lt;full|diff|accu&gt;] [--path &lt;path&gt;] [--port &lt;port&gt;]
                  [--number &lt;num&gt;] [--parallelism &lt;num&gt;] [--verbose]
                  [--extra &lt;options&gt;] [--help] cluster backup_dir</pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="description"><a class="anchor" href="#description"></a>DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>cbbackupwrapper</code> devides the vBuckets between various <code>cbbackup</code> processes to
improve performance.</p>
</div>
<div class="paragraph">
<p>The directory structure is not compatible with <code>cbbackup</code> or <code>cbrestore</code> thus
incremental have to be made with <code>cbbackupwrapper</code> and restores have to be
performed with <code>cbrestorewrapper</code>. The resulting directory structure after
performing a successful backup with <code>cbbackupwrapper</code> will look as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>├── 0-99
│   └── 2019-06-26T151213Z
│       └── 2019-06-26T151213Z-full
│           └── bucket-beer-sample
│               ├── design.json
│               └── node-10.112.193.101%3A8091
├── 100-199
│   └── 2019-06-26T151215Z
│       └── 2019-06-26T151215Z-full
│           └── bucket-beer-sample
│               ├── design.json
│               └── node-10.112.193.101%3A8091
.
.
.
├── 1000-1023
│   └── 2019-06-26T151229Z
│       └── 2019-06-26T151229Z-full
│           └── bucket-beer-sample
│               ├── design.json
│               └── node-10.112.193.101%3A8091
└── logs</pre>
</div>
</div>
<div class="paragraph">
<p>The structure contains a folder for every <code>n</code> vBuckets where <code>n</code> is the
parameter <code>number</code> in the command. Inside each vBucket folder we have a backup
directory containing the data for those vBuckets. Finally we have a log folder
that contains the output of each <code>cbbackup</code> process used to create each vBucket
folder.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="options"><a class="anchor" href="#options"></a>Options</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">-u,--username &lt;user&gt;</dt>
<dd>
<p>Specifies the username of the user executing the command. If you do not have
a user account with permission to execute the command then it will fail with
an unauthorized error.</p>
</dd>
<dt class="hdlist1">-p,--password &lt;password&gt;</dt>
<dd>
<p>Specifies the password of the user executing the command. If you do not have
a user account with permission to execute the command then it will fail with
an unauthorized error.</p>
</dd>
<dt class="hdlist1">-s,--ssl</dt>
<dd>
<p>(Deprecated) Specifies that the connection should use SSL verification. If
this flag is used then SSL will be used but the cluster certificate will not
be verified by the Certificate Authority. This flag is deprecated and not
recommended. If you wish to use SSL encryption it is recommended that you
specify the cluster host name using either <em>couchbases://</em> or <em>https://</em>.
Each of these connection schemes will ensure that the connection is
encrypted with SSL. You may then use either --no-ssl-verify or --cacert in
order to customize how your SSL connection is set up.</p>
</dd>
<dt class="hdlist1">-b,--bucket-source &lt;bucket&gt;</dt>
<dd>
<p>Single named bucket from source cluster to transfer. If the backup directory
only contains a single bucket, then that bucket is automatically used.</p>
</dd>
<dt class="hdlist1">--single-node</dt>
<dd>
<p>Transfer data only from the source data node.</p>
</dd>
<dt class="hdlist1">-m,--mode &lt;full|diff|accu&gt;</dt>
<dd>
<p>Select tha backup mode, the available options are: full, diff, accu.
If an option is not provided it defaults to <code>diff</code>. The <code>full</code> mode will
perform a full backup. The <code>diff</code> mode will perform a differential
incremental backup which backups only the changes since the last full or
incremental backup. The <code>accu</code> mode performs a cumulative incremental backup,
which backs up all changes since the last full backup.</p>
</dd>
<dt class="hdlist1">--path &lt;path&gt;</dt>
<dd>
<p>Specifies the path to the <code>cbbackup</code> executable. Defaults to the current
directory.</p>
</dd>
<dt class="hdlist1">--port &lt;port&gt;</dt>
<dd>
<p>Specifies the bucket port. Defaults to 11210</p>
</dd>
<dt class="hdlist1">-n,--number &lt;num&gt;</dt>
<dd>
<p>Specify the number of vBuckets per process. Defaults to 100</p>
</dd>
<dt class="hdlist1">-p,--parallelism &lt;num&gt;</dt>
<dd>
<p>Number of vBucket backup jobs to run at a time. Defaults to 1.</p>
</dd>
<dt class="hdlist1">-v,--verbose</dt>
<dd>
<p>Verbose logging; more -v&#8217;s provide more verbosity. Max is -vvv</p>
</dd>
<dt class="hdlist1">-x,--extra &lt;options&gt;</dt>
<dd>
<p>Provide extra, uncommon configuration parameters. Comma-separated
key=val pairs</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extras"><a class="anchor" href="#extras"></a>EXTRAS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following are extra, specialized command options with the <code>cbbackupwrapper -x</code> parameter.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. cbbackupwrapper -x options</caption>
<colgroup>
<col style="width: 30.9597%;">
<col style="width: 69.0403%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">-x options</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>backoff_cap=10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum backoff time during the rebalance period.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch_max_bytes=400000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer this # of bytes per batch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch_max_size=1000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer this # of documents per batch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cbb_max_mb=100000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Split backup file on destination cluster if it exceeds the MB.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conflict_resolve=1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By default, disable conflict resolution.</p>
<p class="tableblock">This option doesn&#8217;t work in Couchbase Server versions 4.0 and 4.1 but will be
re-implemented in version 4.1.1 and in subsequent versions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data_only=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For value 1, transfer only data from a backup file or cluster.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>design_doc_only=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For value 1, transfer only design documents from a backup file or cluster.
Default: 0.</p>
<p class="tableblock">Back up only design documents which include view and secondary index
definitions from a cluster or bucket with the option <code>design_doc_only=1</code>.
Restore only design documents with <code>cbrestore -x design_doc_only=1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max_retry=10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max number of sequential retries if the transfer fails.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mcd_compatible=1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For value 0, display extended fields for stdout output.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nmv_retry=1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 or 1, where 1 retries transfer after a NOT_MY_VBUCKET message.
Default: 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>recv_min_bytes=4096</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amount of bytes for every TCP/IP batch transferred.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rehash=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For value 1, rehash the partition id&#8217;s of each item.
This is required when transferring data between clusters with different number
of partitions, such as when transferring data from an Mac OS X server to a
non-Mac OS X cluster.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>report=5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number batches transferred before updating progress bar in console.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>report_full=2000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number batches transferred before emitting progress information in console.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>seqno=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By default, start seqno from beginning.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>try_xwm=1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer documents with metadata.
Default: 1.
Value of 0 is only used when transferring from 1.8.x to 1.8.x.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uncompress=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For value 1, restore data in uncompressed mode.</p>
<p class="tableblock">This option is unsupported.
To create backups with compression, use <code>cbbackupmgr</code>, which is available for
Couchbase Server Enterprise Edition only.
See <a href="#">backup-restore:enterprise-backup-restore.adoc</a>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="example"><a class="anchor" href="#example"></a>EXAMPLE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To perform a backup with <code>cbbackupwrapper</code> run:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbbackupwrapper http://10.112.193.101:8091 ~/backups \
  -u Administrator -p password</pre>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../../_/img/logo.svg" alt="Couchbase">
          </a>
        </div>
        <div class="contact">
          <p class="address">3250 Olcott Street
Santa Clara, CA 95054
United States</p>
          <a href="https://www.couchbase.com/contact" class="btn white-btn">Contact Us</a>
          <a class="tel" href="tel:1-650-417-7500">1-650-417-7500</a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Company</span></li>
          <li><a href="https://www.couchbase.com/about">About</a></li>
          <li><a href="https://www.couchbase.com/leadership">Leadership</a></li>
          <li><a href="https://www.couchbase.com/news-and-press-releases">News &amp; Press</a></li>
          <li><a href="https://www.couchbase.com/careers">Careers</a></li>
          <li><a href="https://www.couchbase.com/resources/events">Events</a></li>
          <li><a href="https://www.couchbase.com/contact">Contact Us</a></li>
          <li><a href="https://www.couchbase.com/request-pricing">Pricing</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Support</span></li>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://www.couchbase.com/services">Professional Services</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support Login</a></li>
          <li><a href="https://learn.couchbase.com/store" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Quicklinks</span></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Online Training</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
          <li><a href="https://www.couchbase.com/nosql-resources/why-nosql">Why NoSQL</a></li>
          <li><a href="https://www.couchbase.com/resources/security">Security</a></li>
          <li><a href="https://www.couchbase.com/resources/gdpr">GDPR</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <a href="https://www.facebook.com/Couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="26.363 116.363 560.215 560.215"><path d="m586.58 209.58c0-48.96-44.252-93.212-93.212-93.212h-373.79c-48.96 0-93.212 44.252-93.212 93.212v373.79c0 48.96 44.252 93.212 93.212 93.212h186.42v-211.85h-68.732v-93.212h68.732v-36.72c0-63.083 47.077-119.58 105.45-119.58h75.323v93.212h-75.323c-8.474 0-17.889 10.357-17.889 25.422v37.662h93.212v93.212h-93.212v211.85h99.803c48.96 0 93.212-44.252 93.212-93.212v-373.79z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://twitter.com/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="32.012 176.622 542.326 437.815"><path d="m574.34 227.46c-19.772 8.474-41.428 15.065-64.025 17.889 22.597-14.123 40.486-35.778 48.96-61.2-21.655 13.182-45.194 21.655-70.615 27.305-20.714-21.655-48.96-34.837-80.972-34.837-61.2 0-111.1 49.902-111.1 111.1 0 8.474 0.942 16.948 2.825 25.422-92.271-5.649-174.18-49.902-229.74-117.69-9.415 16.006-15.065 35.778-15.065 55.551 0 38.603 19.772 72.498 49.902 92.271-17.889-0.942-35.778-5.649-50.843-14.123v0.942c0 53.668 38.603 98.862 89.446 109.22-9.415 2.825-18.831 3.766-29.188 3.766-7.532 0-14.123-0.942-20.714-1.883 14.123 44.252 55.551 76.265 103.57 77.206-37.662 30.129-85.68 48.018-138.41 48.018-9.415 0-17.889-0.941-26.363-1.883 48.96 32.012 107.34 49.902 170.42 49.902 204.31 0 316.36-169.48 316.36-316.36v-14.123c21.656-14.125 40.487-33.897 55.551-56.494z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://www.linkedin.com/company/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="31.071 119.188 539.537 540.443"><path d="m531.97 119.19h-461.35c-21.655 0-39.545 16.948-39.545 38.603v463.24c0 21.655 17.889 38.603 39.545 38.603h460.41c21.655 0 39.545-16.948 39.545-38.603v-463.24c0.942-21.656-16.947-38.603-38.603-38.603zm-337.07 451.94h-81.914v-243.86h81.914v243.86zm-40.486-276.81c-28.246 0-46.135-18.831-46.135-42.369s17.889-42.369 46.135-42.369 45.194 17.889 45.194 42.369c0.942 23.538-16.948 42.369-45.194 42.369zm335.19 276.81h-81.914v-129.93c0-32.954-12.24-55.551-41.428-55.551-22.597 0-35.778 15.065-41.428 30.129-1.883 5.649-2.825 12.24-2.825 19.772v136.52h-81.914s0.942-221.26 0-243.86h81.914v34.837c11.298-16.948 30.129-40.486 73.44-40.486 53.668 0 94.154 34.837 94.154 110.16l1e-3 138.41zm-168.54-208.08s0.941-0.941 0 0z"/></svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <span>2019 COUCHBASE All rights reserved.</span>
      <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
      <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
      <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
      <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
    </div>
  </div>
</footer>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
