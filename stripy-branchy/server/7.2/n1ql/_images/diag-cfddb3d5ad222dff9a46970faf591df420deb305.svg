<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="471px" preserveAspectRatio="none" style="width:576px;height:471px;background:#FFFFFF;" version="1.1" viewBox="0 0 576 471" width="576px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="459.5859" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="418" x="152" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="190" x="263.5" y="18.0669">Couchbase Server Cluster</text><rect fill="#008080" height="270.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="217.5" y="106.6953"/><rect fill="#00BFFF" height="37" style="stroke:#181818;stroke-width:1.0;" width="10" x="362.5" y="208.2266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="45" x2="45" y1="60.4297" y2="427.2891"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="222" x2="222" y1="60.4297" y2="427.2891"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="367" x2="367" y1="60.4297" y2="427.2891"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="504" x2="504" y1="60.4297" y2="427.2891"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="15" y="29.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="22" y="49.1279">Clients</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="15" y="426.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="22" y="446.2842">Clients</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="170" y="25.1328"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="166" y="29.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="173" y="49.1279">Query Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="170" y="426.2891"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="166" y="430.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="173" y="450.2842">Query Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="317" y="25.1328"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="313" y="29.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="320" y="49.1279">Index Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="317" y="426.2891"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="313" y="430.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="320" y="450.2842">Index Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="456" y="25.1328"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="452" y="29.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="459" y="49.1279">Data Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="456" y="426.2891"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="452" y="430.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="459" y="450.2842">Data Service</text><rect fill="#008080" height="270.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="217.5" y="106.6953"/><rect fill="#00BFFF" height="37" style="stroke:#181818;stroke-width:1.0;" width="10" x="362.5" y="208.2266"/><polygon fill="#181818" points="205.5,102.6953,215.5,106.6953,205.5,110.6953,209.5,106.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="45.5" x2="211.5" y1="106.6953" y2="106.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="52.5" y="86.4966">Submit the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="52.5" y="101.6294">query</text><line style="stroke:none;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="227.5" x2="269.5" y1="150.9609" y2="150.9609"/><line style="stroke:none;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="269.5" x2="269.5" y1="150.9609" y2="163.9609"/><line style="stroke:none;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="228.5" x2="269.5" y1="163.9609" y2="163.9609"/><polygon fill="none" points="238.5,159.9609,228.5,163.9609,238.5,167.9609,234.5,163.9609" style="stroke:none;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="234.5" y="130.7622">Parse, analyze,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="234.5" y="145.895">create plan</text><polygon fill="#181818" points="350.5,204.2266,360.5,208.2266,350.5,212.2266,354.5,208.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="227.5" x2="356.5" y1="208.2266" y2="208.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="234.5" y="188.0278">Scan request;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="234.5" y="203.1606">index filters</text><polygon fill="#181818" points="238.5,241.2266,228.5,245.2266,238.5,249.2266,234.5,245.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="232.5" x2="366.5" y1="245.2266" y2="245.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="249.5" y="258.2935">Get qualified doc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="249.5" y="273.4263">keys and index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="249.5" y="288.5591">keys</text><line style="stroke:none;stroke-width:1.0;" x1="227.5" x2="269.5" y1="352.0234" y2="352.0234"/><line style="stroke:none;stroke-width:1.0;" x1="269.5" x2="269.5" y1="352.0234" y2="365.0234"/><line style="stroke:none;stroke-width:1.0;" x1="228.5" x2="269.5" y1="365.0234" y2="365.0234"/><polygon fill="none" points="238.5,361.0234,228.5,365.0234,238.5,369.0234,234.5,365.0234" style="stroke:none;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="234.5" y="316.6919">Evaluate;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="234.5" y="331.8247">documents to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="234.5" y="346.9575">results</text><polygon fill="#181818" points="56.5,373.0234,46.5,377.0234,56.5,381.0234,52.5,377.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="50.5" x2="221.5" y1="377.0234" y2="377.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="177.5" y="390.0903">Query</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="177.5" y="405.2231">result</text><!--MD5=[7fb1ab39d57b6df016f32431eca6a895]
@startuml
skinparam maxMessageSize 125
skinparam roundcorner 5
skinparam responseMessageBelowArrow true
skinparam sequenceMessageAlign direction
skinparam ParticipantPadding 10
skinparam BoxPadding 60
skinparam box {
BackgroundColor PaleGreen
ArrowColor SeaGreen
BorderColor SpringGreen
}

participant Clients

box Couchbase Server Cluster #White
collections "Query Service" as Query
collections "Index Service" as Index
collections "Data Service" as Data
end box

' autonumber "##."
Clients -> Query: Submit the\nquery
activate Query #teal

Query -[#transparent]-> Query: Parse, analyze, create plan

Query -> Index: Scan request; index filters
activate Index #deepskyblue
|||
Index -> Query: Get qualified doc keys and index keys
deactivate Index


Query -[#transparent]> Query: Evaluate; documents to results

Query -> Clients: Query\nresult
deactivate Query
@enduml

@startuml
skinparam maxMessageSize 125
skinparam roundcorner 5
skinparam responseMessageBelowArrow true
skinparam sequenceMessageAlign direction
skinparam ParticipantPadding 10
skinparam BoxPadding 60
skinparam box {
BackgroundColor PaleGreen
ArrowColor SeaGreen
BorderColor SpringGreen
}

participant Clients

box Couchbase Server Cluster #White
collections "Query Service" as Query
collections "Index Service" as Index
collections "Data Service" as Data
end box

Clients -> Query: Submit the\nquery
activate Query #teal

Query -[#transparent]-> Query: Parse, analyze, create plan

Query -> Index: Scan request; index filters
activate Index #deepskyblue
|||
Index -> Query: Get qualified doc keys and index keys
deactivate Index


Query -[#transparent]> Query: Evaluate; documents to results

Query -> Clients: Query\nresult
deactivate Query
@enduml

PlantUML version 1.2022.12(Sun Oct 23 18:12:26 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>