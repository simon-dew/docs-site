<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="478px" preserveAspectRatio="none" style="width:522px;height:478px;background:#FFFFFF;" version="1.1" viewBox="0 0 522 478" width="522px" zoomAndPan="magnify"><defs/><g><rect fill="#008080" height="317.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="179.5" y="86.5625"/><rect fill="#00BFFF" height="69.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="349.5" y="203.2266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="49" x2="49" y1="40.2969" y2="439.4219"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="184" x2="184" y1="40.2969" y2="439.4219"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="354" x2="354" y1="40.2969" y2="439.4219"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89" x="5" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="12" y="28.9951">Application</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89" x="5" y="438.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="12" y="458.417">Application</text><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="107" x="133" y="5"/><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="107" x="129" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="136" y="28.9951">Query Engine</text><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="107" x="133" y="438.4219"/><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="107" x="129" y="442.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="136" y="462.417">Query Engine</text><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="65" x="324" y="5"/><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="65" x="320" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="327" y="28.9951">Indexer</text><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="65" x="324" y="438.4219"/><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="65" x="320" y="442.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="327" y="462.417">Indexer</text><rect fill="#008080" height="317.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="179.5" y="86.5625"/><rect fill="#00BFFF" height="69.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="349.5" y="203.2266"/><polygon fill="#181818" points="167.5,82.5625,177.5,86.5625,167.5,90.5625,171.5,86.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="49.5" x2="173.5" y1="86.5625" y2="86.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="56.5" y="66.3638">SELECT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="56.5" y="81.4966">statement</text><line style="stroke:none;stroke-width:1.0;" x1="189.5" x2="231.5" y1="145.9609" y2="145.9609"/><line style="stroke:none;stroke-width:1.0;" x1="231.5" x2="231.5" y1="145.9609" y2="158.9609"/><line style="stroke:none;stroke-width:1.0;" x1="190.5" x2="231.5" y1="158.9609" y2="158.9609"/><polygon fill="none" points="200.5,154.9609,190.5,158.9609,200.5,162.9609,196.5,158.9609" style="stroke:none;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="196.5" y="110.6294">Analyze query; send</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="196.5" y="125.7622">scan, grouping and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="196.5" y="140.895">aggregation request</text><polygon fill="#181818" points="337.5,199.2266,347.5,203.2266,337.5,207.2266,341.5,203.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="189.5" x2="343.5" y1="203.2266" y2="203.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="196.5" y="183.0278">Scan, grouping and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="196.5" y="198.1606">aggregate request</text><line style="stroke:none;stroke-width:1.0;" x1="359.5" x2="401.5" y1="247.4922" y2="247.4922"/><line style="stroke:none;stroke-width:1.0;" x1="401.5" x2="401.5" y1="247.4922" y2="260.4922"/><line style="stroke:none;stroke-width:1.0;" x1="360.5" x2="401.5" y1="260.4922" y2="260.4922"/><polygon fill="none" points="370.5,256.4922,360.5,260.4922,370.5,264.4922,366.5,260.4922" style="stroke:none;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="366.5" y="227.2935">Execute scan, grouping</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="366.5" y="242.4263">and aggregation</text><polygon fill="#181818" points="200.5,268.4922,190.5,272.4922,200.5,276.4922,196.5,272.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="194.5" x2="353.5" y1="272.4922" y2="272.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="215.5" y="285.5591">Projection of results</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="215.5" y="300.6919">from scan, grouping</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="215.5" y="315.8247">and aggregation</text><line style="stroke:none;stroke-width:1.0;" x1="189.5" x2="231.5" y1="379.2891" y2="379.2891"/><line style="stroke:none;stroke-width:1.0;" x1="231.5" x2="231.5" y1="379.2891" y2="392.2891"/><line style="stroke:none;stroke-width:1.0;" x1="190.5" x2="231.5" y1="392.2891" y2="392.2891"/><polygon fill="none" points="200.5,388.2891,190.5,392.2891,200.5,396.2891,196.5,392.2891" style="stroke:none;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="196.5" y="343.9575">Perform group merge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="196.5" y="359.0903">if required; project the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="196.5" y="374.2231">results</text><polygon fill="#181818" points="60.5,400.2891,50.5,404.2891,60.5,408.2891,56.5,404.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54.5" x2="183.5" y1="404.2891" y2="404.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="71.5" y="417.356">Result projection</text><!--MD5=[0801216f4146f30727f7a04a5f3b0bd8]
@startuml
skinparam maxMessageSize 150
skinparam responseMessageBelowArrow true
skinparam sequenceMessageAlign direction

' title Query Execution with Grouping and Aggregation Pushdown

participant Application

collections "Query Engine" as Query
collections "Indexer" as Index

Application -> Query: SELECT\nstatement
activate Query #teal

Query -[#transparent]> Query: Analyze query; send scan, grouping and aggregation request
Query -> Index: Scan, grouping and aggregate request
activate Index #deepskyblue

Index -[#transparent]> Index: Execute scan, grouping and aggregation
Index -> Query: Projection of results from scan, grouping and aggregation
deactivate Index

Query -[#transparent]> Query: Perform group merge, if required; project the results
Query -> Application: Result projection
deactivate Query
@enduml

@startuml
skinparam maxMessageSize 150
skinparam responseMessageBelowArrow true
skinparam sequenceMessageAlign direction


participant Application

collections "Query Engine" as Query
collections "Indexer" as Index

Application -> Query: SELECT\nstatement
activate Query #teal

Query -[#transparent]> Query: Analyze query; send scan, grouping and aggregation request
Query -> Index: Scan, grouping and aggregate request
activate Index #deepskyblue

Index -[#transparent]> Index: Execute scan, grouping and aggregation
Index -> Query: Projection of results from scan, grouping and aggregation
deactivate Index

Query -[#transparent]> Query: Perform group merge, if required; project the results
Query -> Application: Result projection
deactivate Query
@enduml

PlantUML version 1.2022.12(Sun Oct 23 18:12:26 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>