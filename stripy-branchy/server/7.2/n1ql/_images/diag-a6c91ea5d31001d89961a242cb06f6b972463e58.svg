<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="746px" preserveAspectRatio="none" style="width:654px;height:746px;background:#FFFFFF;" version="1.1" viewBox="0 0 654 746" width="654px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="734.1797" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="418" x="230" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="190" x="341.5" y="18.0669">Couchbase Server Cluster</text><rect fill="#008080" height="383.8594" style="stroke:#181818;stroke-width:1.0;" width="10" x="295.5" y="187.2266"/><rect fill="#00BFFF" height="37" style="stroke:#181818;stroke-width:1.0;" width="10" x="440.5" y="288.7578"/><rect fill="#191970" height="37" style="stroke:#181818;stroke-width:1.0;" width="10" x="577" y="417.4219"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="123" x2="123" y1="60.4297" y2="701.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="300" x2="300" y1="60.4297" y2="701.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="445" x2="445" y1="60.4297" y2="701.8828"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="582" x2="582" y1="60.4297" y2="701.8828"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="93" y="29.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="100" y="49.1279">Clients</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61" x="93" y="700.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="100" y="720.8779">Clients</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="248" y="25.1328"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="244" y="29.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="251" y="49.1279">Query Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="248" y="700.8828"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="244" y="704.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="251" y="724.8779">Query Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="395" y="25.1328"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="391" y="29.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="398" y="49.1279">Index Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="395" y="700.8828"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="391" y="704.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="398" y="724.8779">Index Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="534" y="25.1328"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="530" y="29.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="537" y="49.1279">Data Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="534" y="700.8828"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="530" y="704.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="537" y="724.8779">Data Service</text><rect fill="#008080" height="383.8594" style="stroke:#181818;stroke-width:1.0;" width="10" x="295.5" y="187.2266"/><rect fill="#00BFFF" height="37" style="stroke:#181818;stroke-width:1.0;" width="10" x="440.5" y="288.7578"/><rect fill="#191970" height="37" style="stroke:#181818;stroke-width:1.0;" width="10" x="577" y="417.4219"/><path d="M5,77.9297 L5,142.9297 A2.5,2.5 0 0 0 7.5,145.4297 L239.5,145.4297 A2.5,2.5 0 0 0 242,142.9297 L242,85.4297 L232,75.4297 L7.5,75.4297 A2.5,2.5 0 0 0 5,77.9297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M232,75.4297 L232,84.1797 A1.25,1.25 0 0 0 233.25,85.4297 L242,85.4297 L232,75.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="11" y="92.4966">SELECT airportname, city</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="11" y="107.6294">FROM airport</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="11" y="122.7622">WHERE tz = "America/Anchorage"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="11" y="137.895">AND geo.alt &gt;= 2100;</text><polygon fill="#181818" points="283.5,183.2266,293.5,187.2266,283.5,191.2266,287.5,187.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="123.5" x2="289.5" y1="187.2266" y2="187.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="130.5" y="167.0278">Submit the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="130.5" y="182.1606">query</text><line style="stroke:none;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="305.5" x2="347.5" y1="231.4922" y2="231.4922"/><line style="stroke:none;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347.5" x2="347.5" y1="231.4922" y2="244.4922"/><line style="stroke:none;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="306.5" x2="347.5" y1="244.4922" y2="244.4922"/><polygon fill="none" points="316.5,240.4922,306.5,244.4922,316.5,248.4922,312.5,244.4922" style="stroke:none;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="312.5" y="211.2935">Parse, analyze,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="312.5" y="226.4263">create plan</text><polygon fill="#181818" points="428.5,284.7578,438.5,288.7578,428.5,292.7578,432.5,288.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="305.5" x2="434.5" y1="288.7578" y2="288.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="312.5" y="268.5591">Scan request;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="312.5" y="283.6919">index filters</text><polygon fill="#181818" points="316.5,321.7578,306.5,325.7578,316.5,329.7578,312.5,325.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="310.5" x2="444.5" y1="325.7578" y2="325.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="327.5" y="338.8247">Get qualified doc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="327.5" y="353.9575">keys and index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="327.5" y="369.0903">keys</text><polygon fill="#181818" points="565,413.4219,575,417.4219,565,421.4219,569,417.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="305.5" x2="571" y1="417.4219" y2="417.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="312.5" y="397.2231">Fetch request, doc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="312.5" y="412.356">keys</text><polygon fill="#181818" points="316.5,450.4219,306.5,454.4219,316.5,458.4219,312.5,454.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="310.5" x2="581" y1="454.4219" y2="454.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="503" y="467.4888">Fetch the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="503" y="482.6216">documents</text><line style="stroke:none;stroke-width:1.0;" x1="305.5" x2="347.5" y1="546.0859" y2="546.0859"/><line style="stroke:none;stroke-width:1.0;" x1="347.5" x2="347.5" y1="546.0859" y2="559.0859"/><line style="stroke:none;stroke-width:1.0;" x1="306.5" x2="347.5" y1="559.0859" y2="559.0859"/><polygon fill="none" points="316.5,555.0859,306.5,559.0859,316.5,563.0859,312.5,559.0859" style="stroke:none;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="312.5" y="510.7544">Evaluate;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="312.5" y="525.8872">documents to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="312.5" y="541.02">results</text><polygon fill="#181818" points="134.5,567.0859,124.5,571.0859,134.5,575.0859,130.5,571.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="128.5" x2="299.5" y1="571.0859" y2="571.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="255.5" y="584.1528">Query</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="255.5" y="599.2856">result</text><path d="M22,618.8516 L22,683.8516 A2.5,2.5 0 0 0 24.5,686.3516 L222.5,686.3516 A2.5,2.5 0 0 0 225,683.8516 L225,626.3516 L215,616.3516 L24.5,616.3516 A2.5,2.5 0 0 0 22,618.8516 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M215,616.3516 L215,625.1016 A1.25,1.25 0 0 0 216.25,626.3516 L225,626.3516 L215,616.3516 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="28" y="633.4185">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="36" y="648.5513">"airportname": "Analtuvuk",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="36" y="663.6841">"city": "Anaktuvuk Pass"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="28" y="678.8169">}</text><!--MD5=[d0a08ad1276431ceda7df27f77dde248]
@startuml
skinparam maxMessageSize 125
skinparam roundcorner 5
skinparam responseMessageBelowArrow true
skinparam sequenceMessageAlign direction
skinparam ParticipantPadding 10
skinparam BoxPadding 60
skinparam box {
BackgroundColor PaleGreen
ArrowColor SeaGreen
BorderColor SpringGreen
}

participant Clients

box Couchbase Server Cluster #White
collections "Query Service" as Query
collections "Index Service" as Index
collections "Data Service" as Data
end box

' autonumber "##."
' tag::example[]
note over Clients
  SELECT airportname, city
  FROM airport
  WHERE tz = "America/Anchorage"
  AND geo.alt >= 2100;
end note
' end::example[]
Clients -> Query: Submit the\nquery
activate Query #teal

Query -[#transparent]-> Query: Parse, analyze, create plan

Query -> Index: Scan request; index filters
activate Index #deepskyblue
|||
Index -> Query: Get qualified doc keys and index keys
deactivate Index

' tag::fetch[]
Query -> Data: Fetch request, doc keys
activate Data #midnightblue
|||
Data -> Query: Fetch the\ndocuments
deactivate Data
' end::fetch[]

Query -[#transparent]> Query: Evaluate; documents to results

Query -> Clients: Query\nresult
deactivate Query
' tag::example[]
note over Clients
  {
    "airportname": "Analtuvuk",
    "city": "Anaktuvuk Pass"
  }
end note
' end::example[]
@enduml

@startuml
skinparam maxMessageSize 125
skinparam roundcorner 5
skinparam responseMessageBelowArrow true
skinparam sequenceMessageAlign direction
skinparam ParticipantPadding 10
skinparam BoxPadding 60
skinparam box {
BackgroundColor PaleGreen
ArrowColor SeaGreen
BorderColor SpringGreen
}

participant Clients

box Couchbase Server Cluster #White
collections "Query Service" as Query
collections "Index Service" as Index
collections "Data Service" as Data
end box

note over Clients
  SELECT airportname, city
  FROM airport
  WHERE tz = "America/Anchorage"
  AND geo.alt >= 2100;
end note
Clients -> Query: Submit the\nquery
activate Query #teal

Query -[#transparent]-> Query: Parse, analyze, create plan

Query -> Index: Scan request; index filters
activate Index #deepskyblue
|||
Index -> Query: Get qualified doc keys and index keys
deactivate Index

Query -> Data: Fetch request, doc keys
activate Data #midnightblue
|||
Data -> Query: Fetch the\ndocuments
deactivate Data

Query -[#transparent]> Query: Evaluate; documents to results

Query -> Clients: Query\nresult
deactivate Query
note over Clients
  {
    "airportname": "Analtuvuk",
    "city": "Anaktuvuk Pass"
  }
end note
@enduml

PlantUML version 1.2022.12(Sun Oct 23 18:12:26 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>