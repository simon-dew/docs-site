<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="475px" preserveAspectRatio="none" style="width:558px;height:475px;background:#FFFFFF;" version="1.1" viewBox="0 0 558 475" width="558px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="87.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="194.5" y="112.4297"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="349.5" y="141.5625"/><rect fill="#FFFFFF" height="87.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="349.5" y="282.2266"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="509.5" y="311.3594"/><rect fill="none" height="162.7969" style="stroke:#000000;stroke-width:1.5;" width="542" x="10" y="214.8281"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="36" x2="36" y1="81.2969" y2="394.625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="199.5" x2="199.5" y1="81.2969" y2="394.625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="354" x2="354" y1="81.2969" y2="394.625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="514" x2="514" y1="81.2969" y2="394.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="20" y="77.9951">Dev</text><ellipse cx="36.5" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M36.5,21.5 L36.5,48.5 M23.5,29.5 L49.5,29.5 M36.5,48.5 L23.5,63.5 M36.5,48.5 L49.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="20" y="406.6201">Dev</text><ellipse cx="36.5" cy="418.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M36.5,426.4219 L36.5,453.4219 M23.5,434.4219 L49.5,434.4219 M36.5,453.4219 L23.5,468.4219 M36.5,453.4219 L49.5,468.4219 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="162.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="169.5" y="69.9951">JSEngine</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="162.5" y="393.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="169.5" y="413.6201">JSEngine</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="303" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="310" y="69.9951">QueryEngine</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="303" y="393.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="310" y="413.6201">QueryEngine</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="487" y="77.9951">Bucket</text><path d="M496.5,29 C496.5,19 514.5,19 514.5,19 C514.5,19 532.5,19 532.5,29 L532.5,55 C532.5,65 514.5,65 514.5,65 C514.5,65 496.5,65 496.5,55 L496.5,29 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M496.5,29 C496.5,39 514.5,39 514.5,39 C514.5,39 532.5,39 532.5,29 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="487" y="406.6201">Bucket</text><path d="M496.5,419.9219 C496.5,409.9219 514.5,409.9219 514.5,409.9219 C514.5,409.9219 532.5,409.9219 532.5,419.9219 L532.5,445.9219 C532.5,455.9219 514.5,455.9219 514.5,455.9219 C514.5,455.9219 496.5,455.9219 496.5,445.9219 L496.5,419.9219 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M496.5,419.9219 C496.5,429.9219 514.5,429.9219 514.5,429.9219 C514.5,429.9219 532.5,429.9219 532.5,419.9219 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#FFFFFF" height="87.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="194.5" y="112.4297"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="349.5" y="141.5625"/><rect fill="#FFFFFF" height="87.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="349.5" y="282.2266"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="509.5" y="311.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="192.5" x2="182.5" y1="112.4297" y2="108.4297"/><line style="stroke:#181818;stroke-width:1.0;" x1="192.5" x2="182.5" y1="112.4297" y2="116.4297"/><line style="stroke:#181818;stroke-width:1.0;" x1="36.5" x2="193.5" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="43.5" y="107.3638">JS: var q = select …</text><line style="stroke:#181818;stroke-width:1.0;" x1="347.5" x2="337.5" y1="141.5625" y2="137.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="347.5" x2="337.5" y1="141.5625" y2="145.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="204.5" x2="348.5" y1="141.5625" y2="141.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="211.5" y="136.4966">SQL++(…) call</text><line style="stroke:#181818;stroke-width:1.0;" x1="205.5" x2="215.5" y1="170.6953" y2="166.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="205.5" x2="215.5" y1="170.6953" y2="174.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="204.5" x2="353.5" y1="170.6953" y2="170.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="221.5" y="165.6294">return query</text><line style="stroke:#181818;stroke-width:1.0;" x1="37.5" x2="47.5" y1="199.8281" y2="195.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="37.5" x2="47.5" y1="199.8281" y2="203.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="36.5" x2="198.5" y1="199.8281" y2="199.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="53.5" y="194.7622">return q</text><path d="M10,214.8281 L87,214.8281 L87,221.9609 L77,231.9609 L10,231.9609 L10,214.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="162.7969" style="stroke:#000000;stroke-width:1.5;" width="542" x="10" y="214.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="25" y="227.895">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="140" x="102" y="227.0386">[Every document in q]</text><line style="stroke:#181818;stroke-width:1.0;" x1="197.5" x2="187.5" y1="253.0938" y2="249.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="197.5" x2="187.5" y1="253.0938" y2="257.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="36.5" x2="198.5" y1="253.0938" y2="253.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="43.5" y="248.0278">operate on document</text><line style="stroke:#181818;stroke-width:1.0;" x1="347.5" x2="337.5" y1="282.2266" y2="278.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="347.5" x2="337.5" y1="282.2266" y2="286.2266"/><line style="stroke:#181818;stroke-width:1.0;" x1="199.5" x2="348.5" y1="282.2266" y2="282.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="206.5" y="277.1606">get document</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="497.5" y1="311.3594" y2="307.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="497.5" y1="311.3594" y2="315.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="359.5" x2="508.5" y1="311.3594" y2="311.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="366.5" y="306.2935">get document</text><line style="stroke:#181818;stroke-width:1.0;" x1="360.5" x2="370.5" y1="340.4922" y2="336.4922"/><line style="stroke:#181818;stroke-width:1.0;" x1="360.5" x2="370.5" y1="340.4922" y2="344.4922"/><line style="stroke:#181818;stroke-width:1.0;" x1="359.5" x2="513.5" y1="340.4922" y2="340.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="376.5" y="335.4263">retrieved document</text><line style="stroke:#181818;stroke-width:1.0;" x1="200.5" x2="210.5" y1="369.625" y2="365.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="200.5" x2="210.5" y1="369.625" y2="373.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="199.5" x2="353.5" y1="369.625" y2="369.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="216.5" y="364.5591">retrieved document</text><!--MD5=[51954c5cfdedee644e55329e62b042ce]
@startuml
actor Dev
 participant JSEngine
 participant QueryEngine
 database Bucket

 Dev ->> JSEngine: JS: var q = select …
 activate JSEngine
 JSEngine ->> QueryEngine : SQL++(…) call
 activate QueryEngine
 QueryEngine ->> JSEngine  : return query
 deactivate QueryEngine
 JSEngine ->> Dev : return q
 deactivate JSEngine

    loop Every document in q
      Dev ->> JSEngine   : operate on document
      JSEngine ->> QueryEngine ++ : get document
      QueryEngine ->> Bucket ++ : get document
      Bucket ->> QueryEngine - - : retrieved document
      QueryEngine ->> JSEngine - - : retrieved document
    end
@enduml

PlantUML version 1.2022.12(Sun Oct 23 18:12:26 GMT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>