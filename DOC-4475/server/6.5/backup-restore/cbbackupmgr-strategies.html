<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>cbbackupmgr strategies | Couchbase Docs (Staging)</title>
    <link rel="canonical" href="https://simon-dew.github.io/docs-site/DOC-4475/server/6.5/backup-restore/cbbackupmgr-strategies.html">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="schema.dcterms" href="https://purl.org/dc/terms/">
    <meta name="dcterms.subject" content="server">
    <meta name="dcterms.identifier" content="6.5">
    <meta name="generator" content="Antora 2.0.0">
    <link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar" id="topbar">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://www.couchbase.com"><img src="../../../_/img/logo.svg" alt="Couchbase"></a>
        <button class="navbar-burger" data-target="topbar-menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
      <div id="topbar-menu" class="navbar-menu">
        <div class="navbar-start">
          <div class="navbar-item has-dropdown">
            <a class="navbar-link" href="https://simon-dew.github.io/docs-site/DOC-4475">Docs</a>
            <div class="navbar-dropdown explore">
              <div class="title">Couchbase Documentation Overview</div>
              <div class="cols">
                <ul>
                  <li class="heading"><a href="../../../server/6.0/introduction/intro.html">Server</a></li>
                  <li><a href="../../../server/6.0/n1ql/n1ql-language-reference/index.html">N1QL</a></li>
                  <li><a href="../../../server/6.0/fts/full-text-intro.html">Full Text Search</a></li>
                  <li><a href="../../../server/6.0/analytics/introduction.html">Analytics</a></li>
                  <li><a href="../../../server/6.0/eventing/eventing-overview.html">Eventing</a></li>
                  <li><a href="#">Autonomous Operator</a></li>
                </ul>
                <ul>
                  <li class="heading">Mobile</li>
                  <li><a href="#">Lite</a></li>
                  <li><a href="#">Sync Gateway</a></li>
                </ul>
                <ul class="two-cols">
                  <li class="heading"><a href="../../../server/6.0/sdk/overview.html">SDKs</a></li>
                  <li><a href="../../../c-sdk/2.10/start-using-sdk.html">C</a></li>
                  <li><a href="../../../dotnet-sdk/2.7/start-using-sdk.html">.NET</a></li>
                  <li><a href="../../../go-sdk/1.5/start-using-sdk.html">Go</a></li>
                  <li><a href="../../../java-sdk/2.7/start-using-sdk.html">Java</a></li>
                  <li><a href="../../../nodejs-sdk/2.6/start-using-sdk.html">Node.js</a></li>
                  <li><a href="../../../php-sdk/2.6/start-using-sdk.html">PHP</a></li>
                  <li><a href="../../../python-sdk/2.5/start-using-sdk.html">Python</a></li>
                </ul>
                <ul>
                  <li class="heading"><a href="../../../server/6.0/connectors/intro.html">Connectors</a></li>
                  <li><a href="#">Elasticsearch</a></li>
                  <li><a href="../../../server/6.0/connectors/hadoop-1.2/hadoop.html">Hadoop</a></li>
                  <li><a href="#">Kafka</a></li>
                  <li><a href="#">Spark</a></li>
                  <li><a href="#">Talend</a></li>
                  <li><a href="../../../server/6.0/connectors/odbc-jdbc-drivers.html">ODBC/JDBC</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="navbar-item has-dropdown">
            <a class="navbar-link component" href="../index.html"><span class="title">server</span> <span class="version">6.5</span></a>
            <div class="navbar-dropdown versions">
              <div class="cols">
                <ul>
                  <li><a class="navbar-item" href="../../6.0/introduction/intro.html">server 6.0</a></li>
                  <li><a class="navbar-item" href="../../5.5/index.html">server 5.5</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="navbar-end">
          <div class="navbar-item">
            <a class="btn red-btn" href="https://www.couchbase.com/downloads">Downloads</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body container">
<nav class="nav">
</nav>
<aside class="toc sidebar">
  <div class="toc-menu"></div>
</aside>
<main class="article" data-ceiling="topbar">
  <div class="article-header">
<button class="nav-control"></button>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../index.html">server</a></li>
    <li class="crumb"><a href="cbbackupmgr-strategies.html">cbbackupmgr strategies</a></li>
  </ul>
</nav>
<div class="tools" role="navigation">
  <ul>
    <li class="tool edit"><a href="https://github.com/couchbase/backup/edit/master/docs/modules/backup-restore/pages/cbbackupmgr-strategies.adoc" title="Edit Page" target="_blank" rel="noopener">Edit</a></li>
  </ul>
</div>
  </div>
<article class="doc">
<h1 class="page">cbbackupmgr strategies</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Recommended backup strategies for cbbackupmgr</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="description"><a class="anchor" href="#description"></a>DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Backing up data is an important part of any production database deployment. In
this section we will go through the most common cbbackupmgr backup strategies
and also provide recommendations for how and where to run cbbackupmgr. To
describe each strategy we will assume that users will want to back up their
cluster daily, but all strategies can be easily modified to accommodate
different backup intervals.</p>
</div>
<div class="paragraph">
<p>In the strategies below we will refer to taking a full backup even though
cbbackupmgr is an incremental-only tool. When this term is used we are referring
to the first backup taken in a backup repository.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="periodic-merge"><a class="anchor" href="#periodic-merge"></a>PERIODIC MERGE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The recommended backup strategy for cbbackupmgr is the Periodic Merge strategy.
This backup strategy is intended to have the lowest cluster overhead and will
require the least amount of time. The periodic merge strategy takes full
advantage the fact that cbbackupmgr only takes incremental backups as well as
its ability to merge incremental backup. In a Periodic Merge strategy we would
take an incremental backup each day as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Sunday:    Config Backup Repo    (0 backups in backup repo)
Sunday:    Backup 1              (1 backup in backup repo)
Monday:    Backup 2              (2 backups in backup repo)
Tuesday:   Backup 3              (3 backups in backup repo)
Wednesday: Backup 4              (4 backups in backup repo)
Thursday:  Backup 5              (5 backups in backup repo)
Friday:    Backup 6              (6 backups in backup repo)
Saturday:  Backup 7              (7 backups in backup repo)
Sunday:    Backup 8              (8 backups in backup repo)
Sunday:    Merge 1-7             (2 backups in backup repo)
Monday:    Backup 9              (3 backups in backup repo)
Tuesday:   Backup 10             (4 backups in backup repo)
Wednesday: Backup 11             (5 backups in backup repo)
Thursday:  Backup 12             (6 backups in backup repo)
Friday:    Backup 13             (7 backups in backup repo)
Saturday:  Backup 14             (8 backups in backup repo)
Sunday:    Backup 15             (9 backups in backup repo)
Sunday:    Merge 7-14            (2 backups in backup repo)</pre>
</div>
</div>
<div class="paragraph">
<p>Each day we increase the amount of incremental backups in the backup repository,
but in order to reclaim space we merge the incremental backups from the previous
week on Sundays in order to reclaim space. This strategy is effective because
incremental backups are the quickest way to back up a cluster and when we need
to consolidate the data we can do so without using any cluster resource. This
strategy is useful because as data grows it may become infeasible to back up the
entire cluster in a reasonable amount of time. By always taking incremental
backups and merging at a later time, we can completely avoid full cluster
backups.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fullincremental-approach"><a class="anchor" href="#fullincremental-approach"></a>Full/Incremental Approach</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Full/Incremental Approach is similiar to the Periodic Merge strategy, but
has one key difference. Instead of relying on the merge feature to merge backups
together we create a new backup repository periodically and back up the entire
cluster again. We then take incremental backups daily. Below is an example of
what this strategy would look like:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Sunday:    Config Backup Repo 1  (0 backups in backup repo)
Sunday:    Backup 1              (1 backup in backup repo)
Monday:    Backup 2              (2 backups in backup repo)
Tuesday:   Backup 3              (3 backups in backup repo)
Wednesday: Backup 4              (4 backups in backup repo)
Thursday:  Backup 5              (5 backups in backup repo)
Friday:    Backup 6              (6 backups in backup repo)
Saturday:  Backup 7              (7 backups in backup repo)
Sunday:    Config Backup Repo 2  (0 backup in backup repo)
Sunday:    Backup 8              (1 backups in backup repo)
Monday:    Backup 9              (2 backups in backup repo)
Tuesday:   Backup 10             (3 backups in backup repo)
Wednesday: Backup 11             (4 backups in backup repo)
Thursday:  Backup 12             (5 backups in backup repo)
Friday:    Backup 13             (6 backups in backup repo)
Saturday:  Backup 14             (7 backups in backup repo)
Sunday:    Create Backup Repo 3  (0 backups in backup repo)
Sunday:    Backup 15             (1 backup in backup repo)</pre>
</div>
</div>
<div class="paragraph">
<p>In this strategy we don&#8217;t use the merge command, but instead rely on creating a
new backup repository each week on Sunday. In order to free up space in this
strategy we would delete old backup repositories once they are deemed to be too
old to be useful. This strategy is useful for small to medium sized clusters due
to the requirement to take full backups.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="full-backup-only"><a class="anchor" href="#full-backup-only"></a>Full Backup Only</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this strategy we only take full backups. This strategy is only useful for
small clusters and puts the most strain on the cluster compared to other
strategies. A backup strategy using only full backups would look like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Sunday:    Config Backup Repo 1  (0 backups in backup repo)
Sunday:    Backup 1              (1 backup in backup repo)
Monday:    Config Backup Repo 2  (0 backups in backup repo)
Monday:    Backup 2              (1 backup in backup repo)
Tuesday:   Config Backup Repo 3  (0 backups in backup repo)
Tuesday:   Backup 3              (1 backup in backup repo)
Wednesday: Config Backup Repo 4  (0 backups in backup repo)
Wednesday: Backup 4              (1 backup in backup repo)
Thursday:  Config Backup Repo 5  (0 backups in backup repo)
Thursday:  Backup 5              (1 backup in backup repo)
Friday:    Config Backup Repo 6  (0 backups in backup repo)
Friday:    Backup 6              (1 backup in backup repo)
Saturday:  Config Backup Repo 7  (0 backups in backup repo)
Saturday:  Backup 7              (1 backup in backup repo)
Sunday:    Config Backup Repo 8  (0 backups in backup repo)
Sunday:    Backup 8              (1 backup in backup repo)</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also"><a class="anchor" href="#see-also"></a>SEE ALSO</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="cbbackupmgr-config.html" class="page">cbbackupmgr-config</a>,
<a href="cbbackupmgr-backup.html" class="page">cbbackupmgr-backup</a>,
<a href="cbbackupmgr-merge.html" class="page">cbbackupmgr-merge</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cbbackupmgr"><a class="anchor" href="#cbbackupmgr"></a>CBBACKUPMGR</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Part of the <a href="cbbackupmgr.html" class="page">cbbackupmgr</a> suite</p>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/logo.svg" alt="Couchbase">
          </a>
        </div>
        <div class="contact">
          <p class="address">3250 Olcott Street
Santa Clara, CA 95054
United States</p>
          <a href="https://www.couchbase.com/contact" class="btn white-btn">Contact Us</a>
          <a class="tel" href="tel:1-650-417-7500">1-650-417-7500</a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Company</span></li>
          <li><a href="https://www.couchbase.com/about">About</a></li>
          <li><a href="https://www.couchbase.com/leadership">Leadership</a></li>
          <li><a href="https://www.couchbase.com/news-and-press-releases">News &amp; Press</a></li>
          <li><a href="https://www.couchbase.com/careers">Careers</a></li>
          <li><a href="https://www.couchbase.com/resources/events">Events</a></li>
          <li><a href="https://www.couchbase.com/contact">Contact Us</a></li>
          <li><a href="https://www.couchbase.com/request-pricing">Pricing</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Support</span></li>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://www.couchbase.com/services">Professional Services</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support Login</a></li>
          <li><a href="https://learn.couchbase.com/store" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Quicklinks</span></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Online Training</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
          <li><a href="https://www.couchbase.com/nosql-resources/why-nosql">Why NoSQL</a></li>
          <li><a href="https://www.couchbase.com/resources/security">Security</a></li>
          <li><a href="https://www.couchbase.com/resources/gdpr">GDPR</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <a href="https://www.facebook.com/Couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="26.363 116.363 560.215 560.215"><path d="m586.58 209.58c0-48.96-44.252-93.212-93.212-93.212h-373.79c-48.96 0-93.212 44.252-93.212 93.212v373.79c0 48.96 44.252 93.212 93.212 93.212h186.42v-211.85h-68.732v-93.212h68.732v-36.72c0-63.083 47.077-119.58 105.45-119.58h75.323v93.212h-75.323c-8.474 0-17.889 10.357-17.889 25.422v37.662h93.212v93.212h-93.212v211.85h99.803c48.96 0 93.212-44.252 93.212-93.212v-373.79z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://twitter.com/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="32.012 176.622 542.326 437.815"><path d="m574.34 227.46c-19.772 8.474-41.428 15.065-64.025 17.889 22.597-14.123 40.486-35.778 48.96-61.2-21.655 13.182-45.194 21.655-70.615 27.305-20.714-21.655-48.96-34.837-80.972-34.837-61.2 0-111.1 49.902-111.1 111.1 0 8.474 0.942 16.948 2.825 25.422-92.271-5.649-174.18-49.902-229.74-117.69-9.415 16.006-15.065 35.778-15.065 55.551 0 38.603 19.772 72.498 49.902 92.271-17.889-0.942-35.778-5.649-50.843-14.123v0.942c0 53.668 38.603 98.862 89.446 109.22-9.415 2.825-18.831 3.766-29.188 3.766-7.532 0-14.123-0.942-20.714-1.883 14.123 44.252 55.551 76.265 103.57 77.206-37.662 30.129-85.68 48.018-138.41 48.018-9.415 0-17.889-0.941-26.363-1.883 48.96 32.012 107.34 49.902 170.42 49.902 204.31 0 316.36-169.48 316.36-316.36v-14.123c21.656-14.125 40.487-33.897 55.551-56.494z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://www.linkedin.com/company/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="31.071 119.188 539.537 540.443"><path d="m531.97 119.19h-461.35c-21.655 0-39.545 16.948-39.545 38.603v463.24c0 21.655 17.889 38.603 39.545 38.603h460.41c21.655 0 39.545-16.948 39.545-38.603v-463.24c0.942-21.656-16.947-38.603-38.603-38.603zm-337.07 451.94h-81.914v-243.86h81.914v243.86zm-40.486-276.81c-28.246 0-46.135-18.831-46.135-42.369s17.889-42.369 46.135-42.369 45.194 17.889 45.194 42.369c0.942 23.538-16.948 42.369-45.194 42.369zm335.19 276.81h-81.914v-129.93c0-32.954-12.24-55.551-41.428-55.551-22.597 0-35.778 15.065-41.428 30.129-1.883 5.649-2.825 12.24-2.825 19.772v136.52h-81.914s0.942-221.26 0-243.86h81.914v34.837c11.298-16.948 30.129-40.486 73.44-40.486 53.668 0 94.154 34.837 94.154 110.16l1e-3 138.41zm-168.54-208.08s0.941-0.941 0 0z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://plus.google.com/+CouchbaseServer" class="icon">
              <svg width="50px" height="50px" viewBox="36.72 225.573 542.326 343.67"><path d="m209.02 363.05v68.732h93.212c-15.065 44.252-37.662 68.732-93.212 68.732-56.492 0-100.74-46.135-100.74-102.63s44.252-102.63 100.74-102.63c30.129 0 48.96 10.357 66.849 25.422 14.123-14.123 13.182-16.006 48.96-49.902-31.071-28.246-71.557-45.194-115.81-45.194-95.096-0.94-172.3 76.266-172.3 171.36s77.206 172.3 172.3 172.3c142.17 0 177.01-124.28 165.71-206.2-33.896-1e-3 -165.71-1e-3 -165.71-1e-3zm310.71 3.766v-59.317h-42.369v59.317h-61.2v42.369h61.2v61.2h42.369v-61.2h59.317v-42.369h-59.317z"/></svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <span>2018 COUCHBASE All rights reserved.</span>
      <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
      <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
      <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
      <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
    </div>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
