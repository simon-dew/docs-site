<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Release notes | Couchbase Docs (Staging)</title>
    <link rel="canonical" href="https://simon-dew.github.io/docs-site/DOC-4461/java-sdk/2.7/start-using-sdk.html">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="schema.dcterms" href="https://purl.org/dc/terms/">
    <meta name="dcterms.subject" content="java-sdk">
    <meta name="dcterms.identifier" content="2.2">
    <meta name="generator" content="Antora 1.1.1">
    <link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar" id="topbar">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://www.couchbase.com"><img src="../../_/img/logo.svg" alt="Couchbase"></a>
        <button class="navbar-burger" data-target="topbar-menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
      <div id="topbar-menu" class="navbar-menu">
        <div class="navbar-start">
          <div class="navbar-item has-dropdown">
            <a class="navbar-link" href="https://simon-dew.github.io/docs-site/DOC-4461">Docs</a>
            <div class="navbar-dropdown explore">
              <div class="title">Couchbase Documentation Overview</div>
              <div class="cols">
                <ul>
                  <li class="heading"><a href="../../server/6.0/introduction/intro.html">Server</a></li>
                  <li><a href="../../server/6.0/n1ql/n1ql-language-reference/index.html">N1QL</a></li>
                  <li><a href="../../server/6.0/fts/full-text-intro.html">Full Text Search</a></li>
                  <li><a href="../../server/6.0/analytics/introduction.html">Analytics</a></li>
                  <li><a href="../../server/6.0/eventing/eventing-overview.html">Eventing</a></li>
                  <li><a href="../../operator/1.2/overview.html">Autonomous Operator</a></li>
                </ul>
                <ul>
                  <li class="heading">Mobile</li>
                  <li><a href="../../couchbase-lite/2.5/index.html">Lite</a></li>
                  <li><a href="../../sync-gateway/2.5/index.html">Sync Gateway</a></li>
                </ul>
                <ul class="two-cols">
                  <li class="heading"><a href="../../server/6.0/sdk/overview.html">SDKs</a></li>
                  <li><a href="../../c-sdk/2.10/start-using-sdk.html">C</a></li>
                  <li><a href="../../dotnet-sdk/2.7/start-using-sdk.html">.NET</a></li>
                  <li><a href="../../go-sdk/1.5/start-using-sdk.html">Go</a></li>
                  <li><a href="../../java-sdk/2.7/start-using-sdk.html">Java</a></li>
                  <li><a href="../../nodejs-sdk/2.6/start-using-sdk.html">Node.js</a></li>
                  <li><a href="../../php-sdk/2.6/start-using-sdk.html">PHP</a></li>
                  <li><a href="../../python-sdk/2.5/start-using-sdk.html">Python</a></li>
                </ul>
                <ul>
                  <li class="heading"><a href="../../server/6.0/connectors/intro.html">Connectors</a></li>
                  <li><a href="../../elasticsearch-connector/4.0/index.html">Elasticsearch</a></li>
                  <li><a href="../../server/6.0/connectors/hadoop-1.2/hadoop.html">Hadoop</a></li>
                  <li><a href="../../kafka-connector/3.4/index.html">Kafka</a></li>
                  <li><a href="../../spark-connector/2.2/index.html">Spark</a></li>
                  <li><a href="../../talend-connector/index.html">Talend</a></li>
                  <li><a href="../../server/6.0/connectors/odbc-jdbc-drivers.html">ODBC/JDBC</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="navbar-item has-dropdown">
            <a class="navbar-link component" href="java-intro.html"><span class="title">Java SDK</span> <span class="version">2.2</span></a>
            <div class="navbar-dropdown versions">
              <div class="cols">
                <ul>
                  <li><a class="navbar-item" href="../2.7/start-using-sdk.html">Java SDK 2.7</a></li>
                  <li><a class="navbar-item" href="../2.6/start-using-sdk.html">Java SDK 2.6</a></li>
                  <li><a class="navbar-item" href="../2.5/start-using-sdk.html">Java SDK 2.5</a></li>
                  <li><a class="navbar-item" href="../2.4/start-using-sdk.html">Java SDK 2.4</a></li>
                  <li><a class="navbar-item" href="../2.3/start-using-sdk.html">Java SDK 2.3</a></li>
                  <li><a class="navbar-item" href="../2.1/release-notes.html">Java SDK 2.1</a></li>
                </ul>
                <ul class="related">
                  <li><a class="navbar-item" href="../../c-sdk/2.10/release-notes.html">C SDK</a></li>
                  <li><a class="navbar-item" href="../../dotnet-sdk/2.7/release-notes.html">.NET SDK</a></li>
                  <li><a class="navbar-item" href="../../go-sdk/1.5/release-notes.html">Go SDK</a></li>
                  <li><a class="navbar-item" href="../../nodejs-sdk/2.6/release-notes.html">Node.js SDK</a></li>
                  <li><a class="navbar-item" href="../../php-sdk/2.6/release-notes.html">PHP SDK</a></li>
                  <li><a class="navbar-item" href="../../python-sdk/2.5/release-notes.html">Python SDK</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="navbar-end">
          <div class="navbar-item">
            <a class="btn red-btn" href="https://www.couchbase.com/downloads">Downloads</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body container">
<nav class="nav">
<div class="nav-menu">
<ul class="nav-list">
  <li class="nav-item is-current-path is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="java-intro.html">Java SDK 2.2</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="overview.html">Overview</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="download-links.html">Download and API reference</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="migrate.html">Migrating from Java SDK 1.4.x to 2.x</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="getting-started.html">Getting started with the Java SDK</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="hello-couchbase.html">Hello Couchbase Example</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="tutorial4.html">Java SDK tutorial</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="managing-connections.html">Managing connections</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="managing-cluster.html">Managing clusters</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="env-config.html">Configuring the environment</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="documents.html">Working with documents</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="documents-basics.html">Document basics</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="documents-creating.html">Creating documents</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="documents-updating.html">Updating documents</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="documents-retrieving.html">Retrieving documents</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="documents-deleting.html">Deleting documents</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="documents-atomic.html">Atomic operations</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="documents-bulk.html">Bulk operations</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="durability.html">Durability requirements</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="querying.html">Querying buckets</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="managing-views.html">Managing views</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="querying-views.html">Working with views</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="querying-n1ql.html">Working with N1QL</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="rxjava.html">RxJava and reactive programming</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="observables.html">Mastering Observables</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="reactive-apps.html">Writing resilient reactive applications</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="event-bus-metrics.html">Production considerations</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="logging.html">Setting up logging</a>
    </span>
  </li>
  <li class="nav-item is-current-page is-active" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="release-notes.html">Release notes</a>
    </span>
  </li>
</ul>
  </li>
</ul>
</div>
</nav>
<aside class="toc sidebar">
  <div class="toc-menu"></div>
</aside>
<main class="article" data-ceiling="topbar">
  <div class="article-banner">
    <p>A newer version of this documentation is available.</p>
    <a class="btn" href="../2.7/start-using-sdk.html">View Latest</a>
  </div>
  <div class="article-header">
<button class="nav-control"></button>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="java-intro.html">Java SDK</a></li>
    <li class="crumb"><a href="java-intro.html">Java SDK 2.2</a></li>
    <li class="crumb"><a href="release-notes.html">Release notes</a></li>
  </ul>
</nav>
<div class="tools" role="navigation">
  <ul>
    <li class="tool edit"><a href="https://github.com/couchbase/docs-sdk-java/edit/release/2.2/modules/ROOT/pages/release-notes.adoc" title="Edit Page" target="_blank" rel="noopener">Edit</a></li>
  </ul>
</div>
  </div>
<article class="doc">
<h1 class="page">Release notes</h1>
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
Release notes for the 2.2 version of the Java SDK.
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-java-client-2-2-8-ga-8-june-2016"><a class="anchor" href="#couchbase-java-client-2-2-8-ga-8-june-2016"></a>Couchbase Java Client 2.2.8 GA (8 June 2016)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Version 2.2.8 is the eighth bugfix release of the 2.2 series.
It brings bug fixes and enhancements.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga228-features"><a class="anchor" href="#ga228-features"></a>New features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release contains the following enhancements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For this release, the associated <code>core-io</code> version is also one patch version ahead with <code>1.2.9</code>.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-961" target="_blank" rel="noopener">JCBC-961</a>: In <code>ViewQuery</code>,  the <code>isOrderRetained</code> getter is now public.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga228-fixes"><a class="anchor" href="#ga228-fixes"></a>Fixed Issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release fixes the following issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-340" target="_blank" rel="noopener">JVMCBC-340</a>: Fix the keep alive messages not being sent anymore.
This issue was due to a 2.2.6 change in Netty usage, saving allocations on writes but not triggering the same kind of idle signals.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-339" target="_blank" rel="noopener">JVMCBC-339</a>: Flush signals are only sent to non-null endpoints, guarding against potential NPEs.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-java-client-2-2-7-ga-6-may-2016"><a class="anchor" href="#couchbase-java-client-2-2-7-ga-6-may-2016"></a>Couchbase Java Client 2.2.7 GA (6 May 2016)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Version 2.2.7 is the seventh bugfix release of the 2.2 series.
It brings bug fixes and enhancements.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga227-features"><a class="anchor" href="#ga227-features"></a>New features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release contains the following enhancements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For this release, the associated <code>core-io</code> version is also one patch version ahead with <code>1.2.8</code>.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-325" target="_blank" rel="noopener">JVMCBC-325</a> , <a href="https://www.couchbase.com/issues/browse/JVMCBC-327" target="_blank" rel="noopener">JVMCBC-327</a>: All outgoing HTTP requests now have a HOST header.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-952" target="_blank" rel="noopener">JCBC-952</a>: The experimental Index Management API now has the "N1ql" word in all methods (like "<code class="code">listN1qlIndexes()</code>") to allow future evolutions with different types of indexes.
It can also create a secondary N1QL index with a WHERE clause.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga227-fixes"><a class="anchor" href="#ga227-fixes"></a>Fixed Issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release fixes the following issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-326" target="_blank" rel="noopener">JVMCBC-326</a>: N1QL and View parser fix for json strings ending with 2 backslashes.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-java-client-2-2-6-ga-5-april-2016"><a class="anchor" href="#couchbase-java-client-2-2-6-ga-5-april-2016"></a>Couchbase Java Client 2.2.6 GA (5 April 2016)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Version 2.2.6 is the sixth bugfix release of the 2.2 series.
It brings bug fixes, enhancements, and correctness improvements.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga226-features"><a class="anchor" href="#ga226-features"></a>New features and behavioral changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release contains the following enhancements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For this release, the associated <code>couchbase-jvm-core</code> version is one patch version ahead with <code>1.2.7</code>.</p>
</li>
<li>
<p>Dependencies: RxJava and Netty dependencies have been bumped to their latest bugfix releases (<code>1.0.17</code> and <code>4.0.35</code>).</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-928" target="_blank" rel="noopener">JCBC-928</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-926" target="_blank" rel="noopener">JCBC-926</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-936" target="_blank" rel="noopener">JCBC-936</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-925" target="_blank" rel="noopener">JCBC-925</a>: The Index Management API has been overhauled and improved.
You can notably now manage primary indexes with custom names.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-944" target="_blank" rel="noopener">JCBC-944</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-946" target="_blank" rel="noopener">JCBC-946</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-948" target="_blank" rel="noopener">JCBC-948</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-324" target="_blank" rel="noopener">JVMCBC-324</a>: N1QL improvements.
For the <code>adhoc(false)</code> category of N1QL queries, it is now possible to disable sending the prepared_plan with prepared statements to save bandwidth (use with care!), and internal prepared names are correctly escaped if used.
N1QL helper to build updateFor clause.
In the core, some N1QL requests can be made to target specific nodes.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-931" target="_blank" rel="noopener">JCBC-931</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-938" target="_blank" rel="noopener">JCBC-938</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-940" target="_blank" rel="noopener">JCBC-940</a>: The experimental Subdocument API has been enhanced and slightly streamlined: some array-related methods have been renamed (eg.
<code>pushFront</code> to <code>arrayPrepend</code>), array mutation methods now can accept several items to insert in one go, the <code>doLookup()</code> and <code>doMutate()</code> execution methods have both been renamed <code>execute()</code>.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-313" target="_blank" rel="noopener">JVMCBC-313</a>: SCRAM-* is now enabled by default if the server supports it.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-317" target="_blank" rel="noopener">JVMCBC-317</a>: It is now possible to use the Epoll netty transport for better IO performance on Linux.
The library is embedded in the latest Netty distribution.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-875" target="_blank" rel="noopener">JCBC-875</a>: The <code>Retrybuilder</code> now supports adding an advanced error predicate (allowing for example to only retry on exceptions with a certain message), as well as a <code>doOnRetry</code> hook that you can use to get notified of each retry attempt.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-943" target="_blank" rel="noopener">JCBC-943</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-322" target="_blank" rel="noopener">JVMCBC-322</a>: Version information about the SDK is now richer in <code>CoreEnvironment</code> and <code>CouchbaseEnvironment</code>.
The former&#8217;s <code>packageNameAndVersion</code> method (as well as the user agent) now displays the java-client version, with the core&#8217;s version in the details.
Getters have been added so you can get the version and build number (a more exact git reference) for both core and java-client.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-937" target="_blank" rel="noopener">JCBC-937</a>: <code>JsonObject</code> and <code>JsonArray</code> now both accept a size hint at construction.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-298" target="_blank" rel="noopener">JVMCBC-298</a>: Implement 0x97 DCP protocol command to get last closed checkpoint (<code>OP_GET_LAST_CHECKPOINT</code>).</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-300" target="_blank" rel="noopener">JVMCBC-300</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-299" target="_blank" rel="noopener">JVMCBC-299</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-301" target="_blank" rel="noopener">JVMCBC-301</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-935" target="_blank" rel="noopener">JCBC-935</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-310" target="_blank" rel="noopener">JVMCBC-310</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-303" target="_blank" rel="noopener">JVMCBC-303</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-308" target="_blank" rel="noopener">JVMCBC-308</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-302" target="_blank" rel="noopener">JVMCBC-302</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-306" target="_blank" rel="noopener">JVMCBC-306</a>: Many small performance and GC enhancements: avoid unnecessary allocations, avoid redundant encoding of keys, optimize scheduling and selection strategies, better split classes... Allow optional Observable completion on the Event Loops.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga226-fixes"><a class="anchor" href="#ga226-fixes"></a>Fixed Issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release fixes the following issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-309" target="_blank" rel="noopener">JVMCBC-309</a>: Gracefully handle errors during metrics collection.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-323" target="_blank" rel="noopener">JVMCBC-323</a>: Gracefully handle config completion errors during shutdown.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-312" target="_blank" rel="noopener">JVMCBC-312</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-315" target="_blank" rel="noopener">JVMCBC-315</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-305" target="_blank" rel="noopener">JVMCBC-305</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-311" target="_blank" rel="noopener">JVMCBC-311</a>: DCP related fixes: use the same logical connection for all DCP nodes, use double for ack threshold in Builder, allow DCP connectors to notify core about processing messages, do not release buffer without copying it.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-java-client-2-2-5-ga-1-march-2016"><a class="anchor" href="#couchbase-java-client-2-2-5-ga-1-march-2016"></a>Couchbase Java Client 2.2.5 GA (1 March 2016)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Version 2.2.5 is the fifth bugfix release of the 2.2 series.
It brings bug fixes, enhancements, and correctness improvements.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga225-features"><a class="anchor" href="#ga225-features"></a>New features and behavioral changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release contains the following enhancements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-906" target="_blank" rel="noopener">JCBC-906</a>: (experimental) The index management API on the <code>BucketManager</code> has been revised to match the desired functionality across SDKs.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-921" target="_blank" rel="noopener">JCBC-921</a>: (experimental) The subdocument API has been rewritten completely to now use a builder-like API that unifies single and multi-path operations significantly.
Note that you can only use it against Couchbase Server 4.5 or later.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-804" target="_blank" rel="noopener">JCBC-804</a>: (experimental) Enhanced "Read Your Writes" capabilities have been added to N1QL queries.
If <code>MutationTokens</code> are enabled on the environment, the result of a mutation can be passed in as a query option on a N1QL query, providing better performance in certain use cases.
This is a pure optimization on <code>REQUEST_PLUS</code> and should only be considered if that one does not meet the requirements.
Note that you can only use it against Couchbase Server 4.5 or later.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-910" target="_blank" rel="noopener">JCBC-910</a>: Thanks to a community contribution by Kim Intae it is now possible to optionally specify a strict ordering on View queries when <code>includeDocs</code> is used.
By default, the rows are returned as the documents arrive, but sometimes it is important to keep the ordering from the original row stream.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-280" target="_blank" rel="noopener">JVMCBC-280</a>: Client side support for SCRAM-SHA1, SCRAM-SHA256 and SCRAM-SHA512 has been added, but is disabled by default (and can only be enabled through a to-be-removed-soon system property called <code>com.couchbase.scramEnabled</code>).
Once the server provides full support (Couchbase Server 4.5 GA), it will be enabled by default.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-292" target="_blank" rel="noopener">JVMCBC-292</a>: It is now possible to use different powers on the <code>ExponentialDelay</code> in addition to the default power of two.
This gives more flexibility in how fast the delay should grow and what pattern it is using.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-294" target="_blank" rel="noopener">JVMCBC-294</a>: The SDK now passes bucket-level credentials to the FTS service (similar to N1QL and Views).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga225-fixes"><a class="anchor" href="#ga225-fixes"></a>Fixed Issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release fixes the following issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-293" target="_blank" rel="noopener">JVMCBC-293</a>: A bug in the <code>ExponentialDelay</code> has been fixed which makes sure the overflow guard works against 64 bit and not 32 (since it is using a long field internally).
This is expanding on earlier fixes in the exponential delay, avoiding it to wrap around and starting with the lowest value again.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-java-client-2-2-4-ga-3-february-2016"><a class="anchor" href="#couchbase-java-client-2-2-4-ga-3-february-2016"></a>Couchbase Java Client 2.2.4 GA (3 February 2016)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Version 2.2.4 is the fourth bugfix release of the 2.2 series.
It brings bug fixes, enhancements, and correctness improvements.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga224-features"><a class="anchor" href="#ga224-features"></a>New features and behavioral changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release contains the following enhancements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-849" target="_blank" rel="noopener">JCBC-849</a>: Experimental support for the <code>SubDocument</code> feature has been added.
Subdocument allows you to transmit only the specific part of a JSON document that you want.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-850" target="_blank" rel="noopener">JCBC-850</a>: Experimental support for <em class="term">Full Text Search (FTS)</em>, a new type of index in Couchbase Server 4.5 that allows you to do, for example,  the fuzzy text search queries.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-869" target="_blank" rel="noopener">JCBC-869</a>: N1QL row values can now be deserialized by a custom library since they expose the raw value as a <code>byte[]</code> through <code>byteValue()</code>.
The <code>JsonObject</code> <code>value()</code> is deserialized lazily from this byte array, so never invoking it will completely avoid the overhead of JsonObject deserialization if you don&#8217;t need it.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-279" target="_blank" rel="noopener">JVMCBC-279</a>: The bucket&#8217;s name has been added to the <code>MutationToken</code> produced when enhanced durability is activated.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-282" target="_blank" rel="noopener">JVMCBC-282</a>: When a node is being reconnected, a notification is sent through the <code>EventBus</code>.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-281" target="_blank" rel="noopener">JVMCBC-281</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-284" target="_blank" rel="noopener">JVMCBC-284</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-285" target="_blank" rel="noopener">JVMCBC-285</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-287" target="_blank" rel="noopener">JVMCBC-287</a>: Various allocating and caching changes for performance improvements.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga224-fixes"><a class="anchor" href="#ga224-fixes"></a>Fixed Issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release fixes the following issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-278" target="_blank" rel="noopener">JVMCBC-278</a>: A socket timeout on a Netty endpoint would prevent any further attempt at reconnecting the client altogether.
A message in the logs stating that "Socket connect took longer than specified timeout" would appear and the client wouldn&#8217;t reconnect to the node when it would come back online.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-288" target="_blank" rel="noopener">JVMCBC-288</a>: Various <code>Locators</code> now correctly only locate a <code>Node</code> that has the proper service enabled.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-903" target="_blank" rel="noopener">JCBC-903</a>: Some <code>CouchbaseFeature</code> enums were referencing wrong Couchbase Server version.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-904" target="_blank" rel="noopener">JCBC-904</a>: The <code>socketConnectTimeout</code> tuning can now properly be set on the <code>CouchbaseEnvironment</code>.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-277" target="_blank" rel="noopener">JVMCBC-277</a>: Netty sources are now properly relocated in the source jar to match the shaded classes in the main jar (looking at sources and entering the Netty shaded classes should now work).</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-286" target="_blank" rel="noopener">JVMCBC-286</a>: Build process now checks both in core and client that only classes and methods that are available in a Java 6 JRE/JDK are used.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-java-client-2-2-3-ga-5-january-2016"><a class="anchor" href="#couchbase-java-client-2-2-3-ga-5-january-2016"></a>Couchbase Java Client 2.2.3 GA (5 January 2016)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Version 2.2.3 is the third bug fix release of the 2.2 series.
It brings bug fixes, enhancements, and correctness improvements.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga223-features"><a class="anchor" href="#ga223-features"></a>New features and behavioral changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release contains the following enhancements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-777" target="_blank" rel="noopener">JCBC-777</a>: Experimental Index management on the <code>BucketManager</code> has been added, allowing to create, drop and list GSI indexes.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-883" target="_blank" rel="noopener">JCBC-883</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-757" target="_blank" rel="noopener">JCBC-757</a>: The Query Builder API has been greatly extended.
<code>Select</code> now supports <code>fromCurrentBucket()</code>.
Support for Insert, Upsert, Update, Remove and Merge has been added.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-273" target="_blank" rel="noopener">JVMCBC-273</a>: Experimental core support for the <code>SubDocument API</code> has been added.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-269" target="_blank" rel="noopener">JVMCBC-269</a>: DCP core implementation of Get Failover Logs (0x54) command.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga223-fixes"><a class="anchor" href="#ga223-fixes"></a>Fixed Issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release fixes the following issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-895" target="_blank" rel="noopener">JCBC-895</a>: A potential overflow when using MAX_VALUE on the <code>RetryBuilder</code> has been fixed.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-894" target="_blank" rel="noopener">JCBC-894</a>: Thanks to a community contribution, the <code>BucketManager</code> is now compatible with old Couchbase/Membase releases.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-267" target="_blank" rel="noopener">JVMCBC-267</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-272" target="_blank" rel="noopener">JVMCBC-272</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-270" target="_blank" rel="noopener">JVMCBC-270</a>: DCP related fixes relative to seqno and flow control.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-274" target="_blank" rel="noopener">JVMCBC-274</a>: The <code>ExponentialDelay</code> grows so large by the 32th attempt that it overflows back to negative values, producing a cycle of short, bursty retries back every 32 attempts (especially if the lower bound and time unit are small).
It is now staying at <code>Integer.MAX_VALUE</code> delay duration past the 32th attempt.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-java-client-2-2-2-ga-12-november-2015"><a class="anchor" href="#couchbase-java-client-2-2-2-ga-12-november-2015"></a>Couchbase Java Client 2.2.2 GA (12 November 2015)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Version 2.2.2 is the second bug fix release of the 2.2 series.
It brings many bug fixes, stability improvements as well as smaller enhancements.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga222-features"><a class="anchor" href="#ga222-features"></a>New features and behavioral changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release contains the following enhancements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-871" target="_blank" rel="noopener">JCBC-871</a>: The <code>N1qlQueryResult</code> (and async variant) has been extended to now also expose the <code>Status</code> as a string, allowing for more fine-grained matching and reporting on potential errors.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-256" target="_blank" rel="noopener">JVMCBC-256</a>: In the next minor version, a blocking version of the <code>shutdown</code> method on the Environment will be introduced.
To make the smaller impact, the current <code>shutdown</code> method on the <code>CouchbaseEnvironment</code> has been deprecated and explicitly refers to the new <code>shutdownAsync</code> method.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-863" target="_blank" rel="noopener">JCBC-863</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-870" target="_blank" rel="noopener">JCBC-870</a>: While it is still best practice and heavily encouraged to cache and reuse <code>Bucket</code> references, an effort has been made to reduce the impact of potential misuse.
The client now caches open bucket instances and reuses them where possible if many subsequent <code>openBucket</code> calls are performed.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga222-fixes"><a class="anchor" href="#ga222-fixes"></a>Fixed issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release fixes the following issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RxJava has been upgraded to 1.0.15 to address shutdown-cleanup related issues.
In-depth discussion of this topic can be read <a href="https://github.com/ReactiveX/RxJava/pull/3149" target="_blank" rel="noopener">here</a>.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-864" target="_blank" rel="noopener">JCBC-864</a>: The remove operation, when used with the durability requirements now properly honors the CAS when provided inside the <code>Document</code>.
It now correctly throws <code>CASMismatchExceptions</code> when the CAS does not match with the server.
Previously, the supplied CAS was ignored, and the remove operation performed without optimistic concurrency checks.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-263" target="_blank" rel="noopener">JVMCBC-263</a>: A bug in the view query parser has been uncovered, which would make it hang particularly when the key  includes a closing <code>}</code>, but no opening <code>{</code> inside a string.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-262" target="_blank" rel="noopener">JVMCBC-262</a>: The logic that performs the proactive load of new configurations through the "Carrier Publication" mechanism now only targets nodes where the KV-Service is enabled.
Such targeting is important in MDS scenarios so that it doesn&#8217;t ask nodes where only the query or indexing services are enabled.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-102" target="_blank" rel="noopener">JVMCBC-102</a>: The initial bootstrap process has been made more resilient to individual node failures, fixing a bunch of bugs around initial bootstrapping.
Especially the case where one of the nodes is not responding and opening a <code>memcached</code> type bucket now works correctly (this involves internally skipping over not responding nodes as well as falling back from carrier publication to the http bootstrapping approach).</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-257" target="_blank" rel="noopener">JVMCBC-257</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-265" target="_blank" rel="noopener">JVMCBC-265</a>: The configuration management logic has been improved in various places, making it more resilient to failed bucket open attempts (cleaning up the state properly) as well as optimizing the proactive config loading approach when no buckets are open or are currently being closed.
In particular, one issue has been resolved where an asynchronous open bucket attempt with a fallback to a good one did not work previously.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-266" target="_blank" rel="noopener">JVMCBC-266</a>: The client now proactively checks if the document ID is null, empty or too large where it can be directly passed in.
Previously, the operation would fail with the server responding <code>INVALID_ARGUMENTS</code> where now it is very clear what the root cause of the issue is.
The client now fails the <code>Observable</code> right away with an <code>IllegalArgumentException</code> explaining what the problem is.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-865" target="_blank" rel="noopener">JCBC-865</a>: In the N1QL builder API, the an invalid query was generated when multiple WHEN blocks are used in the CASE statement, leading to query errors.
This issue has been fixed; the client now emits correct N1QL statements in those cases.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-java-client-2-2-1-ga-13-october-2015"><a class="anchor" href="#couchbase-java-client-2-2-1-ga-13-october-2015"></a>Couchbase Java Client 2.2.1 GA (13 October 2015)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Version 2.2.1 is the first bug fix release of the 2.2 series.
It contains bug fixes and correctness improvements, especially during bootstrap, shutdown and when SSL is enabled.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga221-features"><a class="anchor" href="#ga221-features"></a>New features and behavioral changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release contains the following enhancements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-250" target="_blank" rel="noopener">JVMCBC-250</a>: An explicit, lower (configurable) socket connect timeout is now always used when connections are established.
This provides more reliable semantics during the socket open phase and allows for faster-retrying mechanisms inside the core layer.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-242" target="_blank" rel="noopener">JVMCBC-242</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-247" target="_blank" rel="noopener">JVMCBC-247</a>: The internal dependencies for Jackson and Netty have been bumped to their latest bugfix releases for increased stability.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-241" target="_blank" rel="noopener">JVMCBC-241</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-253" target="_blank" rel="noopener">JVMCBC-253</a>: Experimental Support for DCP has been improved.
<code>ERANGE</code> and <code>ROLLBACK</code> during the stream open phase are now handled properly.
Also, it is now possible to partially initialize streams (for example to only get the streams for a specific number of partitions).</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-246" target="_blank" rel="noopener">JVMCBC-246</a>: The KeyValue <code class="cmd">STAT</code> command is now implemented in the core layer, allowing for more flexibility in the future to grab key or cluster statistics.
Note that STATS are not exposed to the <code>java-client</code> at this point, but might be in the future as encapsulated APIs.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-245" target="_blank" rel="noopener">JVMCBC-245</a>: When latency metric events are emitted, the original time unit is now included, so later analysis does not need to reference back to the source code for the time unit used.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-854" target="_blank" rel="noopener">JCBC-854</a>: Encoding for all string-based document types has been made faster by a factor of 2 and more, this also includes the <code>RawJsonDocument</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ga221-fixes"><a class="anchor" href="#ga221-fixes"></a>Fixed issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release fixes the following issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-251" target="_blank" rel="noopener">JVMCBC-251</a>: The full cleanup of SDK-owned threads during full shutdown has been improved across the board, allowing diagnostics through logs and fixing behavior especially when performing redeployments in an application container.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-248" target="_blank" rel="noopener">JVMCBC-248</a>: SSL Handshake failures during the connect phase are now more explicitly handled and propagate the right error up the call stack.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-242" target="_blank" rel="noopener">JVMCBC-242</a>: A TranscodingException when decoding JSON arrays has been fixed by upgrading the internal Jackson dependency to 2.6.2.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-java-client-2-2-0-ga-2-september-2015"><a class="anchor" href="#couchbase-java-client-2-2-0-ga-2-september-2015"></a>Couchbase Java Client 2.2.0 GA (2 September 2015)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Version 2.2.0 is the first release of the 2.2 series and brings compatibility with Couchbase Server 4.0 as well as lots of new features and enhancements.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="migration-notes"><a class="anchor" href="#migration-notes"></a>Migration Notes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While the 2.2 release does not bring any breaking changes to stable APIs over 2.1, some APIs have been modified and unstable APIs renamed.
The following information provides guidelines on migrating from 2.1.x:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>counter(String id, long delta)</code> method and associated overloads (custom timeout or with durability requirements) have been modified so that it throws a <code>DocumentDoesNotExistException</code> if the document does not exist.
Previously, the code automatically initialized the document with 0.
The 1.x SDK provided a similar feature, so we wanted to bring it back for more flexibility.
The new code is simple—just use the overload with an initial value of 0:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// before
bucket.counter("id", 10);

// after
bucket.counter("id", 10, 0);</code></pre>
</div>
</div>
</li>
<li>
<p>If the CAS is set on the documents used in append/prepend operations and the server CAS does not match, previously a generic CouchbaseException was thrown.
Now the code checks for this response status and returns a more correct <code>CASMismatchException</code>.</p>
<div class="paragraph">
<p>Because this exception extends the <code>CouchbaseException</code>, your code might still work although checking for this explicit exception type is recommended.</p>
</div>
</li>
<li>
<p>If you have been using the asynchronous API, be aware that all the asynchronous API methods are now returning <code>cold</code> <code>Observables</code> instead of <code>hot</code> <code>Observables</code>.
As a result, you don&#8217;t need to call <code>Observable.defer()</code> around the bucket calls if you want proper retry semantics.
If you are doing that already, you can remove the calls (but don&#8217;t have to—it&#8217;s just a little more overhead).
Also, it has been always recommended, but make sure to subscribe to all of your <code>Observables</code>.
Hot <code>Observables``Observable</code> might have been automatically executed, but cold <code>Observables</code> won&#8217;t.
Not subscribing, in general, goes against the RX contract.</p>
</li>
<li>
<p>If you&#8217;ve been implementing your own Document type together with a custom transcoder, you now need to implement a new method if you want to use the document together with the new feature called enhanced durability.
The specific change is that you need to add a simple factory method that allows you to pass in the new <code>MutationToken</code>.
Your old code will keep working, but for future compatibility we recommend adding this new method.</p>
<div class="paragraph">
<p>As an example here is how the <code>JsonDocument</code> implements the new method.
If you want, you can also make the older factory method just forward to the new one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Pre-2.2, can still be used
@Override
public JsonDocument newDocument(String id, int expiry, JsonObject content, long cas) {
    return JsonDocument.create(id, expiry, content, cas);
}

// New in 2.2
@Override
public JsonDocument newDocument(String id, int expiry, JsonObject content, long cas,
    MutationToken mutationToken) {
    return JsonDocument.create(id, expiry, content, cas, mutationToken);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your document extends from the AbstractDocument, make sure you call the new super method with the token instead of the old one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private JsonDocument(String id, int expiry, JsonObject content, long cas, MutationToken mutationToken) {
    super(id, expiry, content, cas, mutationToken);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make note of the following:</p>
</div>
</li>
<li>
<p>To make the N1QL queries more consistent with the View queries, all exposed N1QL classes have been prefixed with N1QL or been renamed in a slightly different manner to make the intent clear.
We did rename Query, QueryResult, QueryRow, their asynchronous counterparts, concrete implementations and related tests by prefixing <code>Query</code> with <code>N1ql</code>.
Also, <code>QueryMetrics</code> and <code>QueryParams</code> have been respectively renamed to <code>N1qlMetrics</code> and <code>N1qlParams</code>.
Finally, the <code>QueryExecutor</code> has been renamed to <code>N1qlQueryExecutor</code>.</p>
</li>
<li>
<p>Since we are stabilizing the API now, we also had to rename the <code>parametrized</code> query to <code>parameterized</code>.
This is to ensure the best possible experience across SDKs and consistent documentation for client and server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="new-features-and-behavioral-changes"><a class="anchor" href="#new-features-and-behavioral-changes"></a>New features and behavioral changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release brings the following features and enhancements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-137" target="_blank" rel="noopener">JVMCBC-137</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-222" target="_blank" rel="noopener">JVMCBC-222</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-732" target="_blank" rel="noopener">JCBC-732</a>, <a href="https://www.couchbase.com/issues/browse/JCBC-761" target="_blank" rel="noopener">JCBC-761</a> (and more): Official Couchbase Server 4.0 Support.
This includes mainly a stable and tested N1QL API, as well as support for MDS (Multi-Dimensional Scaling).
Use 2.2.0 and later as your go-to release when working with CB Server 4.0 and up.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-60" target="_blank" rel="noopener">JVMCBC-60</a>: System and Latency Metrics are now collected in an "always on" fashion and emitted to the event bus every hour by default.
This is all configurable and tunable based on the applications needs.
Please consult the documentation on metrics to get all the nitty gritty details.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-826" target="_blank" rel="noopener">JCBC-826</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-190" target="_blank" rel="noopener">JVMCBC-190</a>, <a href="https://www.couchbase.com/issues/browse/JVMCBC-205" target="_blank" rel="noopener">JVMCBC-205</a>: 4.0 also introduces a new feature called enhanced durability, which allows for more accurate durability requirements (PersistTo and ReplicateTo).
All you need to do is enable the mutation tokens on the environment, but keep in mind that there is an increased byte overhead on every mutation.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Enable enhanced durability
CouchbaseEnvironment environment = DefaultCouchbaseEnvironment.builder()
            .mutationTokensEnabled(true)
            .build();

// Perform an operation as before and benefit from it transparently
bucket.upsert(doc, PersistTo.MASTER, ReplicateTo.ONE);</code></pre>
</div>
</div>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-744" target="_blank" rel="noopener">JCBC-744</a>: Experimental support for POJO mapping capabilities have been added in the form of a repository API.
See this <a href="http://blog.couchbase.com/javasdk-2.2-dp" target="_blank" rel="noopener">blog post</a> for more details.
Here is a quick example.
Right now you need a no-args constructor to recreate the object again, we&#8217;ll make it more flexible with explicit constructors in the future so you can use final fields.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public static class User {

    @Id
    private String username;

    private String firstname;

    @Field("lname")
    private String lastname;

    public User(String username, String firstname, String lastname) {
        this.username = username;
        this.firstname = firstname;
        this.lastname = lastname;
    }

    public User() {}
}

Repository repository = bucket.repository();

User user = new User("daschl", "Michael", "N.");
repository.upsert(EntityDocument.create(user));

System.out.println(repository.get("daschl", User.class).content().firstname);</code></pre>
</div>
</div>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-805" target="_blank" rel="noopener">JCBC-805</a>: The <code>getFromReplica()</code> method now has an overload that returns an <code>Iterator</code>, making it more flexible on the blocking API to only extract one or two results if needed (and don&#8217;t wait for all responses).</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-749" target="_blank" rel="noopener">JCBC-749</a>: <code>includeDocs</code> on the ViewQuery has been re-added (it was there in 1.x) so that the blocking API can benefit from efficient bulk document loading in the background automatically.
If you are using the asynchronous API only, you won&#8217;t need this query option.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-784" target="_blank" rel="noopener">JCBC-784</a>: As mentioned in the migration notes above, the counter overload with no default value has been enhanced to throw an exception if the document does not exist.
Previously, it was not possible to only use the counter method on documents that exist (they would always be initialized with a default value of 0 instead).</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-836" target="_blank" rel="noopener">JCBC-836</a>: Durability Requirements for <code>append</code>, <code>prepend</code> and <code>counter</code> have been added to the Bucket API.
This allows you to observe persistence and replication not only on insert, upsert, replace and remove, but also on append, prepend and counter.
Of course, this all plays well with the new enhanced durability feature we&#8217;ve added if you work against Couchbase Server 4.0 or later.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-782" target="_blank" rel="noopener">JCBC-782</a>: All asynchronous API calls are now "cold", which means they are not eagerly run until subscribed by the caller.
This won&#8217;t affect basic usage, but makes it easier when doing asynchronous retry logic or branching to fallback calls.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-652" target="_blank" rel="noopener">JCBC-652</a>: When creating or replacing a <code>DesignDocument</code>, you can now specify different options that are configurable on a per design document basis.
Please see the documentation for a list of those options.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-237" target="_blank" rel="noopener">JVMCBC-237</a>: To detect cluster changes in MDS setup more reliably, the SDK now polls for a new configuration every 10 seconds.
This is completely transparent, but can be seen when dumping the network traffic.
Note that the NOOP heartbeat polling is still in place, only the piggybacked configuration reloading has been superseded with this more general approach.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fixed-issues"><a class="anchor" href="#fixed-issues"></a>Fixed issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release fixes the following issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-231" target="_blank" rel="noopener">JVMCBC-231</a>: A race condition has been fixed during shutdown (internal reconfigure), when all nodes are removed.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-834" target="_blank" rel="noopener">JCBC-834</a>: The blocking API for spatial queries was using the default timeout for N1QL queries instead of views.
They are set to the same value by default, but can be changed on the environment separately, probably leading to weird behavior if not taken into account.</p>
</li>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JCBC-815" target="_blank" rel="noopener">JCBC-815</a>: Do not let the <code>CouchbaseEnvironment.Builder</code> implement the <code>CouchbaseEnvironment</code>.
This has lead to confusion during development and is not necessary.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="known-issues"><a class="anchor" href="#known-issues"></a>Known issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This release contains the following known issues to be addressed in subsequent releases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.couchbase.com/issues/browse/JVMCBC-242" target="_blank" rel="noopener">JVMCBC-242</a>: A TranscodingException is thrown when decoding long arrays (for details see the ticket).
This has been addressed in 2.2.1.</p>
</li>
</ul>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../_/img/logo.svg" alt="Couchbase">
          </a>
        </div>
        <div class="contact">
          <p class="address">3250 Olcott Street
Santa Clara, CA 95054
United States</p>
          <a href="https://www.couchbase.com/contact" class="btn white-btn">Contact Us</a>
          <a class="tel" href="tel:1-650-417-7500">1-650-417-7500</a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Company</span></li>
          <li><a href="https://www.couchbase.com/about">About</a></li>
          <li><a href="https://www.couchbase.com/leadership">Leadership</a></li>
          <li><a href="https://www.couchbase.com/news-and-press-releases">News &amp; Press</a></li>
          <li><a href="https://www.couchbase.com/careers">Careers</a></li>
          <li><a href="https://www.couchbase.com/resources/events">Events</a></li>
          <li><a href="https://www.couchbase.com/contact">Contact Us</a></li>
          <li><a href="https://www.couchbase.com/request-pricing">Pricing</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Support</span></li>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://www.couchbase.com/services">Professional Services</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support Login</a></li>
          <li><a href="https://learn.couchbase.com/store" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Quicklinks</span></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Online Training</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
          <li><a href="https://www.couchbase.com/nosql-resources/why-nosql">Why NoSQL</a></li>
          <li><a href="https://www.couchbase.com/resources/security">Security</a></li>
          <li><a href="https://www.couchbase.com/resources/gdpr">GDPR</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <a href="https://www.facebook.com/Couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="26.363 116.363 560.215 560.215"><path d="m586.58 209.58c0-48.96-44.252-93.212-93.212-93.212h-373.79c-48.96 0-93.212 44.252-93.212 93.212v373.79c0 48.96 44.252 93.212 93.212 93.212h186.42v-211.85h-68.732v-93.212h68.732v-36.72c0-63.083 47.077-119.58 105.45-119.58h75.323v93.212h-75.323c-8.474 0-17.889 10.357-17.889 25.422v37.662h93.212v93.212h-93.212v211.85h99.803c48.96 0 93.212-44.252 93.212-93.212v-373.79z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://twitter.com/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="32.012 176.622 542.326 437.815"><path d="m574.34 227.46c-19.772 8.474-41.428 15.065-64.025 17.889 22.597-14.123 40.486-35.778 48.96-61.2-21.655 13.182-45.194 21.655-70.615 27.305-20.714-21.655-48.96-34.837-80.972-34.837-61.2 0-111.1 49.902-111.1 111.1 0 8.474 0.942 16.948 2.825 25.422-92.271-5.649-174.18-49.902-229.74-117.69-9.415 16.006-15.065 35.778-15.065 55.551 0 38.603 19.772 72.498 49.902 92.271-17.889-0.942-35.778-5.649-50.843-14.123v0.942c0 53.668 38.603 98.862 89.446 109.22-9.415 2.825-18.831 3.766-29.188 3.766-7.532 0-14.123-0.942-20.714-1.883 14.123 44.252 55.551 76.265 103.57 77.206-37.662 30.129-85.68 48.018-138.41 48.018-9.415 0-17.889-0.941-26.363-1.883 48.96 32.012 107.34 49.902 170.42 49.902 204.31 0 316.36-169.48 316.36-316.36v-14.123c21.656-14.125 40.487-33.897 55.551-56.494z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://www.linkedin.com/company/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="31.071 119.188 539.537 540.443"><path d="m531.97 119.19h-461.35c-21.655 0-39.545 16.948-39.545 38.603v463.24c0 21.655 17.889 38.603 39.545 38.603h460.41c21.655 0 39.545-16.948 39.545-38.603v-463.24c0.942-21.656-16.947-38.603-38.603-38.603zm-337.07 451.94h-81.914v-243.86h81.914v243.86zm-40.486-276.81c-28.246 0-46.135-18.831-46.135-42.369s17.889-42.369 46.135-42.369 45.194 17.889 45.194 42.369c0.942 23.538-16.948 42.369-45.194 42.369zm335.19 276.81h-81.914v-129.93c0-32.954-12.24-55.551-41.428-55.551-22.597 0-35.778 15.065-41.428 30.129-1.883 5.649-2.825 12.24-2.825 19.772v136.52h-81.914s0.942-221.26 0-243.86h81.914v34.837c11.298-16.948 30.129-40.486 73.44-40.486 53.668 0 94.154 34.837 94.154 110.16l1e-3 138.41zm-168.54-208.08s0.941-0.941 0 0z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://plus.google.com/+CouchbaseServer" class="icon">
              <svg width="50px" height="50px" viewBox="36.72 225.573 542.326 343.67"><path d="m209.02 363.05v68.732h93.212c-15.065 44.252-37.662 68.732-93.212 68.732-56.492 0-100.74-46.135-100.74-102.63s44.252-102.63 100.74-102.63c30.129 0 48.96 10.357 66.849 25.422 14.123-14.123 13.182-16.006 48.96-49.902-31.071-28.246-71.557-45.194-115.81-45.194-95.096-0.94-172.3 76.266-172.3 171.36s77.206 172.3 172.3 172.3c142.17 0 177.01-124.28 165.71-206.2-33.896-1e-3 -165.71-1e-3 -165.71-1e-3zm310.71 3.766v-59.317h-42.369v59.317h-61.2v42.369h61.2v61.2h42.369v-61.2h59.317v-42.369h-59.317z"/></svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <span>2018 COUCHBASE All rights reserved.</span>
      <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
      <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
      <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
      <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
    </div>
  </div>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
