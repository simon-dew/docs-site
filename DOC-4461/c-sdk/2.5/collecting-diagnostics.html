<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Collecting diagnostic information | Couchbase Docs (Staging)</title>
    <link rel="canonical" href="https://simon-dew.github.io/docs-site/DOC-4461/c-sdk/2.10/start-using-sdk.html">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="schema.dcterms" href="https://purl.org/dc/terms/">
    <meta name="dcterms.subject" content="c-sdk">
    <meta name="dcterms.identifier" content="2.5">
    <meta name="generator" content="Antora 1.1.1">
    <link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar" id="topbar">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://www.couchbase.com"><img src="../../_/img/logo.svg" alt="Couchbase"></a>
        <button class="navbar-burger" data-target="topbar-menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
      <div id="topbar-menu" class="navbar-menu">
        <div class="navbar-start">
          <div class="navbar-item has-dropdown">
            <a class="navbar-link" href="https://simon-dew.github.io/docs-site/DOC-4461">Docs</a>
            <div class="navbar-dropdown explore">
              <div class="title">Couchbase Documentation Overview</div>
              <div class="cols">
                <ul>
                  <li class="heading"><a href="../../server/6.0/introduction/intro.html">Server</a></li>
                  <li><a href="../../server/6.0/n1ql/n1ql-language-reference/index.html">N1QL</a></li>
                  <li><a href="../../server/6.0/fts/full-text-intro.html">Full Text Search</a></li>
                  <li><a href="../../server/6.0/analytics/introduction.html">Analytics</a></li>
                  <li><a href="../../server/6.0/eventing/eventing-overview.html">Eventing</a></li>
                  <li><a href="../../operator/1.2/overview.html">Autonomous Operator</a></li>
                </ul>
                <ul>
                  <li class="heading">Mobile</li>
                  <li><a href="../../couchbase-lite/2.5/index.html">Lite</a></li>
                  <li><a href="../../sync-gateway/2.5/index.html">Sync Gateway</a></li>
                </ul>
                <ul class="two-cols">
                  <li class="heading"><a href="../../server/6.0/sdk/overview.html">SDKs</a></li>
                  <li><a href="../../c-sdk/2.10/start-using-sdk.html">C</a></li>
                  <li><a href="../../dotnet-sdk/2.7/start-using-sdk.html">.NET</a></li>
                  <li><a href="../../go-sdk/1.5/start-using-sdk.html">Go</a></li>
                  <li><a href="../../java-sdk/2.7/start-using-sdk.html">Java</a></li>
                  <li><a href="../../nodejs-sdk/2.6/start-using-sdk.html">Node.js</a></li>
                  <li><a href="../../php-sdk/2.6/start-using-sdk.html">PHP</a></li>
                  <li><a href="../../python-sdk/2.5/start-using-sdk.html">Python</a></li>
                </ul>
                <ul>
                  <li class="heading"><a href="../../server/6.0/connectors/intro.html">Connectors</a></li>
                  <li><a href="../../elasticsearch-connector/4.0/index.html">Elasticsearch</a></li>
                  <li><a href="../../server/6.0/connectors/hadoop-1.2/hadoop.html">Hadoop</a></li>
                  <li><a href="../../kafka-connector/3.4/index.html">Kafka</a></li>
                  <li><a href="../../spark-connector/2.2/index.html">Spark</a></li>
                  <li><a href="../../talend-connector/index.html">Talend</a></li>
                  <li><a href="../../server/6.0/connectors/odbc-jdbc-drivers.html">ODBC/JDBC</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="navbar-item has-dropdown">
            <a class="navbar-link component" href="c-intro.html"><span class="title">C SDK</span> <span class="version">2.5</span></a>
            <div class="navbar-dropdown versions">
              <div class="cols">
                <ul>
                  <li><a class="navbar-item" href="../2.10/start-using-sdk.html">C SDK 2.10</a></li>
                  <li><a class="navbar-item" href="../2.9/start-using-sdk.html">C SDK 2.9</a></li>
                  <li><a class="navbar-item" href="../2.8/start-using-sdk.html">C SDK 2.8</a></li>
                  <li><a class="navbar-item" href="../2.7/start-using-sdk.html">C SDK 2.7</a></li>
                  <li><a class="navbar-item" href="../2.6/start-using-sdk.html">C SDK 2.6</a></li>
                </ul>
                <ul class="related">
                  <li><a class="navbar-item" href="../../dotnet-sdk/2.7/collecting-diagnostics.html">.NET SDK</a></li>
                  <li><a class="navbar-item" href="../../go-sdk/1.5/collecting-diagnostics.html">Go SDK</a></li>
                  <li><a class="navbar-item" href="../../java-sdk/2.7/collecting-diagnostics.html">Java SDK</a></li>
                  <li><a class="navbar-item" href="../../nodejs-sdk/2.6/collecting-diagnostics.html">Node.js SDK</a></li>
                  <li><a class="navbar-item" href="../../php-sdk/2.6/collecting-diagnostics.html">PHP SDK</a></li>
                  <li><a class="navbar-item" href="../../python-sdk/2.5/collecting-diagnostics.html">Python SDK</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="navbar-end">
          <div class="navbar-item">
            <a class="btn red-btn" href="https://www.couchbase.com/downloads">Downloads</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body container">
<nav class="nav">
<div class="nav-menu">
<ul class="nav-list">
  <li class="nav-item is-current-path is-active" data-depth="0">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="c-intro.html">C SDK 2.4/2.5</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="overview.html">Couchbase C Client Library</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="download-install.html">Installation and API Reference</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="download-list.html">Downloads</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="getting-started.html">Getting started</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="managing-connections.html">Managing server connections</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="documents.html">Working with documents</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="storing.html">Creating documents</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="retrieving.html">Retrieving documents</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="updating.html">Updating documents</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="deleting.html">Deleting documents</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="bulk-operations.html">Bulk operations</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="atomic-operations.html">Atomic operations</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="durability.html">Durability requirements for mutations</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="querying.html">Querying buckets</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="view-queries.html">Working with view queries</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="n1ql-queries.html">Working with N1QL queries</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="handling-errors.html">Handling errors</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="preempting-errors.html">Preempting errors from bad servers</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="logging.html">Setting up logging</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="tuning.html">Tuning and configuring</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="common-settings.html">Common client settings</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="blocking-and-nonblocking.html">Blocking and non-blocking I/O</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="external-eventloop.html">Using external event loops</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="resources.html">Resources</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="options.html">Connection string reference</a>
    </span>
  </li>
  <li class="nav-item is-current-page is-active" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="collecting-diagnostics.html">Collecting diagnostic information</a>
    </span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="cli-tools.html">Client command-line tools</a>
    </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="common-usage.html">Common usage</a>
    </span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-line">
    <a class="nav-link" href="tools.html">List of tools</a>
    </span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-line">
    <a class="nav-link" href="release-notes.html">Release Notes</a>
    </span>
  </li>
</ul>
  </li>
</ul>
</div>
</nav>
<aside class="toc sidebar">
  <div class="toc-menu"></div>
</aside>
<main class="article" data-ceiling="topbar">
  <div class="article-banner">
    <p>A newer version of this documentation is available.</p>
    <a class="btn" href="../2.10/start-using-sdk.html">View Latest</a>
  </div>
  <div class="article-header">
<button class="nav-control"></button>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="c-intro.html">C SDK</a></li>
    <li class="crumb"><a href="c-intro.html">C SDK 2.4/2.5</a></li>
    <li class="crumb"><a href="collecting-diagnostics.html">Collecting diagnostic information</a></li>
  </ul>
</nav>
<div class="tools" role="navigation">
  <ul>
    <li class="tool edit"><a href="https://github.com/couchbase/docs-sdk-c/edit/release/2.5/modules/ROOT/pages/collecting-diagnostics.adoc" title="Edit Page" target="_blank" rel="noopener">Edit</a></li>
  </ul>
</div>
  </div>
<article class="doc">
<h1 class="page">Collecting diagnostic information</h1>
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
When your application crashes, stack traces, core dumps, and logging information can help identify the root cause of the crash.
These tools can help you diagnose issues yourself, or if you report an issue with the C SDK to Couchbase, provide crucial information to the Couchbase developers who investigate the issue.
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-stack-traces"><a class="anchor" href="#getting-stack-traces"></a>Getting stack traces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To get a stack trace you need to have <a href="http://www.gnu.org/software/gdb/" target="_blank" rel="noopener">GDB</a> installed on your machine and be familiar with its use.
If you cannot run your application from within GDB, you can attach GDB to an existing process.</p>
</div>
<div class="paragraph">
<p>To generate a useful stack trace, you need to run your application with a debug build of the Couchbase C library because the released binaries are optimized.
During optimization the compiler might rearrange the code, which can result in misleading source file and line number information in the stack trace.</p>
</div>
<div class="paragraph">
<p>To make a debug build of the C library, build the library yourself from source with the <code>‑‑enable‑debug</code> option applied to the <code>configure</code> script, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mnunberg@mbp15 ~/Source/libcouchbase $ ./cmake/configure --enable-debug
Detected in-source build. Making 'build' directory
cmake ../ \
    "-DCMAKE_BUILD_TYPE=DEBUG" \
    "-DCMAKE_INSTALL_PREFIX=/usr/local" \
    "-GUnix Makefiles" \
# SNIP</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ensure debugging symbols for the C client are installed.
If you are using a binary distribution, use your package manager to install the <code>libcouchbase-dbg</code> or <code>libcouchbase-debuginfo</code> package.
If you are using a version of the C library built from source, ensure that <code>‑‑enable‑debug</code> was passed to the <code>configure</code> script.</p>
</div>
<div class="paragraph">
<p>You should also build your application with debug symbols, though not strictly required.</p>
</div>
<div class="paragraph">
<p>If your application crashes within the C library, examine the stack trace information.
The C library is asynchronous in its core, so almost everything happens from within the <code class="api">lcb_wait()</code> function.
Tracing actual state changes and events within the library is only possible by using <a href="logging.html" class="page">logging</a>.</p>
</div>
<div class="paragraph">
<p>The following example shows how to run an application from GDB and how to get a stack trace when it crashes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mnunberg@mbp15 ~/Source/libcouchbase/build $ gdb --args ./bin/cbc cat foo -U couchbase://192.168.33.101/default
# SNIP
(gdb) r
Starting program: /Users/mnunberg/Source/libcouchbase/build/bin/cbc cat foo -U couchbase://192.168.33.101/default
Reading symbols for shared libraries .
# SNIP
Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_INVALID_ADDRESS at address: 0x0000000000000020
0x00000001000bacb9 in try_read (ctx=0x100703760, server=0x100700660, ior=0x1007037a8) at /Users/mnunberg/Source/libcouchbase/src/mcserver/mcserver.c:198
198	        pl2-&gt;index++;
(gdb) thread apply all bt

Thread 1 (process 7377):
#0  0x00000001000bacb9 in try_read (ctx=0x100703760, server=0x100700660, ior=0x1007037a8) at /Users/mnunberg/Source/libcouchbase/src/mcserver/mcserver.c:198
#1  0x00000001000baa29 in on_read (ctx=0x100703760, nb=31) at /Users/mnunberg/Source/libcouchbase/src/mcserver/mcserver.c:299
#2  0x0000000100090935 in invoke_read_cb (ctx=0x100703760, nb=31) at /Users/mnunberg/Source/libcouchbase/src/lcbio/ctx.c:273
#3  0x0000000100090a23 in E_handler (sock=4, which=2, arg=0x100703760) at /Users/mnunberg/Source/libcouchbase/src/lcbio/ctx.c:290
#4  0x000000010030d422 in event_base_loop ()
#5  0x00000001003068e1 in lcb_io_run_event_loop (iops=0x100405e50) at /Users/mnunberg/Source/libcouchbase/plugins/io/libevent/plugin-libevent.c:202
#6  0x00000001000c1d4d in lcb_wait (instance=0x100405910) at /Users/mnunberg/Source/libcouchbase/src/wait.c:88
#7  0x0000000100003be9 in cbc::GetHandler::run (this=0x100801200) at /Users/mnunberg/Source/libcouchbase/tools/cbc.cc:317
#8  0x000000010000318f in cbc::Handler::execute (this=0x100801200, argc=4, argv=0x7fff5fbffac8) at /Users/mnunberg/Source/libcouchbase/tools/cbc.cc:219
#9  0x000000010000e93c in main (argc=4, argv=0x7fff5fbffac8) at /Users/mnunberg/Source/libcouchbase/tools/cbc.cc:1204</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="detecting-invalid-memory-accesses"><a class="anchor" href="#detecting-invalid-memory-accesses"></a>Detecting invalid memory accesses</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="http://valgrind.org" target="_blank" rel="noopener">Valgrind</a> can help you detect issues in your application (or the library itself) related to accessing invalid (already freed or unallocated) memory or uninitialized memory regions.
This information is useful when debugging application behavior before a crash because crashes are often caused by entering a normally impossible state induced by a previous write or read to an invalid memory location.</p>
</div>
<div class="paragraph">
<p>You can install Valgrind through your package manager.</p>
</div>
<div class="paragraph">
<p>Valgrind will slow down execution time significantly, often by a factor of 20x.
To lessen this impact on an application that performs lots of load, temporarily reduce the amount of CPU it uses.</p>
</div>
<div class="paragraph">
<p>Valgrind typically does not work well with dynamic language interpreters such as Python, Ruby, or Perl due to the way these languages optimize memory allocation.
To effectively use Valgrind with these languages, you often need to use a special debug build of the interpreter.
To find out more about using Valgrind with interpreters, refer to the documentation for the language you are using.</p>
</div>
<div class="paragraph">
<p>The following example shows how to run an application with Valgrind.
In the example, the operation appears to time out, but the real cause of the problem is uninitialized memory access that causes the client to incorrectly read the response from the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mnunberg@csure:/sources/libcouchbase/build$ valgrind ./bin/cbc cat foo -U couchbase://192.168.33.101/default
==29887== Memcheck, a memory error detector
==29887== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
==29887== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==29887== Command: ./bin/cbc cat foo -U couchbase://192.168.33.101/default
==29887==
==29887== Conditional jump or move depends on uninitialised value(s)
==29887==    at 0x4E6D801: try_read (mcserver.c:221)
==29887==    by 0x4E6DD64: on_read (mcserver.c:294)
==29887==    by 0x4E4B8AA: invoke_read_cb (ctx.c:273)
==29887==    by 0x4E4B92B: E_handler (ctx.c:290)
==29887==    by 0x6E55EEB: event_base_loop (in /usr/lib/x86_64-linux-gnu/libevent_core-2.0.so.5.1.7)
==29887==    by 0x6C49610: lcb_io_run_event_loop (plugin-libevent.c:202)
==29887==    by 0x4E73D75: lcb_wait (wait.c:88)
==29887==    by 0x410964: cbc::GetHandler::run() (cbc.cc:317)
==29887==    by 0x41036F: cbc::Handler::execute(int, char**) (cbc.cc:219)
==29887==    by 0x414E03: main (cbc.cc:1204)
==29887==
==29887== Conditional jump or move depends on uninitialised value(s)
==29887==    at 0x4E4BF07: E_schedule (ctx.c:447)
==29887==    by 0x4E4BFD4: lcbio_ctx_schedule (ctx.c:471)
==29887==    by 0x4E4BA21: E_handler (ctx.c:320)
==29887==    by 0x6E55EEB: event_base_loop (in /usr/lib/x86_64-linux-gnu/libevent_core-2.0.so.5.1.7)
==29887==    by 0x6C49610: lcb_io_run_event_loop (plugin-libevent.c:202)
==29887==    by 0x4E73D75: lcb_wait (wait.c:88)
==29887==    by 0x410964: cbc::GetHandler::run() (cbc.cc:317)
==29887==    by 0x41036F: cbc::Handler::execute(int, char**) (cbc.cc:219)
==29887==    by 0x414E03: main (cbc.cc:1204)
==29887==
foo                  Client-Side timeout exceeded for operation. Inspect network conditions or increase the timeout (0x17)
==29887== Conditional jump or move depends on uninitialised value(s)
==29887==    at 0x4E4B4EB: lcbio_ctx_close_ex (ctx.c:156)
==29887==    by 0x4E4B640: lcbio_ctx_close (ctx.c:192)
==29887==    by 0x4E6EFB8: finalize_errored_ctx (mcserver.c:720)
==29887==    by 0x4E6EEE3: start_errored_ctx (mcserver.c:698)
==29887==    by 0x4E6ED98: mcserver_close (mcserver.c:646)
==29887==    by 0x4E6A943: lcb_destroy (instance.c:491)
==29887==    by 0x41020C: cbc::Handler::~Handler() (cbc.cc:208)
==29887==    by 0x42222D: cbc::GetHandler::~GetHandler() (in /sources/lcb-packet-ng/build/bin/cbc)
==29887==    by 0x422297: cbc::GetHandler::~GetHandler() (cbc-handlers.h:31)
==29887==    by 0x414E3D: main (cbc.cc:1221)
==29887==
==29887==
==29887== HEAP SUMMARY:
==29887==     in use at exit: 4,994 bytes in 20 blocks
==29887==   total heap usage: 602 allocs, 582 frees, 588,374 bytes allocated
==29887==
==29887== LEAK SUMMARY:
==29887==    definitely lost: 35 bytes in 1 blocks
==29887==    indirectly lost: 0 bytes in 0 blocks
==29887==      possibly lost: 28 bytes in 1 blocks
==29887==    still reachable: 4,931 bytes in 18 blocks
==29887==         suppressed: 0 bytes in 0 blocks
==29887== Rerun with --leak-check=full to see details of leaked memory
==29887==
==29887== For counts of detected and suppressed errors, rerun with: -v
==29887== Use --track-origins=yes to see where uninitialised values come from
==29887== ERROR SUMMARY: 3 errors from 3 contexts (suppressed: 10 from 6)</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-core-dumps"><a class="anchor" href="#getting-core-dumps"></a>Getting core dumps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Core dumps might be generated when an application crashes (though on many systems core file generation is off by default).
The core dump contains a memory dump of your application that can be inspected on a different system.
This lets you inspect the state of the library to determine what the error was at the time of the crash.</p>
</div>
<div class="paragraph">
<p>Core dumps can only be analyzed if the binaries that generated them are accessible and have debugging symbols.
Binaries in this sense includes the client library, the application, and any other shared libraries loaded by the application.
This means that the platform (and distribution) that generated the core dump must be available and loadable (or at least reproducible) when analyzing the core dump.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
A core file contains the memory contents of your application.
Anyone who can read your core file can access potentially sensitive data that your application was processing at the time of the crash.
If possible, have your application operate on sample data.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To get a core dump:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke <code>ulimit -c unlimited</code> in the same shell that your application will run (or a parent thereof) prior to the invocation of that application.
The <code>ulimit</code> command instructs the kernel to generate core dump files for all subsequent processes that terminate abnormally and are executed within the current shell or any child shell.</p>
</li>
<li>
<p>Ensure you are either using a binary installation of the client library (which was installed from an official Couchbase repository) or are using a source build with debug symbols enabled.</p>
</li>
<li>
<p>When the application crashes, a core file is created.
The exact location and name of the file is dependent on the specific kernel configuration.
For more information about where core files are located, see <a href="http://stackoverflow.com/questions/2065912/core-dumped-but-core-file-is-not-in-current-directory" class="bare" target="_blank" rel="noopener">http://stackoverflow.com/questions/2065912/core-dumped-but-core-file-is-not-in-current-directory</a>.</p>
</li>
<li>
<p>Compress the core file using <code class="cmd">gzip</code> or a similar utility before submitting to support.
Compressing the file makes the upload and download times quicker for analyzing the core file.</p>
</li>
<li>
<p>Disable core dumps once completed.
Core dumps are disabled by default on most Linux distributions because they may potentially write sensitive information to disk and many core dump files can quickly fill up a file system.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following example shows how to enable and collect a core dump:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">mnunberg@csure:/sources/libcouchbase/build$ ulimit -c unlimited
mnunberg@csure:/sources/libcouchbase/build$ ./bin/cbc cat foo -U couchbase://192.168.33.101
Aborted (core dumped)
# Showing the effects of compressing the core file:
mnunberg@csure:/sources/libcouchbase/build$ ls -lsh core
961K -rw------- 1 mnunberg mnunberg 1.3M Nov 21 12:53 core
mnunberg@csure:/sources/libcouchbase/build$ gzip core
mnunberg@csure:/sources/libcouchbase/build$ ls -lsh core.gz
136K -rw------- 1 mnunberg mnunberg 133K Nov 21 12:53 core.gz</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="collecting-log-information"><a class="anchor" href="#collecting-log-information"></a>Collecting log information</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Logging is a lightweight way to collect state and diagnostic information on the library.
You can use the library&#8217;s default logging (to standard error) by setting the <code>LCB_LOGLEVEL</code> environment variable.
There are some undocumented methods of customizing the logging output or integrating them with your application.
Refer to the source code of the library for more information on how this may be done.
To learn how to set up logging in your application, see <a href="logging.html" class="page">Setting up logging</a>.</p>
</div>
<div class="paragraph">
<p>The following example shows how to run an application with logging and redirect the <code>stderr</code> output to a file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mnunberg@csure:/sources/libcouchbase/build$ LCB_LOGLEVEL=5 ./bin/cbc cat foo 2&amp;&gt; log
mnunberg@csure:/sources/libcouchbase/build$ cat log
0ms [I0] {30280} [INFO] (instance - L:372) Version=2.4.4, Changeset=4410eebcd813844b6cd6f9c7eeb4ab3dfa2ab8ac
0ms [I0] {30280} [INFO] (instance - L:373) Effective connection string: http://localhost/default?. Bucket=default
0ms [I0] {30280} [DEBUG] (instance - L:63) Adding host localhost:8091 to initial HTTP bootstrap list
0ms [I0] {30280} [DEBUG] (instance - L:63) Adding host localhost:11210 to initial CCCP bootstrap list
0ms [I0] {30280} [DEBUG] (confmon - L:89) Preparing providers (this may be called multiple times)
0ms [I0] {30280} [DEBUG] (confmon - L:99) Provider FILE is DISABLED
0ms [I0] {30280} [DEBUG] (confmon - L:96) Provider CCCP is ENABLED
0ms [I0] {30280} [DEBUG] (confmon - L:96) Provider HTTP is ENABLED
0ms [I0] {30280} [DEBUG] (confmon - L:99) Provider MCRAW is DISABLED
0ms [I0] {30280} [TRACE] (confmon - L:284) Start refresh requested
0ms [I0] {30280} [TRACE] (confmon - L:264) Current provider is CCCP
1ms [I0] {30280} [INFO] (cccp - L:118) Requesting connection to node localhost:11210 for CCCP configuration
1ms [I0] {30280} [DEBUG] (lcbio_mgr - L:414) &lt;localhost:11210&gt; (HE=0x1927e70) Creating new connection because none are available in the pool
1ms [I0] {30280} [DEBUG] (lcbio_mgr - L:318) &lt;localhost:11210&gt; (HE=0x1927e70) Starting connection on I=0x19284c0
1ms [I0] {30280} [INFO] (connection - L:441) &lt;localhost:11210&gt; (SOCK=0x1928600) Starting. Timeout=2000000us
1ms [I0] {30280} [TRACE] (connection - L:258) &lt;localhost:11210&gt; (SOCK=0x1928600) Got event handler for new connection
1ms [I0] {30280} [TRACE] (connection - L:305) &lt;localhost:11210&gt; (SOCK=0x1928600) Scheduling asynchronous watch for socket.
1ms [I0] {30280} [TRACE] (connection - L:258) &lt;localhost:11210&gt; (SOCK=0x1928600) Got event handler for new connection
1ms [I0] {30280} [TRACE] (connection - L:321) &lt;localhost:11210&gt; (SOCK=0x1928600) connect() failed. os_error=111 [Connection refused]
1ms [I0] {30280} [TRACE] (connection - L:258) &lt;localhost:11210&gt; (SOCK=0x1928600) Got event handler for new connection
1ms [I0] {30280} [ERROR] (connection - L:118) &lt;localhost:11210&gt; (SOCK=0x1928600) Failed: lcb_err=0x2c, os_errno=111
1ms [I0] {30280} [DEBUG] (lcbio_mgr - L:272) &lt;localhost:11210&gt; (HE=0x1927e70) Received result for I=0x19284c0,C=(nil); E=0x2c
1ms [I0] {30280} [ERROR] (cccp - L:133) &lt;NOHOST:NOPORT&gt; Got I/O Error=0x2c
1ms [I0] {30280} [INFO] (confmon - L:202) Provider 'CCCP' failed
1ms [I0] {30280} [DEBUG] (confmon - L:229) Will try next provider in 0us
1ms [I0] {30280} [TRACE] (confmon - L:264) Current provider is HTTP
1ms [I0] {30280} [TRACE] (htconfig - L:395) Starting HTTP Configuration Provider 0x191e070
1ms [I0] {30280} [INFO] (connection - L:441) &lt;localhost:8091&gt; (SOCK=0x1928f90) Starting. Timeout=2000000us
2ms [I0] {30280} [TRACE] (connection - L:258) &lt;localhost:8091&gt; (SOCK=0x1928f90) Got event handler for new connection
2ms [I0] {30280} [TRACE] (connection - L:305) &lt;localhost:8091&gt; (SOCK=0x1928f90) Scheduling asynchronous watch for socket.
2ms [I0] {30280} [TRACE] (connection - L:258) &lt;localhost:8091&gt; (SOCK=0x1928f90) Got event handler for new connection
2ms [I0] {30280} [TRACE] (connection - L:321) &lt;localhost:8091&gt; (SOCK=0x1928f90) connect() failed. os_error=111 [Connection refused]
2ms [I0] {30280} [TRACE] (connection - L:258) &lt;localhost:8091&gt; (SOCK=0x1928f90) Got event handler for new connection
2ms [I0] {30280} [ERROR] (connection - L:118) &lt;localhost:8091&gt; (SOCK=0x1928f90) Failed: lcb_err=0x2c, os_errno=111
2ms [I0] {30280} [ERROR] (htconfig - L:341) Connection to REST API failed with code=0x2c (111)
2ms [I0] {30280} [INFO] (confmon - L:202) Provider 'HTTP' failed
2ms [I0] {30280} [TRACE] (confmon - L:219) Maximum provider reached. Resetting index
2ms [I0] {30280} [ERROR] (bootstrap - L:100) Failed to bootstrap client=0x191bc60. Code=0xa, Message=No more bootstrap providers remain
Operation failed with code 0x2c (The remote host refused the connection. Is the service up?)</code></pre>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../_/img/logo.svg" alt="Couchbase">
          </a>
        </div>
        <div class="contact">
          <p class="address">3250 Olcott Street
Santa Clara, CA 95054
United States</p>
          <a href="https://www.couchbase.com/contact" class="btn white-btn">Contact Us</a>
          <a class="tel" href="tel:1-650-417-7500">1-650-417-7500</a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Company</span></li>
          <li><a href="https://www.couchbase.com/about">About</a></li>
          <li><a href="https://www.couchbase.com/leadership">Leadership</a></li>
          <li><a href="https://www.couchbase.com/news-and-press-releases">News &amp; Press</a></li>
          <li><a href="https://www.couchbase.com/careers">Careers</a></li>
          <li><a href="https://www.couchbase.com/resources/events">Events</a></li>
          <li><a href="https://www.couchbase.com/contact">Contact Us</a></li>
          <li><a href="https://www.couchbase.com/request-pricing">Pricing</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Support</span></li>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://www.couchbase.com/services">Professional Services</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support Login</a></li>
          <li><a href="https://learn.couchbase.com/store" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><span class="heading">Quicklinks</span></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Online Training</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
          <li><a href="https://www.couchbase.com/nosql-resources/why-nosql">Why NoSQL</a></li>
          <li><a href="https://www.couchbase.com/resources/security">Security</a></li>
          <li><a href="https://www.couchbase.com/resources/gdpr">GDPR</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <a href="https://www.facebook.com/Couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="26.363 116.363 560.215 560.215"><path d="m586.58 209.58c0-48.96-44.252-93.212-93.212-93.212h-373.79c-48.96 0-93.212 44.252-93.212 93.212v373.79c0 48.96 44.252 93.212 93.212 93.212h186.42v-211.85h-68.732v-93.212h68.732v-36.72c0-63.083 47.077-119.58 105.45-119.58h75.323v93.212h-75.323c-8.474 0-17.889 10.357-17.889 25.422v37.662h93.212v93.212h-93.212v211.85h99.803c48.96 0 93.212-44.252 93.212-93.212v-373.79z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://twitter.com/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="32.012 176.622 542.326 437.815"><path d="m574.34 227.46c-19.772 8.474-41.428 15.065-64.025 17.889 22.597-14.123 40.486-35.778 48.96-61.2-21.655 13.182-45.194 21.655-70.615 27.305-20.714-21.655-48.96-34.837-80.972-34.837-61.2 0-111.1 49.902-111.1 111.1 0 8.474 0.942 16.948 2.825 25.422-92.271-5.649-174.18-49.902-229.74-117.69-9.415 16.006-15.065 35.778-15.065 55.551 0 38.603 19.772 72.498 49.902 92.271-17.889-0.942-35.778-5.649-50.843-14.123v0.942c0 53.668 38.603 98.862 89.446 109.22-9.415 2.825-18.831 3.766-29.188 3.766-7.532 0-14.123-0.942-20.714-1.883 14.123 44.252 55.551 76.265 103.57 77.206-37.662 30.129-85.68 48.018-138.41 48.018-9.415 0-17.889-0.941-26.363-1.883 48.96 32.012 107.34 49.902 170.42 49.902 204.31 0 316.36-169.48 316.36-316.36v-14.123c21.656-14.125 40.487-33.897 55.551-56.494z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://www.linkedin.com/company/couchbase" class="icon">
              <svg width="50px" height="50px" viewBox="31.071 119.188 539.537 540.443"><path d="m531.97 119.19h-461.35c-21.655 0-39.545 16.948-39.545 38.603v463.24c0 21.655 17.889 38.603 39.545 38.603h460.41c21.655 0 39.545-16.948 39.545-38.603v-463.24c0.942-21.656-16.947-38.603-38.603-38.603zm-337.07 451.94h-81.914v-243.86h81.914v243.86zm-40.486-276.81c-28.246 0-46.135-18.831-46.135-42.369s17.889-42.369 46.135-42.369 45.194 17.889 45.194 42.369c0.942 23.538-16.948 42.369-45.194 42.369zm335.19 276.81h-81.914v-129.93c0-32.954-12.24-55.551-41.428-55.551-22.597 0-35.778 15.065-41.428 30.129-1.883 5.649-2.825 12.24-2.825 19.772v136.52h-81.914s0.942-221.26 0-243.86h81.914v34.837c11.298-16.948 30.129-40.486 73.44-40.486 53.668 0 94.154 34.837 94.154 110.16l1e-3 138.41zm-168.54-208.08s0.941-0.941 0 0z"/></svg>
            </a>
          </li>
          <li>
            <a href="https://plus.google.com/+CouchbaseServer" class="icon">
              <svg width="50px" height="50px" viewBox="36.72 225.573 542.326 343.67"><path d="m209.02 363.05v68.732h93.212c-15.065 44.252-37.662 68.732-93.212 68.732-56.492 0-100.74-46.135-100.74-102.63s44.252-102.63 100.74-102.63c30.129 0 48.96 10.357 66.849 25.422 14.123-14.123 13.182-16.006 48.96-49.902-31.071-28.246-71.557-45.194-115.81-45.194-95.096-0.94-172.3 76.266-172.3 171.36s77.206 172.3 172.3 172.3c142.17 0 177.01-124.28 165.71-206.2-33.896-1e-3 -165.71-1e-3 -165.71-1e-3zm310.71 3.766v-59.317h-42.369v59.317h-61.2v42.369h61.2v61.2h42.369v-61.2h59.317v-42.369h-59.317z"/></svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <span>2018 COUCHBASE All rights reserved.</span>
      <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
      <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
      <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
      <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
    </div>
  </div>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
